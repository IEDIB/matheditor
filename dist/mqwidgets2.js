/*! For license information please see mqwidgets2.js.LICENSE.txt */
!function(){var t={161:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.I18n=void 0;var i=n(66),r={ca:{check:"Comprova",General:"General","Símbols":"Símbols",Geometria:"Geometria",Intervals:"Intervals",Funcions:"Funcions",right_answer:"Resposta correcta",close:"Tancar",open_editor:"Obrir l'editor",show_answer:"Mostra la solució",choose_option:"Tria una opció",next:"Següent",goal_reached:"Repte aconseguit!",wildcard:"Comodí",answer:"Solució",matheditor:"Editor matemàtic",accept:"Acceptar",cancel:"Cancel·lar",expected_ans:"S'esperava la resposta",error_verifying:"Ho sentim però hi ha hagut un problema a l'hora de verificar la resposta.",wrong_answer:"Resposta incorrecta. Intentau de nou.",sym_notallowed:"No es permet el símbol <b>${1}</b> en la resposta.",sym_once:"El símbol <b>${1}</b> només es pot emprar com a màxim una vegada en la resposta.",error_cantprocess:"Error: Hi ha respostes donades que no es poden processar. Provau d'eliminar els espais en blanc.",ans_missing:"Falten respostes"},es:{check:"Comprueba",General:"General","Símbols":"Símbolos",Geometria:"Geometria",Intervals:"Intervalos",Funcions:"Funciones",right_answer:"Respuesta correcta",close:"Cerrar",open_editor:"Abrir el editor",show_answer:"Muestra la solución",choose_option:"Elige una opción",next:"Siguiente",goal_reached:"¡Reto conseguido!",wildcard:"Comodín",answer:"Solución",matheditor:"Editor matemático",accept:"Aceptar",cancel:"Cancelar",expected_ans:"Se esperaba la respuesta",error_verifying:"Lo sentimos, ha habido un problema cuando se verificaba la respuesta.",wrong_answer:"Respuesta incorrecta. Inténtalo de nuevo.",sym_notallowed:"No se permite el símbolo <b>${1}</b> en la respuesta.",sym_once:"El símbolo <b>${1}</b> solo es puede emplear una vez como máximo en la respuesta.",error_cantprocess:"Error: Hay respuestas que no se pueden procesar. Intente eliminar los espacios en blanco.",ans_missing:"Faltan respuestas"},en:{check:"Check",General:"General","Símbols":"Symbols",Geometria:"Geometry",Intervals:"Intervals",Funcions:"Functions",right_answer:"Right answer",close:"Close",open_editor:"Open the editor",show_answer:"Show the answer",choose_option:"Choose an option",next:"Next",goal_reached:"Goal acomplished!",wildcard:"Wildcard",answer:"Answer",matheditor:"Math editor",accept:"Accept",cancel:"Cancel",expected_ans:"The expected answer is",error_verifying:"We are sorry. There has been a problem while verifying the answer.",wrong_answer:"Wrong answer. Try it again.",sym_notallowed:"The symbol <b>${1}</b> is not allowed in the answer.",sym_once:"The symbol <b>${1}</b> can only be used once in the answer.",error_cantprocess:"Error: There are some answers that can't be processed. Try removing white spaces.",ans_missing:"There are some blank answers"}};var o=function(){if("undefined"==typeof window)return"en";var t=window.navigator,e=t.languages&&t.languages[0]||t.language||t.browserLanguage||t.userLanguage||t.systemLanguage||"en_US";return(e=e.toLowerCase().replace(/-/,"_")).toLowerCase().split("_")[0]}();e.I18n=function(t){var e=i.cfg.LANG||o,n=r[e];n||(console.error("Cannot find translations in ",e,". Using fallback [en]"),n=r.en);for(var a=n[t]||t||"",s=0;s<(arguments.length<=1?0:arguments.length-1);s++)a=a.replace("${"+(s+1)+"}",s+1<1||arguments.length<=s+1?void 0:arguments[s+1]);return a}},800:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createSubmitButtonForGroup=e.bindSubmitActionButton=void 0;var i=n(247),r=n(66),o=n(161),a=n(332),s=n(830),l=(new Date).getTime();function c(t,e,n){var c=r.shared[t],u=Object.keys(c).map((function(t){return parseInt(t)}));e.off(),e.on("click",(function(t){t.preventDefault();var e=(new Date).getTime();if(l&&e-l<1e3)console.error("Too frequently checks are blocked!");else for(var p=0,f=u.length;p<f;p++){var d=u[p],h=c[d];if(h.getStatus()==r.cfg.STATUS.MODIFIED){var m=h.latex()||[];if(0===m.length||(0,i.has_empty_answers)(m))h.checkMsg(-1,(0,o.I18n)("ans_missing")),console.error("Editor contains empty answers");else if(1!=h.getStatus()&&m.length){if(h.getDefinition().right_answer&&h.getWrong_attemps()>r.cfg.MAX_ATTEMPTS&&!h.isPigen()){h.showAnswer();continue}if(h.getQType()==r.cfg.QTYPES.M||h.getQType()==r.cfg.QTYPES.Ms){var g=h.isComodiUsed()?5:10;h.getDefinition().ans==m[0]?h.checkMsg(1,"Molt bé!"):(g=0,h.increment_wrong(),h.checkMsg(0,"Incorrecte")),n&&n(g);continue}l=e;var b={latex:m,qid:d},v="";if((v=null!=h.getDefinition().anse?atob(h.getDefinition().anse||""):h.getDefinition().ans||"")&&1==m.length&&(0,s.isNumeric)(m[0])&&(0,s.isNumeric)(v)){var y=parseFloat(m[0]),w=(parseFloat(v),g=h.isComodiUsed()?5:10,parseFloat(v)-y),q=0;h.getDefinition().rules&&h.getDefinition().rules.precision&&(q=h.getDefinition().rules.precision),Math.abs(w)<=q?h.checkMsg(1,"Molt bé!"):(g=0,h.increment_wrong(),h.checkMsg(0,"Incorrecte")),n&&n(g);continue}(0,s.copyPropsFromTo)(h.getDefinition(),b),r.cfg.pageInfo&&(b.pageInfo=r.cfg.pageInfo,h.getHash()||h.setHash((0,s.MD5)(b.formulation+"_"+(b.pageInfo.bookId||0)+"_"+(b.pageInfo.chapterId||0))),b.hash=h.getHash()),a.engineCAS.compare(b).then((function(t){var e=c[t.qid];0==t.correct&&e.increment_wrong(),e.checkMsg(t.correct,t.msg);var i=t.correct?e.isComodiUsed()?5:10:0;n&&n(i)}),(function(t){console.error("Error",t)}))}}}}))}e.bindSubmitActionButton=c,e.createSubmitButtonForGroup=function(t){var e=$('<button class="btn btn-sm btn-primary pw-me-submitgroup"><i class="fa fas fa-check"></i> '.concat((0,o.I18n)("check"),"</button>"));return c(t,e),e}},247:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.has_empty_answers=e.extractMatrices=void 0;var n=/\\begin{pmatrix}(.*?)\\end{pmatrix}/g;function i(t){for(var e=[],i=null,r=function(){var t=[];i[1].split("\\\\").forEach((function(e){var n=e.split("&");t.push(n)})),e.push(t)};null!==(i=n.exec(t));)r();return e}e.extractMatrices=i;var r=function(t){for(var e=t.length,n=0;n<e;n++)for(var i=t[n],r=i.length,o=0;o<r;o++)if(!i[o])return!0;return!1};e.has_empty_answers=function(t){for(var e=0,n=t.length;e<n;e++){var o=t[e];if(""==o||o&&!o.trim())return!0;for(var a=i(o),s=0,l=a.length;s<l;s++)if(r(a[s]))return!0}return!1}},968:function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.LevelIndicator=void 0;var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.numLevels=e,this.container=$('<div style="display:inline-block;font-size:90%;" data-toggle="tooltip"></div>'),this.levelIcons=[];for(var n=0;n<e;n++){var i=$('<i class="fa fas fa-pepper-hot" style="color:lightgray;"></i>');this.container.append(i),this.levelIcons.push(i)}}var e,i,r;return e=t,(i=[{key:"$div",get:function(){return this.container}},{key:"setLevel",value:function(t){t<0?t=0:t>this.numLevels&&(t=this.numLevels);for(var e=0;e<this.numLevels;e++)e<t?this.levelIcons[e].css("color","darkred"):this.levelIcons[e].css("color","lightgray");this.container.attr("data-original-title","Nivell "+t),this.container.removeAttr("title")}},{key:"setVisible",value:function(t){this.container.css("display",t?"":"none")}}])&&n(e.prototype,i),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.LevelIndicator=i},281:function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.PwDialog=void 0;var i=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="pwdlg_"+Math.random().toString(32).substring(2),this.window=$('<div id="'+this.id+'" class="pw-me-dlg" style="width:'+n+"px;height:"+i+'px;display:none;"></div>');var r=$('<div class="pw-me-dlg-header"></div>');this.topBar=r;var o=$('<span class="pw-me-dlg-headertitle">'+e+"</span>");this.closeBtn=$('<button class="btn btn-sm pw-me-btn-dlgclose" title="Tancar"><i class="fa fas fa-times"></i></button>');var a=this;this.closeBtn.on("click",(function(t){t.preventDefault(),a.window.css("display","none")})),r.append(o),r.append(this.closeBtn),this.window.append(r),$("body").append(this.window);var s,l,c,u,p=!1,f=0,d=0;this.dragStart=function(t){"touchstart"===t.type?(c=t.touches[0].clientX-f,u=t.touches[0].clientY-d):(c=t.clientX-f,u=t.clientY-d),t.target===r[0]&&(p=!0)},this.dragEnd=function(t){c=s,u=l,p=!1},this.setTranslate=function(t,e,n){n.style.transform="translate3d("+t+"px, "+e+"px, 0)"},this.drag=function(t){p&&(t.preventDefault(),"touchmove"===t.type?(s=t.touches[0].clientX-c,l=t.touches[0].clientY-u):(s=t.clientX-c,l=t.clientY-u),f=s,d=l,a.setTranslate(s,l,a.window[0]))},r[0].addEventListener("touchstart",this.dragStart,!1),r[0].addEventListener("touchend",this.dragEnd,!1),r[0].addEventListener("touchmove",this.drag,!1),r[0].addEventListener("mousedown",this.dragStart,!1),r[0].addEventListener("mouseup",this.dragEnd,!1),r[0].addEventListener("mousemove",this.drag,!1)}var e,i,r;return e=t,(i=[{key:"append",value:function(t){this.window.append(t)}},{key:"show",value:function(){this.window.css("display","initial")}},{key:"close",value:function(){this.window.css("display","none")}},{key:"remove",value:function(){this.closeBtn.off(),this.window.remove(),this.topBar[0].removeEventListener("touchstart",this.dragStart),this.topBar[0].removeEventListener("touchend",this.dragEnd),this.topBar[0].removeEventListener("touchmove",this.drag),this.topBar[0].removeEventListener("mousedown",this.dragStart),this.topBar[0].removeEventListener("mouseup",this.dragEnd),this.topBar[0].removeEventListener("mousemove",this.drag)}},{key:"dispose",value:function(){this.remove()}}])&&n(e.prototype,i),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.PwDialog=i},541:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.EditorDialog=void 0;var u=n(66),p=n(161),f=n(830),d=n(786),h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var e=l(t=s.call(this,'<i style="color:darkred;" class="pw-square-root"></i> '+(0,p.I18n)("matheditor"),500,320)),n="gid_"+Math.random().toString(32).substring(2),i=u.cfg.QTYPES.P;t.editorPanel=new d.EditorPanel(t.window,n,{},i,!1);var r=$('<div class="pw-me-dlg-controls"></div>'),o=$('<button class="btn btn-sm btn-primary">'+(0,p.I18n)("accept")+"</button>"),a=$('<button class="btn btn-sm btn-outline-primary">'+(0,p.I18n)("cancel")+"</button>");return r.append(o),r.append(a),t.append(r),o.on("click",(function(t){t.preventDefault(),e.acceptFn&&e.acceptFn(e),e.close()})),a.on("click",(function(t){t.preventDefault(),e.cancelFn&&e.cancelFn(e),e.close()})),t}return e=c,(n=[{key:"latex",value:function(t){return null!=t?(this.editorPanel.latex(t),[""]):this.editorPanel.latex().map((function(t){return(0,f.sanitizeLaTeX)(t)}))}},{key:"show",value:function(){this.window.css("display",""),this.editorPanel.focus()}},{key:"dispose",value:function(){this.editorPanel.dispose(),this.window.find("button").off(),this.dispose()}},{key:"reflow",value:function(){this.editorPanel.reflow()}},{key:"setDefinition",value:function(t){this.editorPanel.setDefinition(t)}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(n(281).PwDialog);e.EditorDialog=h},44:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.EditorBase=void 0;var r=n(66),o=function(){function t(e,n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.parent=e,this.gid=n,this.status=r.cfg.STATUS.UNMODIFIED,this.wrong_attemps=0,this.isAnswerShown=!1,this.def=i,this.qtype=o,this.pigen=!1,this.comodi=!1,this.hash=""}var e,n,o;return e=t,(n=[{key:"get_gid",value:function(){return this.gid}},{key:"setDefinition",value:function(t){this.def=t,this.ansType=t.ansType}},{key:"getDefinition",value:function(){return this.def}},{key:"increment_wrong",value:function(){this.wrong_attemps+=1}},{key:"getWrong_attemps",value:function(){return this.wrong_attemps}},{key:"getStatus",value:function(){return this.status}},{key:"setStatus",value:function(t){this.status=t}},{key:"getQType",value:function(){return this.qtype}},{key:"setQType",value:function(t){this.qtype=t}},{key:"isPigen",value:function(){return this.pigen}},{key:"setPigen",value:function(t){this.pigen=t}},{key:"isComodiUsed",value:function(){return this.comodi}},{key:"setComodiUsed",value:function(t){this.comodi=t}},{key:"getHash",value:function(){return this.hash}},{key:"setHash",value:function(t){this.hash=t}}])&&i(e.prototype,n),o&&i(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.EditorBase=o},437:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.EditorCloze=void 0;var u=n(66),p=n(161),f=n(830),d=n(281),h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(t,e,n,i,r){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var a=l(o=s.call(this,t,e,n,i));o.dlg_btn_el=null,o.quill_el_container=$('<div class="pw-me-editorinput d-print-none"></div>');var p=$("<span>"+r+"</span>");return o.check_el=$('<div class="pw-me-check"></div>'),o.parent.append(o.quill_el_container),o.quill_el_container.append(p),o.mathInput=(0,u.StaticMath)(p[0]),o.mathInput.innerFields.forEach((function(t){t.__controller.textarea.on("keyup",(function(t){t.preventDefault(),a.status!=u.cfg.STATUS.MODIFIED&&(a.check_el.html(""),a.status=u.cfg.STATUS.MODIFIED,a.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))}))})),o.quill_el_container.append(o.check_el),o}return e=c,(n=[{key:"clear",value:function(){this.mathInput.innerFields.forEach((function(t){return t.latex("")})),this.check_el.html(""),this.status=u.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){this.mathInput.focus()}},{key:"latex",value:function(t){if(null==t){var e=[];this.mathInput.innerFields;for(var n=this.mathInput.innerFields,i=0,r=n.length;i<r;i++)e.push(n[i].latex());return e}return this.mathInput.latex(t),this.status=u.cfg.STATUS.UNMODIFIED,[]}},{key:"checkMsg",value:function(t,e){this.status=t;var n="";1==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-check"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-times"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"get_qid",value:function(){return this.mathInput.id}},{key:"dispose",value:function(){this.mathInput.revert(),this.quill_el_container.find("button").off()}},{key:"reflow",value:function(){this.mathInput.reflow(),this.status=u.cfg.STATUS.UNMODIFIED}},{key:"showAnswer",value:function(){if(this.def)if(this.def.right_answer){var t=this;if(!u.sharedDlg.showAnswerDlg){var e=new d.PwDialog((0,p.I18n)("right_answer"),400,250);u.sharedDlg.showAnswerDlg=e;var n=$('<div class="pw-answer-holder"></div>');e.append(n);var i=$('<button class="btn btn-sm btn-primary" style="margin-left: 15px;">'+(0,p.I18n)("close")+"</button>");e.append(i),i.on("click",(function(t){t.preventDefault(),e.close()}))}t.isAnswerShown||(t.isAnswerShown=!0,t.status=u.cfg.STATUS.UNMODIFIED,t.dlg_btn_el&&t.dlg_btn_el.prop("disabled",!0));var r=u.sharedDlg.showAnswerDlg,o=r.window.find(".pw-answer-holder");t.def&&(o.html(atob(t.def.right_answer)+"<p><br></p>"),(0,f.reflowLatex)(),r.show())}else console.error("Cannot show answer because, ",this.def.right_answer);else console.error("Cannot show answer because, def is null")}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(n(44).EditorBase);e.EditorCloze=h},980:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.EditorInput=void 0;var u=n(332),p=n(66),f=n(161),d=n(830),h=n(281),m=n(541),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(t,e,n,i){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var o=l(r=s.call(this,t,e,n,i));r.quill_el_container=$('<div class="pw-me-editorinput d-print-none"></div>'),r.quill_blocker=$("<div></div>");var a=$("<span></span>");r.quill_blocker.append(a),r.check_el=$('<div class="pw-me-check"></div>'),r.quill_el_container.append(r.quill_blocker);var u=i===p.cfg.QTYPES.S;return r.parent.append(r.quill_el_container),r.mathInput=(0,p.MathField)(a[0],{handlers:{edit:function(){o.mathInput.latex(),o.status!=p.cfg.STATUS.MODIFIED&&(o.check_el.html(""),o.status=p.cfg.STATUS.MODIFIED,o.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))}}}),u&&(r.dlg_btn_el=$('<button class="btn btn-sm pw-me-btn-openeditor" title="'+(0,f.I18n)("open_editor")+'"><i class="pw-square-root"></i></button>'),r.quill_el_container.append(r.dlg_btn_el),r.dlg_btn_el.on("click",(function(t){t.preventDefault();var e=p.sharedDlg.editordlg;e||(e=new m.EditorDialog,p.sharedDlg.editordlg=e),e.acceptFn=function(t){o.mathInput.latex(t.latex())},e.setDefinition(o.def),e.show(),e.latex(o.mathInput.latex())}))),r.quill_el_container.append(r.check_el),r}return e=c,(n=[{key:"get_qid",value:function(){return this.mathInput.id}},{key:"clear",value:function(){this.mathInput.latex(""),this.check_el.html(""),this.status=p.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){this.mathInput.focus()}},{key:"latex",value:function(t){return null==t?[(0,d.sanitizeLaTeX)(this.mathInput.latex())]:(this.mathInput.latex(t),this.status=p.cfg.STATUS.UNMODIFIED,[])}},{key:"checkMsg",value:function(t,e){this.status=t;var n=null;1==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="'+p.cfg.RIGHT_ICON+'"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="'+p.cfg.WRONG_ICON+'"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"dispose",value:function(){this.mathInput.revert(),this.quill_el_container.find("button").off()}},{key:"showAnswer",value:function(){if(this.def.right_answer){var t=this;if(!p.sharedDlg.showAnswerDlg){var e=new h.PwDialog((0,f.I18n)("right_answer"),400,250);p.sharedDlg.showAnswerDlg=e;var n=$('<div class="pw-answer-holder"></div>');e.append(n);var i=$('<button class="btn btn-sm btn-primary" style="margin-left: 15px;">'+(0,f.I18n)("close")+"</button>");e.append(i),i.on("click",(function(t){t.preventDefault(),e.close()}))}t.isAnswerShown||(t.isAnswerShown=!0,t.status=p.cfg.STATUS.UNMODIFIED,t.quill_blocker.addClass("pw-me-blocker"),t.dlg_btn_el&&t.dlg_btn_el.prop("disabled",!0)),n=(e=p.sharedDlg.showAnswerDlg).window.find(".pw-answer-holder"),t.def&&(n.html(atob(t.def.right_answer)+"<p><br></p>"),(0,d.reflowLatex)(),e.show())}else console.error("Cannot show answer because, ",this.def.right_answer)}},{key:"increment_wrong",value:function(){if(this.wrong_attemps,p.cfg.MAX_ATTEMPTS,this.pigen,this.wrong_attemps+=1,this.wrong_attemps==p.cfg.MAX_ATTEMPTS+1&&!this.pigen){this.def;var t=$('<button class="btn btn-sm" title="'+(0,f.I18n)("show_answer")+'"><i class="fa far fa-question-circle"></i></button>'),e=this;t.on("click",(function(t){e.showAnswer()})),this.def.right_answer?this.quill_el_container.append(t):u.engineCAS.getAnswer(this.def).then((function(n){n.right_answer&&e.def?(e.def.right_answer=n.right_answer,e.quill_el_container.append(t)):n.msg&&console.error(n.msg)}),(function(t){console.error(t)}))}}},{key:"reflow",value:function(){this.mathInput.reflow(),this.status=p.cfg.STATUS.UNMODIFIED}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(n(44).EditorBase);e.EditorInput=g},203:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.EditorMChoice=void 0;var u=n(66),p=n(161),f=n(830),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(t,e,n,i,r){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o=s.call(this,t,e,n,i),"string"==typeof r&&(r=r.split(";"));var a=l(o);o.selectedIndex="",o.gid=e,o.qid=Math.floor(1e4*Math.random())+1e4,o.options=r||[],o.status=u.cfg.STATUS.UNMODIFIED,o.parent=t,o.wrong_attemps=0,o.quill_el_container=$('<div class="pw-me-mchoice d-print-none"></div>'),o.check_el=$('<div class="pw-me-check"></div>');var d=$('<div class="btn-group"></div>');o.btn_action=$('<button type="button" style="background:white;" class="btn btn-outline-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'+(0,p.I18n)("choose_option")+"</button>");var h=$('<div class="dropdown-menu"></div>');return d.append(o.btn_action),r.forEach((function(t,e){var n=$('<a class="dropdown-item" href="#">'+t+"</a>");n.on("click",(function(t){t.preventDefault(),a.selectedIndex=e+"",a.btn_action.html(n.html()),a.status!=u.cfg.STATUS.MODIFIED&&(a.check_el.html(""),a.status=u.cfg.STATUS.MODIFIED,a.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))})),h.append(n)})),d.append(h),o.quill_el_container.append(d),o.quill_el_container.append(o.check_el),o.parent.append(o.quill_el_container),(0,f.reflowLatex)(),o}return e=c,(n=[{key:"showAnswer",value:function(){}},{key:"clear",value:function(){this.selectedIndex="",this.btn_action.html(""),this.check_el.html(""),this.status=u.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){this.btn_action.focus()}},{key:"latex",value:function(t){return[this.selectedIndex]}},{key:"checkMsg",value:function(t,e){this.status=t;var n="";1==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-check"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-times"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"dispose",value:function(){this.quill_el_container.off()}},{key:"get_qid",value:function(){return this.qid}},{key:"reflow",value:function(){this.status=u.cfg.STATUS.UNMODIFIED}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(n(44).EditorBase);e.EditorMChoice=d},142:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.EditorMChoiceCheckbox=void 0;var u=n(66),p=n(830),f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(t,e,n,i,r){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(o=s.call(this,t,e,n,i)).multipleAnswers=r||!1;var a=n.symbols,f=l(o);o.selectedIndex="",o.gid=e,o.qid=Math.floor(1e4*Math.random())+1e4,o.options=a||[],o.status=u.cfg.STATUS.UNMODIFIED,o.parent=t,o.wrong_attemps=0,o.quill_el_container=$('<div class="pw-me-mchoice d-print-none"></div>'),o.check_el=$('<div class="pw-me-check"></div>');var d=$("<div></div>"),h="rgid_"+Math.random().toString(32).substring(2),m=[];return a.forEach((function(t,e){var n="raid_"+Math.random().toString(32).substring(2),i=$('<div class="form-check"></div>'),r=null;r=f.multipleAnswers?$('<input class="form-check-input" type="checkbox" id="'+n+'" value="'+e+'"/>'):$('<input class="form-check-input" type="radio" name="'+h+'" id="'+n+'" value="'+e+'"/>'),m.push(r);var o=$('<label class="form-check-label" for="'+n+'">'+t+"</label>");r.on("change",(function(t){t.preventDefault();for(var e=[],n=0;n<m.length;n++)m[n].prop("checked")&&e.push(m[n].prop("value")+"");f.selectedIndex=e.join(","),f.status!=u.cfg.STATUS.MODIFIED&&(f.check_el.html(""),f.status=u.cfg.STATUS.MODIFIED,f.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))})),i.append(r),i.append(o),d.append(i)})),o.quill_el_container.append(d),o.quill_el_container.append(o.check_el),o.parent.append(o.quill_el_container),(0,p.reflowLatex)(),o}return e=c,(n=[{key:"showAnswer",value:function(){}},{key:"clear",value:function(){this.selectedIndex="",this.btn_action.html(""),this.check_el.html(""),this.status=u.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){}},{key:"latex",value:function(t){return[this.selectedIndex]}},{key:"get_qid",value:function(){return this.qid}},{key:"checkMsg",value:function(t,e){this.status=t;var n="";1==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-check"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==t?(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-times"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"dispose",value:function(){this.quill_el_container.off()}},{key:"reflow",value:function(){this.status=u.cfg.STATUS.UNMODIFIED}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(n(44).EditorBase);e.EditorMChoiceCheckbox=f},786:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EditorPanel=void 0;var p=n(66),f=n(830),d=n(837),h=n(280),m=u(n(727)),g=n(44),b=n(332),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(t,e,n,i,r){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var a=l(o=s.call(this,t,e,n,i));return o.parent=t,o.gid=e,o.wrong_attemps=0,o.standalone=r||!1,o.status=p.cfg.STATUS.UNMODIFIED,o.panel=$('<div class="pw-me-editorpanel d-print-none" style="position:relative"></div>'),o.parent.append(o.panel),o.palettes=new d.PwTabMenu(o.panel,o.gid),o.spanMathInput=$('<span class="pw-me-editorpanel-mathinput"></span>'),o.spanMathInput.on("click",(function(t){t.preventDefault(),$(".pw-me-btn-dropdownmenu").css("display","none")})),o.panel.append(o.spanMathInput),o.mathInput=(0,p.MathField)(o.spanMathInput[0],{handlers:{edit:function(){r&&a.status!=p.cfg.STATUS.MODIFIED&&(a.check_el&&a.check_el.html(""),a.status=p.cfg.STATUS.MODIFIED)}}}),o.standalone&&(o.check_el=$("<div></div>"),o.panel.append(o.check_el)),o.feedback_el=$('<div class="pw-mq-feedback" style="display:none;"></div>'),o.panel.append(o.feedback_el),(0,f.items)(m.default.button_meta,(function(t,e){var n=m.default.default_toolbar_tabs[e.tab-1];a.palettes.addTab(n);var i=(0,h.createToolbarButton)(a.panel,e,t,a.mathInput);a.palettes.addContentsToTab(n,i)})),o.setDefinition(n),o}return e=c,(n=[{key:"$div",get:function(){return this.panel}},{key:"clear",value:function(){this.mathInput.latex(""),this.check_el&&this.check_el.html(""),this.status=p.cfg.STATUS.UNMODIFIED}},{key:"focus",value:function(){this.mathInput.focus()}},{key:"latex",value:function(t){return null==t?[(0,f.sanitizeLaTeX)(this.mathInput.latex())]:(this.mathInput.latex(t),this.status=p.cfg.STATUS.UNMODIFIED,[""])}},{key:"checkMsg",value:function(t,e){if(this.standalone){this.status=t;var n="";n=1==t?'<span style="color:green;margin:5px;"><i class="fa fas fa-check"></i> '+e+"</span>":0==t?'<span style="color:darkred;margin:5px;"><i class="fa fas fa-times"></i> '+e+"</span>":'<span style="color:purple;margin:5px;"><i class="fa fas fa-exclamation-triangle"></i> '+e+"</span>",this.check_el&&this.check_el.html(n)}}},{key:"get_qid",value:function(){return this.mathInput.id}},{key:"showPalette",value:function(t,e){this.palettes.setVisible(t,e)}},{key:"dispose",value:function(){this.mathInput.revert(),this.panel.find("button").off(),this.palettes.dispose()}},{key:"reflow",value:function(){this.mathInput.reflow(),this.status=p.cfg.STATUS.UNMODIFIED}},{key:"setDefinition",value:function(t){this.def=t;var e=this;if(t.palettes&&t.palettes.indexOf("all")>=0)m.default.default_toolbar_tabs.forEach((function(t){e.palettes.setVisible(t,!0)})),this.palettes.setTab("General");else if(t.palettes&&t.palettes.length){var n=null,i=0;m.default.default_toolbar_tabs.forEach((function(r){for(var o=!1,a=0;!o&&a<t.palettes.length;)(o=t.palettes[a].toLowerCase().trim()==r.toLowerCase().trim())&&0==a&&(n=r),o&&(i+=1),a+=1;e.palettes.setVisible(r,o)})),0!=i&&n||this.palettes.setVisible("General",!0),this.palettes.setTab(n||"General")}else m.default.default_toolbar_tabs.forEach((function(t){e.palettes.setVisible(t,"General"==t)})),this.palettes.setTab("General")}},{key:"increment_wrong",value:function(){this.wrong_attemps+=1,this.wrong_attemps>p.cfg.MAX_ATTEMPTS&&this.showAnswer()}},{key:"showAnswer",value:function(){var t,e=this;this.def?this.def.right_answer?(null===(t=e.check_el)||void 0===t||t.css("display","none"),this.feedback_el.css("display",""),this.feedback_el.html(atob(this.def.right_answer)+"<p><br></p>"),(0,f.reflowLatex)(),this.isAnswerShown=!0,this.palettes.setEnabled(!1),this.spanMathInput.css("pointer-events","none"),this.panel.css("cursor","not-allowed")):b.engineCAS.getAnswer(this.def).then((function(t){var n;t.right_answer?(null===(n=e.check_el)||void 0===n||n.css("display","none"),e.def.right_answer=t.right_answer,e.feedback_el.css("display",""),e.feedback_el.html(atob(e.def.right_answer)+"<p><br></p>"),(0,f.reflowLatex)(),e.isAnswerShown=!0,e.palettes.setEnabled(!1),e.spanMathInput.css("pointer-events","none"),e.panel.css("cursor","not-allowed")):t.msg&&console.error(t.msg)}),(function(t){console.error(t)})):console.error("Cannot show answer because def is null")}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(g.EditorBase);e.EditorPanel=v},280:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createToolbarButton=void 0;var i=n(66);e.createToolbarButton=function(t,e,n,r){if("function"==typeof e.latex){var o=$('<div class="btn btn-sm pw-me-btn-toolbar pw-me-btn-dropdown" title="'+n.trim()+'"></div>'),a=$("<span>"+e.icon+"</span>");(0,i.StaticMath)(a[0]),o.append(a);var s=$('<div class="pw-me-btn-dropdownmenu"></div>');t.append(s);for(var l=[],c=0,u=e.vars.length;c<u;c++){var p=e.vars[c],f=p.name,d="";null!=p.min&&(d=' min="'+p.min+'" '),null!=p.max&&(d+=' max="'+p.max+'" ');var h=$('<input style="width:50px;margin-left:4px;grid-column:2;" type="'+p.type+'" value="'+p.val+'"'+d+"/>");l.push(h);var m=$('<span style="grid-column:1">'+f+"</span>");s.append(m),s.append(h)}var g=$('<button class="btn btn-sm" style="padding:4px;grid-row:3;grid-column:1 / 2;background:lightgray;">Ok</button>');s.append(g),g.on("click",(function(t){t.preventDefault();for(var n={},i=0,o=l.length;i<o;i++){var a=l[i],c=e.vars[i],u=c.name,p=a.val();"number"===c.type&&(p=parseInt(p)),n[u]=p}var f=e.latex(n);r.write(f),e.moveto&&r.keystroke(e.moveto),s.css("display","none"),r.focus()})),o.on("click",(function(t){t.preventDefault();var e=s.css("display");s.css("display","none"===e?"grid":"none")}))}else{o=$('<button class="btn btn-sm pw-me-btn-toolbar" title="'+n.trim()+'"></button>');a=$("<span>"+e.icon+"</span>");(0,i.StaticMath)(a[0]),o.append(a),o.on("click",(function(t){t.preventDefault(),r.write(e.latex),r.focus(),e.moveto&&r.keystroke(e.moveto),$(".pw-me-btn-dropdownmenu").css("display","none")}))}return o}},837:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.PwTabMenu=void 0;var r=n(161),o=n(830),a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$panel=$('<div class="pw-me-tabmenu"></div>'),this.parent=e,this.tabs={},this.currentTab=null,this.tabsPanel=$('<div class="pw-me-tabspanel"></div>'),this.contentsPanel=$('<div class="pw-me-tabcontents"></div>'),this.$panel.append(this.tabsPanel),this.$panel.append(this.contentsPanel),this.parent&&this.parent.append(this.$panel),this.gid=n}var e,n,a;return e=t,(n=[{key:"$div",get:function(){return this.$panel}},{key:"addTab",value:function(t){if(!this.tabs[t]){var e=this,n=$('<button style="display:none;" class="btn btn-sm pw-me-btn-tab">'+(0,r.I18n)(t)+"</button>"),i=$('<div style="display:none;" class="pw-me-tabcontainer"></div>');n.on("click",(function(n){n.preventDefault(),e.setTab(t)})),this.tabsPanel.append(n),this.contentsPanel.append(i),this.tabs[t]={tab:n,container:i},1===Object.keys(this.tabs).length&&this.setTab(t)}}},{key:"addContentsToTab",value:function(t,e){this.tabs[t]&&this.tabs[t].container.append(e)}},{key:"setVisible",value:function(t,e){this.tabs,this.tabs[t]&&(this.tabs[t].tab.css("display",e?"":"none"),this.tabs[t].container.css("display",e?"flex":"none"))}},{key:"setEnabled",value:function(t){t?(this.contentsPanel.css("pointer-events","initial"),this.$panel.css("cursor","initial")):(this.contentsPanel.css("pointer-events","none"),this.$panel.css("cursor","not-allowed"))}},{key:"setTab",value:function(t){(0,o.items)(this.tabs,(function(e,n){e==t?(n.tab.addClass("pw-me-btn-active"),n.tab.css("display","")):n.tab.removeClass("pw-me-btn-active"),n.container.css("display",e==t?"flex":"none")}))}},{key:"dispose",value:function(){this.tabsPanel.children().off(),this.tabsPanel.html(""),this.contentsPanel.html(""),this.tabs={}}}])&&i(e.prototype,n),a&&i(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.PwTabMenu=a},727:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={default_toolbar_buttons:["fraction","square_root","cube_root","root","superscript","subscript","multiplication","division","plus_minus","pi","degree","not_equal","greater_equal","less_equal","greater_than","less_than","angle","parallel_to","perpendicular","triangle","parallelogram","round_brackets","matrix2","matrix3"],default_toolbar_tabs:["General","Símbols","Geometria","Intervals","Funcions"],button_meta:{"Multiplicació":{latex:"\\times",tab:1,icon:"\\times"},"Fracció":{latex:"\\frac{}{}",moveto:"Up",movefor:1,tab:1,icon:"\\frac{\\square}{\\square}"},Exponent:{latex:"\\^{}",moveto:"Up",movefor:1,tab:1,icon:"\\square^2"},"Parèntesis":{latex:"\\left(\\right)",moveto:"Left",movefor:1,tab:1,icon:"\\left(\\square\\right)"},"Arrel quadrada":{latex:"\\sqrt{}",moveto:"Left",movefor:1,tab:1,icon:"\\sqrt{\\square}"},"Arrel cúbica":{latex:"\\sqrt[3]{}",moveto:"Left",movefor:1,tab:1,icon:"\\sqrt[3]{\\square}"},Radical:{latex:"\\sqrt[{}]{}",moveto:"Left",movefor:2,tab:1,icon:"\\sqrt[\\square]{\\square}"},"Matriu 2x2":{latex:"\\begin{pmatrix} & \\\\ & \\end{pmatrix}",tab:1,icon:"M_{2\\times 2}"},"Matriu 3x3":{latex:"\\begin{pmatrix} & & \\\\ & &  \\\\ & & \\end{pmatrix}",tab:1,icon:"M_{3\\times 3}"},"Matriu mxn":{latex:function(t){for(var e=[],n=0;n<t.n;n++){for(var i=[],r=0;r<t.m;r++)i.push(" ");e.push(i.join("&"))}return"\\begin{pmatrix} "+e.join("\\\\")+" \\end{pmatrix}"},tab:1,icon:"M_{n\\times m}",vars:[{name:"n",type:"number",min:1,val:2},{name:"m",type:"number",min:1,val:2}]},"Subíndex":{latex:"\\_{}",moveto:"Down",movefor:1,tab:1,icon:"\\square_{2}"},pi:{latex:"\\pi",tab:2,icon:"\\pi"},e:{latex:"\\e",tab:2,icon:"e"},infinit:{latex:"\\infty",tab:2,icon:"\\infty"},"Més menys":{latex:"\\pm",tab:2,icon:"\\pm"},Diferent:{latex:"\\neq",tab:2,icon:"\\neq"},"Major o igual":{latex:"\\geq",tab:2,icon:"\\geq"},"Menor o igual":{latex:"\\leq",tab:2,icon:"\\leq"},"Major que":{latex:"\\gt",tab:2,icon:"\\gt"},"Menor que":{latex:"\\lt",tab:2,icon:"\\lt"},Graus:{latex:"\\degree",tab:3,icon:"\\degree"},Angle:{latex:"\\angle",tab:3,icon:"\\angle"},"Paral·lel a":{latex:"\\parallel",tab:3,icon:"\\parallel"},"Perpendicular a":{latex:"\\perpendicular",tab:3,icon:"\\perpendicular"},Triangle:{latex:"\\triangle",tab:3,icon:"\\triangle"},"Paral·lelogram":{latex:"\\parallelogram",tab:3,icon:"\\parallelogram"},"Interval obert":{latex:"\\left( , \\right)",moveto:"Left",movefor:4,tab:4,icon:"\\left(\\square, \\square\\right)"},"Interval tancat":{latex:"\\left[ , \\right]",moveto:"Left",movefor:4,tab:4,icon:"\\left[\\square, \\square\\right]"},"Interval semi1":{latex:"\\left[ , \\right)",moveto:"Left",movefor:4,tab:4,icon:"\\left[\\square, \\square\\right)"},"Interval semi2":{latex:"\\left( , \\right]",moveto:"Left",movefor:4,tab:4,icon:"\\left(\\square, \\square\\right]"},Infinit:{latex:"\\infty",tab:4,icon:"\\infty"},"Conjunt dels reals":{latex:"\\mathbb{R}",tab:4,icon:"\\mathbb{R}"},Sinus:{latex:"\\sin()",moveto:"Left",movefor:1,tab:5,icon:"\\sin{\\square}"},Cosinus:{latex:"\\cos()",moveto:"Left",movefor:1,tab:5,icon:"\\cos{\\square}"},Tangent:{latex:"\\tan()",moveto:"Left",movefor:1,tab:5,icon:"\\tan{\\square}"},Arcsinus:{latex:"\\arcsin()",moveto:"Left",movefor:1,tab:5,icon:"\\arcsin{\\square}"},Arccosinus:{latex:"\\arccos()",moveto:"Left",movefor:1,tab:5,icon:"\\arccos{\\square}"},Arctangent:{latex:"\\arctan()",moveto:"Left",movefor:1,tab:5,icon:"\\arctan{\\square}"},"Logaritme Neperià":{latex:"\\ln()",moveto:"Left",movefor:1,tab:5,icon:"\\ln{\\square}"},"Logaritme en base b":{latex:"\\frac{\\log()}{\\log{b}}",moveto:"Left",movefor:4,tab:5,icon:"\\log_b{\\square}"}},keyboard_keys:{letters:[{value:"q",type:"write",class:"ks",display:"q",new_line:!1},{value:"w",type:"write",class:"ks",display:"w",new_line:!1},{value:"e",type:"write",class:"ks",display:"e",new_line:!1},{value:"r",type:"write",class:"ks",display:"r",new_line:!1},{value:"t",type:"write",class:"ks",display:"t",new_line:!1},{value:"y",type:"write",class:"ks",display:"y",new_line:!1},{value:"u",type:"write",class:"ks",display:"u",new_line:!1},{value:"i",type:"write",class:"ks",display:"i",new_line:!1},{value:"o",type:"write",class:"ks",display:"o",new_line:!1},{value:"p",type:"write",class:"ks",display:"p",new_line:!0},{value:"a",type:"write",class:"ks",display:"a",new_line:!1},{value:"s",type:"write",class:"ks",display:"s",new_line:!1},{value:"d",type:"write",class:"ks",display:"d",new_line:!1},{value:"f",type:"write",class:"ks",display:"f",new_line:!1},{value:"g",type:"write",class:"ks",display:"g",new_line:!1},{value:"h",type:"write",class:"ks",display:"h",new_line:!1},{value:"j",type:"write",class:"ks",display:"j",new_line:!1},{value:"k",type:"write",class:"ks",display:"k",new_line:!1},{value:"l",type:"write",class:"ks",display:"l",new_line:!0},{value:"CapsLock",type:"custom",class:"ks long icon",display:"&#8673;",new_line:!1},{value:"z",type:"write",class:"ks",display:"z",new_line:!1},{value:"x",type:"write",class:"ks",display:"x",new_line:!1},{value:"c",type:"write",class:"ks",display:"c",new_line:!1},{value:"v",type:"write",class:"ks",display:"v",new_line:!1},{value:"b",type:"write",class:"ks",display:"b",new_line:!1},{value:"n",type:"write",class:"ks",display:"n",new_line:!1},{value:"m",type:"write",class:"ks",display:"m",new_line:!1},{value:"Backspace",type:"keystroke",class:"ks long icon",display:"&#8678;",new_line:!0},{value:"numpad",type:"custom",class:"ks long",display:"123",new_line:!1},{value:",",type:"write",class:"ks",display:",",new_line:!1},{value:"\\ ",type:"write",class:"ks too_long",display:"Space",new_line:!1},{value:".",type:"write",class:"ks",display:".",new_line:!1},{value:"close",type:"custom",class:"ks long takeup",display:"X",new_line:!1}],numbers:[{value:"1",type:"write",class:"ks",display:"1",new_line:!1},{value:"2",type:"write",class:"ks",display:"2",new_line:!1},{value:"3",type:"write",class:"ks",display:"3",new_line:!1},{value:"+",type:"write",class:"ks",display:"+",new_line:!1},{value:"-",type:"write",class:"ks",display:"&#8315;",new_line:!0},{value:"4",type:"write",class:"ks",display:"4",new_line:!1},{value:"5",type:"write",class:"ks",display:"5",new_line:!1},{value:"6",type:"write",class:"ks",display:"6",new_line:!1},{value:"\\times",type:"write",class:"ks",display:"&times;",new_line:!1},{value:"/",type:"write",class:"ks",display:"&#247;",new_line:!0},{value:"7",type:"write",class:"ks",display:"7",new_line:!1},{value:"8",type:"write",class:"ks",display:"8",new_line:!1},{value:"9",type:"write",class:"ks",display:"9",new_line:!1},{value:"=",type:"write",class:"ks",display:"=",new_line:!1},{value:"Backspace",type:"keystroke",class:"ks long icon",display:"&#8678;",new_line:!0},{value:"letters",type:"custom",class:"ks long",display:"ABC",new_line:!1},{value:"0",type:"write",class:"ks",display:"0",new_line:!1},{value:"?",type:"write",class:"ks",display:"?",new_line:!1},{value:"%",type:"write",class:"ks",display:"%",new_line:!1},{value:"close",type:"custom",class:"ks long takeup",display:"X",new_line:!1}]}}},791:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createQuillFromObject=void 0;var i=n(437),r=n(980),o=n(786),a=n(203),s=n(66),l=n(142),c=n(830);e.createQuillFromObject=function(t,e,n){var u=null,p=n.editor;if(n.formulation){var f="<span>"+n.formulation+"</span>";t.append(f),(0,c.reflowLatex)()}if(t.removeClass("pygen-cloze"),p==s.cfg.QTYPES.C)u=new i.EditorCloze(t,e,n,s.cfg.QTYPES.C,n.initial_latex),t.addClass("pygen-cloze");else if(p==s.cfg.QTYPES.P)u=new o.EditorPanel(t,e,n,s.cfg.QTYPES.P,!0);else if(p==s.cfg.QTYPES.M)n.symbols=n.symbols||[],u=new a.EditorMChoice(t,e,n,s.cfg.QTYPES.M,n.symbols);else if(p==s.cfg.QTYPES.Ms){n.symbols=n.symbols||[];var d=Array.isArray(n.ans);u=new l.EditorMChoiceCheckbox(t,e,n,s.cfg.QTYPES.Ms,d)}else u=p==s.cfg.QTYPES.B?new r.EditorInput(t,e,n,s.cfg.QTYPES.B):new r.EditorInput(t,e,n,s.cfg.QTYPES.S);var h=u.get_qid();return(s.shared[e]||{})[h]=u,u.setStatus(s.cfg.STATUS.UNMODIFIED),n.initial_latex&&p!=s.cfg.QTYPES.C&&(u.latex(n.initial_latex),u.setStatus(s.cfg.STATUS.MODIFIED)),h}},332:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.engineCAS=void 0;var i=n(66),r=n(53),o=n(83);e.engineCAS={compare:function(t){return"sympy"===(t.engine||i.cfg.DEFAULT_ENGINE)?o.sympyCAS.compare(t):r.nerdamerCAS.compare(t)},getAnswer:function(t){return"sympy"===(t.engine||i.cfg.DEFAULT_ENGINE)?o.sympyCAS.getAnswer(t):r.nerdamerCAS.getAnswer(t)}}},53:function(t,e,n){"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.nerdamerCAS=void 0;var a=n(161),s=n(830),l=n(682);function c(t){var e;if(Array.isArray(null===(e=null==t?void 0:t.symbols)||void 0===e?void 0:e.elements)){var n=t.symbols.elements[0];if(!Array.isArray(n))return!0}return!1}function u(t){var e=t.text();return e.startsWith("matrix")?window.nerdamer("size("+e+")"):null}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"clone",value:function(t){return JSON.parse(JSON.stringify(t))}},{key:"decrypt",value:function(t){return atob(t)}},{key:"checkRules",value:function(t){var e=[],n=t.rules||{};"string"==typeof n&&(n=JSON.parse(n));var i=t.latex.join(" ");return n.comma_as_decimal&&(t.latex=t.latex.map((function(t){return t.replace(",",".")}))),n.forbidden&&n.forbidden.forEach((function(t){i[t]&&e.push((0,a.I18n)("sym_notallowed",t))})),n.unique&&n.unique.forEach((function(t){(i.match(new RegExp(t,"g"))||[]).length>1&&e.push((0,a.I18n)("sym_once",t))})),e}}],(n=[{key:"compare",value:function(e){var n=window.nerdamer;return"string"==typeof(e=t.clone(e)).latex&&(e.latex=[e.latex]),new Promise((function(r,o){n.flush(),n.clearVars(),window.nerdamer.getCore().Symbol;var p={x:n("x"),y:n("y"),z:n("z"),t:n("t"),e:n("exp(1)")},f=t.checkRules(e);if(f.length)r({qid:e.qid,msg:f.join(" "),correct:0});else{var d=[];try{if((d=e.latex.map((function(t){return(0,l.parseLatex)(t)}))).filter((function(t){return null==t})).length>0)return r({qid:e.qid,correct:-4,msg:(0,a.I18n)("error_cantprocess")})}catch(t){return console.error(t),r({qid:e.qid,correct:-4,msg:"Error: No es poden processar les respostes donades: "+t})}d.forEach((function(t,e){n.setVar("ua_"+e,t)}));try{(e.symbols||[]).forEach((function(t){if(t.indexOf(":=")>0){var e=t.indexOf(":="),i=t.substring(0,e),r=t.substring(e+2);n.setVar(i,r)}else n.setVar(t,t)}))}catch(t){return console.error(t),void r({qid:e.qid,correct:-2,msg:"Error: no es poden processar els símbols: "+t})}(0,s.items)(p,(function(t,e){e.text()}));var h=[];try{if(e.anse&&(e.ans=t.decrypt(e.anse)),e.anse,e.ans,"string"==typeof e.ans&&(e.ans=[e.ans]),(h=e.ans.map((function(t){return n(t,p)}))).filter((function(t){return null==t})).length>0)return void r({qid:e.qid,correct:-3,msg:"Error: Hi ha respostes 'ans' que no es poden processar"})}catch(t){return console.error(t),void r({qid:e.qid,correct:-3,msg:"Error: No es poden processar les respostes 'ans': "+t})}try{var m=[];if((0,s.zip)(h,d).forEach((function(t){var e=i(t,2),n=e[0],r=e[1];c(n)&&!c(r)?m.push("S'espera un conjunt per resposta. Per exemple \\(\\{\\sqrt{2},\\, \\pi\\}\\)"):u(n)&&!u(r)?m.push("S'espera una matriu per resposta."):!u(n)&&u(r)&&m.push("S'espera una expressió per resposta.");var o=u(n),a=u(r);o&&a&&(o[0]==a[0]&&o[1]==a[1]||m.push("La matriu resposta no té la dimensió correcta."))})),m.length>0)return void r({qid:e.qid,correct:0,msg:m.join(" ")})}catch(t){return console.error(t),void r({qid:e.qid,correct:-4,msg:"Error: S'ha produït un error comprovant els tipus "+t})}var g=0,b="";try{(0,s.zip)(h,d).forEach((function(t){var n=i(t,2),r=n[0],o=n[1];r.text(),o.text();var s=null,l=e.rules||{};if(l.precision)s=Math.abs(r.toDecimal()-o.toDecimal())<l.precision;else if(u(r)){var c=r.subtract(o);r.text(),o.text(),c.text(),s=function(t){var e=!0;return t.each((function(t){e=e&&"0"==t.text()})),e}(c)}else s=l.factor||l.expand?r.eq(o):"0"==(s=r.subtract(o).simplify()).text();if("boolean"==typeof s&&!0===s?(g=1,b=(0,a.I18n)("right_answer")):(b=(0,a.I18n)("wrong_answer"),g=0),0==g)return!0;if(l.num_terms&&o.isPolynomial()){var p=o.symbols.coeffs().length,f=r.symbols.expand().coeffs().length,d=f-p;"equal"==l.num_terms&&0!=d&&(b="La resposta hauria de tenir "+f+" termes sumats o restats.",g=0)}}))}catch(t){console.error("Exception comparing ",t),b=(0,a.I18n)("error_verifying"),g=-1}r({qid:e.qid,correct:g,msg:b})}}))}},{key:"getAnswer",value:function(e){var n=window.nerdamer;return e=t.clone(e),new Promise((function(t,i){var r={x:n("x"),y:n("y"),z:n("z"),t:n("t"),e:n("exp(1)")};try{(e.symbols||[]).forEach((function(t){if(t.indexOf(":=")>0){var e=t.indexOf(":="),i=t.substring(0,e),r=t.substring(e+2);n.setVar(i,r)}else n.setVar(t,t)}))}catch(e){return console.error(e),void t({msg:"Error: no es poden processar els símbols: "+e})}if("string"!=typeof e.ans)t({msg:"Vector ans is not supported yet!"});else{var o=n(e.ans,r),s="".concat((0,a.I18n)("expected_ans"),"<br> \\(").concat(o.latex(),"\\)");t({right_answer:btoa(s)})}}))}}])&&o(e.prototype,n),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.nerdamerCAS=new p},682:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseLatex=void 0;var n=/\\begin\{pmatrix\}(.*?)\\end\{pmatrix\}/gm,i=0;e.parseLatex=function(t){return t=t.replace(n,(function(t,e){return n="matrix("+t.replace("\\begin{pmatrix}","").replace("\\end{pmatrix}","").split("\\\\").map((function(t){return"["+t.split("&").map((function(t){return t.trim()})).join(",")+"]"})).join(",")+")",r="M_"+i,window.nerdamer.setVar(r,n),i++,r;var n,r})),window.nerdamer.convertFromLaTeX(t)}},83:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.sympyCAS=void 0;var r=n(66),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"compare",value:function(t){return new Promise((function(e,n){$.ajax({type:"POST",url:r.cfg.CAS_URL,data:JSON.stringify(t),dataType:"json",success:function(t){e(t)},error:function(t){n(t)}})}))}},{key:"getAnswer",value:function(t){return new Promise((function(e,n){$.ajax({type:"POST",url:r.cfg.GETANSWER_URL,data:JSON.stringify(t),dataType:"json",success:function(t){e(t)},error:function(t){n(t)}})}))}}])&&i(e.prototype,n),o&&i(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.sympyCAS=new o},657:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.findPyGenerators=void 0;var i=n(800),r=n(968),o=n(791),a=n(66),s=n(969),l=n(161),c=n(713),u=n(316),p=n(970),f=n(831),d=n(830);e.findPyGenerators=function(){var t=window.IB||{};$("div[data-pygen]").each((function(e,n){var h=$(n);h.css({position:"relative","min-height":"300px","background-color":"#ffffff","background-image":'url("https://piworld.es/iedib/matheditor/backgrounds/triangles.svg")',"background-position":"center","background-size":"cover"}),h.html("");var m=h.attr("id")||"";m||(m="pyg_"+Math.random().toString(32).substring(2),h.attr("id",m)),a.shared[m]={};var g=$('<div style="display:flex;flex-direction:row-reverse;align-items:baseline;" class="d-print-none"></div>'),b=$("<div></div>"),v=$('<div style="display: flex; flex-direction: row; align-content: flex-start;margin:10px 0; flex-wrap: wrap; gap: 5px;margin-bottom:30px;"></div>'),y=$('<div style="position: absolute;left: 0;right: 0;bottom: 0;margin: 0;background-color: #9fa0ac; display: flex; flex-direction: row; align-content: flex-start; flex-wrap: wrap; gap: 5px;"></div>'),w=new r.LevelIndicator(4),q=h.attr("data-pygen-category")||"general";w.setVisible(a.cfg.HAS_IAPACE&&null!=h.attr("data-pygen-category")),g.append(w.container);var x=1;a.cfg.HAS_IAPACE&&(x=t.iapace.inference(q)),w.setLevel(x);var _=null;if(a.cfg.HAS_IAPACE&&null!=h.attr("data-pygen-goal")){var k=(h.attr("data-pygen-goal")||"").split(";").map((function(t){return t.split(",")}));(_=new s.GoalChecker(q,k)).accomplished()&&g.append($('<span class="pw-goal-reached">'+(0,l.I18n)("goal_reached")+" </span>"))}for(var O=(h.attr("data-pygen")||"").split(";"),S=[],T=0,E=O.length;T<E;T++){var j=O[T],C=null,A={};if(j.indexOf("[")>0){C=j.split("[")[0].trim();for(var D=j.split("[")[1].replace("]","").split(","),I=0,P=D.length;I<P;I++){var M=D[I];if(M.indexOf("=")>0){var Q=M.split("="),L=Q[0],R=Q[1];R=R.indexOf("'")>=0?R.replace(/'/g,""):parseFloat(R),A[L]=R}}}else C=j.trim();Object.keys(A).length?S.push([C,A]):S.push([C])}var z=new u.SeqBasic(S);if(S.length>1){var F=(h.attr("data-pygen-order")||"random").trim().toLowerCase();F.startsWith("random")||F.startsWith("weighted")?z=new p.SeqRandomWeighted(S,F):F.startsWith("sequence")&&(z=new f.SeqSequence(S,F))}var B=$('<button class="btn btn-sm btn-primary"><i class="fa fas fa-check"></i> '+(0,l.I18n)("check")+"</button>"),N=$('<button class="btn btn-sm btn-warning" style="display:none;"><i class="fa far fa-life-ring"></i> '+(0,l.I18n)("wildcard")+" 50%</button>"),U=null,G=null,H=function(){B.prop("disabled",!0),V.prop("disabled",!0),W.prop("disabled",!0),N.css("display","none"),a.cfg.HAS_IAPACE&&(x=t.iapace.inference(q)),w.setLevel(x);var e=z.next();$.ajax({type:"POST",url:a.cfg.PYGEN_URL,data:JSON.stringify({activities:[e],level:x}),dataType:"json",success:function(e){if(e.msg)return U=null,b.html('<p style="color:darkred">ERROR<br>'+JSON.stringify(e.msg)+"</p>"),console.error("ERROR: ",e),void V.prop("disabled",!1);b.html("");var n=$("<p><span>"+(h.attr("data-pygen-formulation")||"")+"</span> "+e.formulation+"</p>");b.append(n);var r=atob(e.mq64),s=JSON.parse(r);if(a.cfg.HAS_IAPACE){var u=t.iapace.findCreate(q);u&&(0,d.sum)(u.h)>=30&&N.css("display",null==s.comodi?"none":"")}s.category=q,s.palettes||(s.palettes="all"),s.editor==a.cfg.QTYPES.M&&(s.editor=a.cfg.QTYPES.Ms),U=s,s.initial_latex&&(s.initial_latex=(0,c.processMqIni)(s.initial_latex));var p=[];if(s.symbols)for(var f=s.symbols.split(";"),v=0,y=f.length;v<y;v++){var w=f[v];w.trim()&&p.push(w.trim())}s.symbols=p;var x=[];s.rules&&(x=JSON.parse(s.rules)),s.rules=x;var k=(0,o.createQuillFromObject)(b,m,s);(G=a.shared[m][k]).isPigen=!0,B.off();(0,i.bindSubmitActionButton)(m,B,(function(e){(V.prop("disabled",!1),W.prop("disabled",!1),a.cfg.HAS_IAPACE&&(t.iapace.addScore(q,e),t.iapace.save()),_&&_.reached())&&(0==g.find(".pw-goal-reached").length&&g.append($('<span class="pw-goal-reached">'+(0,l.I18n)("goal_reached")+" </span>")),"confetti"==h.attr("data-pygen-celebration")&&window.Confetti&&new window.Confetti(h[0]).play())})),a.shared[m],(0,d.reflowLatex)(),B.prop("disabled",!1)},error:function(t){U=null,G=null,b.html('<div><p style="color:darkred">ERROR<br>'+JSON.stringify(t)+"</p></div>"),V.prop("disabled",!1)}})},W=$('<button class="btn btn-sm btn-outline-info" title="Mostra la resposta"><i class="fa fas fa-question-circle"></i> '+(0,l.I18n)("answer")+"</button>");W.on("click",(function(t){t.preventDefault(),G?G.status!=a.cfg.STATUS.CORRECT&&G.wrong_attemps<1||(B.prop("disabled",!0),W.prop("disabled",!0),G.showAnswer&&G.showAnswer()):console.error("Missing currentEditor here :-(")}));var V=$('<button class="btn btn-sm btn-outline-primary" title="Genera una nova pregunta"><i class="fa fas fa-arrow-circle-right"></i> '+(0,l.I18n)("next")+"</button>");if(V.on("click",(function(t){t.preventDefault();for(var e=Object.keys(a.shared[m]||{}),n=0,i=e.length;n<i;n++){var r=parseInt(e[n]);a.shared[m][r].dispose(),delete a.shared[m][r]}H()})),N.on("click",(function(t){t.preventDefault(),G&&U&&U.comodi&&(G.comodiUsed=!0,N.css("display","none"),G.latex(U.comodi),G.status=a.cfg.STATUS.MODIFIED)})),v.append(B),v.append(V),v.append(W),v.append(N),h.append(g),h.append(b),h.append(v),"none"!=h.attr("data-copyright")){var X=$('<span style="padding:4px;font-size:70%;color:whitesmoke;"><em>pyQuizz</em> by Josep Mulet (c) 2021-22</span>');y.append(X),h.append(y)}H()}))}},66:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.sharedContext=e.sharedDlg=e.shared=e.MathField=e.StaticMath=e.cfg=void 0;var r=n(830),o=function(t){for(var e={},n=t.substring(1).split("&"),i=0;i<n.length;i++){var r=n[i].trim().split("=");r[0]&&(1==r.length?e[r[0]]="1":e[r[0]]=r[1])}return e};window.MQWidgets=window.MQWidgets||{};var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.DEFAULT_ENGINE="sympy",this.NERDAMER_URL="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/all.min.js",this.BACKEND_BASEURL="",this.MQWIDGETS_BASEURL="https://iedib.github.io/mqwidgets2/dist/",this.pageInfo=function(){var t,e;if(!document.querySelector)return{};var n=-1,i="Usuari convidat",r=document.querySelector("[data-userid]");r&&(n=parseInt(r.getAttribute("data-userid")||"-1"));var a=document.querySelector(".usertext");a&&(i=a.innerText);var s={};location.search&&(s=o(location.search));var l=s.chapterid;if(!l){var c=document.querySelector('input[name="chapterid"]');c&&(l=c.value)}var u=s.id;if(!u){var p=document.querySelector('div.singlebutton > form > input[name="id"]');p&&(u=p.value)}var f=document.cookie||"",d=f.indexOf("="),h="";d>0&&(h=f.substr(d+1)),h&&h.indexOf(";")>0&&(h=h.split(";")[0]);var m,g="-1",b=document.querySelector(".homelink > a");if(b){m=b.innerText;var v="?"+(b.href.split("?")[1]||"");g=o(v).id}var y=null!=document.querySelector(".teacherdash.nav-item.nav-link")?1:0,w=(location.href.split("?")[0]||"").replace("/mod/book/view.php","");return{userId:n,userFullname:i,bookId:u,chapterId:l,assignNum:(null===(t=window.iedibAPI)||void 0===t?void 0:t.lliurament.id)||0,assignName:(null===(e=window.iedibAPI)||void 0===e?void 0:e.lliurament.title)||"",courseName:m,courseId:g,isTeacher:y,site:w,moodleSession:h}}(),this.STATUS={UNMODIFIED:100,MODIFIED:200,CORRECT:1,WRONG:0},this.QTYPES={S:"simple",B:"basic",C:"cloze",P:"panel",M:"mchoice",Ms:"mchoice*"},this.HAS_IAPACE=null!=window.IB&&null!=window.IB.iapace,this.LANG="",this.RIGHT_ICON="fa fas fa-check",this.WRONG_ICON="fa fas fa-times",this.MAX_ATTEMPTS=2}var e,n,a;return e=t,(n=[{key:"CAS_URL",get:function(){return(0,r.urlJoin)(this.BACKEND_BASEURL,"compare")}},{key:"PYGEN_URL",get:function(){return(0,r.urlJoin)(this.BACKEND_BASEURL,"generate")}},{key:"GETANSWER_URL",get:function(){return(0,r.urlJoin)(this.BACKEND_BASEURL,"getanswer")}},{key:"MATHQUILL_URL",get:function(){return(0,r.urlJoin)(this.MQWIDGETS_BASEURL,"/lib/mathquill.matrix.min.js")}},{key:"setUserConfig",value:function(t){"nerdamer"==t.engines[0]&&(this.DEFAULT_ENGINE="nerdamer");var e=t.engines.filter((function(t){return t.trim().startsWith("http")}));e.length&&(this.BACKEND_BASEURL=e[0]),t.lang&&(this.LANG=t.lang),t.mqwBaseurl&&(this.MQWIDGETS_BASEURL=t.mqwBaseurl)}},{key:"isNerdamer",value:function(){return null!=window.nerdamer}}])&&i(e.prototype,n),a&&i(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.cfg=new a;var s={};e.StaticMath=function(t){return s.StaticMath||(s=window.MathQuill.getInterface(2)),s.StaticMath(t)},e.MathField=function(t,e){return s.MathField||(s=window.MathQuill.getInterface(2)),s.MathField(t,e)},e.shared={},e.sharedDlg={},e.sharedContext={}},969:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.GoalChecker=void 0;var r=n(66),o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.category=e,this.rules=n}var e,n,o;return e=t,(n=[{key:"accomplished",value:function(t){var e=window.IB||{};if(!r.cfg.HAS_IAPACE)return!1;if(!t){var n=e.iapace.find(this.category);return null!=n&&n.d}return e.iapace.findCreate(this.category).d=t,e.iapace.save(),t}},{key:"reached",value:function(){var t=window.IB||{};if(!r.cfg.HAS_IAPACE)return!1;if(this.accomplished())return!1;for(var e=t.iapace.findCreate(this.category),n=!1,i=this.rules.length,o=0;!n&&o<i;){var a=!0,s=this.rules[o],l=0;if(isNaN(s[0])?l+=1:a=a&&e.n>=parseInt(s[0]),isNaN(s[1]))l+=1;else{var c=0;e.n>0&&(c=e.s/(1*e.n)),a=a&&c>=parseFloat(s[1])}isNaN(s[2])?l+=1:a=a&&t.iapace.inference(this.category)>=parseInt(s[2]),l<3&&(n=a),o+=1}return n&&this.accomplished(!0),n}}])&&i(e.prototype,n),o&&i(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.GoalChecker=o},713:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createQuillFromDataAttr=e.processMqIni=void 0;var i=n(791),r=n(66);function o(t){return t=(t=(t=t||"").replace(/\?\d*?/g,"\\MathQuillMathField{}")).replace(/M\[(\d+)x(\d+)\]/g,(function(t,e,n){for(var i=parseInt(e),r=parseInt(n),o=[],a=new Array(r),s=0;s<i;s++)o.push(a.join(" & "));return"\\begin{pmatrix} "+o.join(" \\\\ ")+" \\end{pmatrix}"}))}e.processMqIni=o,e.createQuillFromDataAttr=function(t,e){var n=t.attr("data-mq")||"simple",a=t.attr("data-mq-engine"),s=t.attr("data-mq-ans"),l="ans";if(s||(l="anse",s=t.attr("data-mq-anse"))){if((s=s.trim()).startsWith("[")&&s.endsWith("]"))for(var c=0,u=(s=JSON.parse(s)).length;c<u;c++)s[c]=""+s[c];var p=o(t.attr("data-mq-ini")),f=t.attr("data-mq-symbols");if(n!==r.cfg.QTYPES.C||p){var d="";t.attr("data-mq-ra")&&(d=atob(t.attr("data-mq-ra")||""));var h=[];if(f)for(var m=f.split(";"),g=0,b=m.length;g<b;g++){var v=m[g];v.trim()&&h.push(v.trim())}var y=t.attr("data-mq-rules"),w=[];y&&(w=JSON.parse(y));var q=[],x=t.attr("data-mq-palettes");if(x)x.split(",").forEach((function(t){q.push(t.trim())}));var _={engine:a,editor:n,symbols:h,right_answer:d,initial_latex:p,rules:w,palettes:q,ans:s,ansType:l};t.attr("data-mq-formulation")&&(_.formulation=t.attr("data-mq-formulation")),(0,i.createQuillFromObject)(t,e,_)}else console.error("> MQ ",t," is of type cloze but it has no data-mq-ini!")}else console.error("> MQ has no data-mq-ans/e!")}},216:function(t,e,n){"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(e,"__esModule",{value:!0}),e.findQuillGroups=void 0;var o=n(800),a=n(791),s=n(66),l=n(713),c=n(830),u=["editor","engine","formulation","initial_latex","ansType","ans","anse","right_answer","symbols","rules","palettes"];e.findQuillGroups=function(t,e){(e=e||$("body")).find(".pw-mq-group").each((function(n,r){var p=$(r);if(!p.hasClass("pw-mq-done")){p.addClass("pw-mq-done");var f=p.attr("id");f||(f="g_"+Math.random().toString(32).substring(2),p.attr("id",f)),s.shared[f]={},function(t,e){s.sharedContext[e]={}}(0,f),function(t,e,n){n&&(0,c.items)(n,(function(t,n){var i=$("#"+t);if(i.length){i.removeAttr("data-mq");try{var r=atob(n),o=JSON.parse(r);o.initial_latex=(0,l.processMqIni)(o.initial_latex||""),(0,a.createQuillFromObject)(i,e,o)}catch(t){console.error("Invalid or corrupted MQ definition:: ",n),console.error(t)}}else console.error("The element with id="+t+" does not exist.")})),t.find("[data-mq]").each((function(t,n){var r=$(n),o=$(n).attr("data-mq")||"simple";if((0,c.hasValue)(s.cfg.QTYPES,o))console.error("Definition via data-attributes in deprecated since version 2.0. Please encode the definition in a single data-mq field."),(0,l.createQuillFromDataAttr)(r,e);else try{var p=atob(o),f={},d=JSON.parse(p);Array.isArray(d)?(d.length<u.length&&console.error("The definition does not contain all the fields. Is it corrupted?"),(0,c.zip)(u,d).forEach((function(t){var e=i(t,2),n=e[0],r=e[1];f[n]=r}))):f=d,f.initial_latex=(0,l.processMqIni)(f.initial_latex||""),(0,a.createQuillFromObject)(r,e,f)}catch(t){console.error("Invalid or corrupted MQ definition:: ",o),console.error(t)}}))}(p,f,t);var d=(0,o.createSubmitButtonForGroup)(f);p.append(d),null==e&&window.setTimeout((function(){(0,c.items)(s.shared,(function(t,e){(0,c.items)(e,(function(t,e){e.reflow&&e.reflow()}))}))}),800)}}))}},452:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.applyPolyfills=void 0,e.applyPolyfills=function(){Array.prototype.forEach||(Array.prototype.forEach=function(t,e){if("function"!=typeof t)throw new TypeError(t+" is not a function");var n=this;e=e||this;for(var i=0,r=n.length;i!==r;++i)t.call(e,n[i],i,n)}),Array.prototype.map||(Array.prototype.map=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");for(var e=[],n=0;n<this.length;n++)e.push(t(this[n],n,this));return e}),Array.prototype.filter||(Array.prototype.filter=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");for(var e=[],n=0;n<this.length;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return e}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"function"!=typeof Number.isNaN||(Number.isNaN=function(t){return null!==t&&(t!=t||+t!=t)})}},316:function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.SeqBasic=void 0;var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lpygens=e}var e,i,r;return e=t,(i=[{key:"next",value:function(){return this.lpygens[0]}}])&&n(e.prototype,i),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.SeqBasic=i},970:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=l(t);if(e){var r=l(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.SeqRandomWeighted=void 0;var c=n(830),u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(l,t);var e,n,i,s=a(l);function l(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=s.call(this,t),e=(e||"random").trim().toLowerCase(),n.definition=e;var i=[];if(e.startsWith("weighted:")){var r=(e=e.replace("weighted:","")).split(",");i=r.map((function(t){return parseFloat(t)}))}else for(var o=1/t.length,a=0,u=t.length;a<u;a++)i.push(o);if(n.lpygens=t,n.lpygens.length>i.length)for(;n.lpygens!=i.length;)i.push(1);for(;i.length>t.length;)i.pop();var p=(0,c.sum)(i),f=0;return i.forEach((function(t,e){f=(t/=p)+f,i[e]=f})),n.weights=i,n}return e=l,(n=[{key:"next",value:function(){if("random"==this.definition){var t=Math.floor(Math.random()*this.lpygens.length);return this.lpygens[t]}for(var e=Math.random(),n=0,i=this.weights[n];i<e;)n+=1,i=this.weights[n];return this.lpygens[n]}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(316).SeqBasic);e.SeqRandomWeighted=u},831:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.SeqSequence=void 0;var u=n(830),p=n(316),f=n(970),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,n,i,s=a(c);function c(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=s.call(this,t)).lpygens=t,e=e.replace("sequence:","").trim().toLowerCase(),n.positions=[],n.terminalGen=void 0;var i=e.split(","),r=l(n);return i.forEach((function(e,n){if((0,u.isNumeric)(e)&&null==r.terminalGen)for(var o=parseInt(e),a=0;a<o;a++)r.positions.push(n);else if(e.startsWith("*")&&null==r.terminalGen){for(var s=t.slice(n),l=[],c=!1,p=n;p<i.length;p++){var d=i[p];d.indexOf("*")>=0&&d.indexOf("(")>0?(d=d.replace("*","").replace("(","").replace(")",""),l.push(parseFloat(d)),c=!0):l.push(1)}var h="random";c&&(h="weighted: "+l.join(",")),r.terminalGen=new f.SeqRandomWeighted(s,h)}})),n.pointer=0,n}return e=c,(n=[{key:"next",value:function(){if(this.pointer>=this.positions.length&&this.terminalGen)return this.terminalGen.next();this.pointer=this.pointer%this.positions.length;var t=this.positions[this.pointer];return this.pointer+=1,this.lpygens[t]}}])&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(p.SeqBasic);e.SeqSequence=d},830:function(t,e){"use strict";function n(t,e,n,i,r,o){return s(function(t,e){return t<<e|t>>>32-e}(s(s(e,t),s(i,o)),r),n)}function i(t,e,i,r,o,a,s){return n(e&i|~e&r,t,e,o,a,s)}function r(t,e,i,r,o,a,s){return n(e&r|i&~r,t,e,o,a,s)}function o(t,e,i,r,o,a,s){return n(e^i^r,t,e,o,a,s)}function a(t,e,i,r,o,a,s){return n(i^(e|~r),t,e,o,a,s)}function s(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}Object.defineProperty(e,"__esModule",{value:!0}),e.urlJoin=e.isNumeric=e.createLinkSheet=e.createStyleSheet=e.insertScript=e.MD5=e.copyPropsFromTo=e.hasValue=e.zip=e.items=e.sum=e.sanitizeLaTeX=e.reflowLatex=void 0,e.reflowLatex=function(){window.MathJax&&(window.MathJax.typesetPromise&&window.MathJax.typesetPromise(),window.MathJax.Hub&&window.MathJax.Hub.Queue&&window.MathJax.Hub.Queue(["Typeset",MathJax.Hub]))},e.sanitizeLaTeX=function(t){return t.replace(/·/g,"*")},e.sum=function(t){for(var e=0,n=0,i=t.length;n<i;n++)e+=t[n];return e},e.items=function(t,e){if(Array.isArray(t))for(var n=0,i=t.length;n<i;n++)e(n,t[n]);else{var r=Object.keys(t);for(n=0,i=r.length;n<i;n++){var o=r[n];e(o,t[o])}}},e.zip=function(t,e){for(var n=Math.min(t.length,e.length),i=[],r=0;r<n;r++)i.push([t[r],e[r]]);return i},e.hasValue=function(t,e){for(var n=!1,i=Object.keys(t),r=0;!n&&r<i.length;){n=t[i[r]]==e,r++}return n},e.copyPropsFromTo=function(t,e){for(var n=Object.keys(t),i=0,r=n.length;i<r;i++){var o=n[i];e[o]=t[o]}},e.MD5=function(t){var e=function(t){for(var e,n="0123456789ABCDEF",i="",r=0;r<t.length;r++)e=t.charCodeAt(r),i+=n.charAt(e>>>4&15)+n.charAt(15&e);return i}(function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}(function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n=1732584193,l=-271733879,c=-1732584194,u=271733878,p=0;p<t.length;p+=16){var f=n,d=l,h=c,m=u;l=a(l=a(l=a(l=a(l=o(l=o(l=o(l=o(l=r(l=r(l=r(l=r(l=i(l=i(l=i(l=i(l,c=i(c,u=i(u,n=i(n,l,c,u,t[p+0],7,-680876936),l,c,t[p+1],12,-389564586),n,l,t[p+2],17,606105819),u,n,t[p+3],22,-1044525330),c=i(c,u=i(u,n=i(n,l,c,u,t[p+4],7,-176418897),l,c,t[p+5],12,1200080426),n,l,t[p+6],17,-1473231341),u,n,t[p+7],22,-45705983),c=i(c,u=i(u,n=i(n,l,c,u,t[p+8],7,1770035416),l,c,t[p+9],12,-1958414417),n,l,t[p+10],17,-42063),u,n,t[p+11],22,-1990404162),c=i(c,u=i(u,n=i(n,l,c,u,t[p+12],7,1804603682),l,c,t[p+13],12,-40341101),n,l,t[p+14],17,-1502002290),u,n,t[p+15],22,1236535329),c=r(c,u=r(u,n=r(n,l,c,u,t[p+1],5,-165796510),l,c,t[p+6],9,-1069501632),n,l,t[p+11],14,643717713),u,n,t[p+0],20,-373897302),c=r(c,u=r(u,n=r(n,l,c,u,t[p+5],5,-701558691),l,c,t[p+10],9,38016083),n,l,t[p+15],14,-660478335),u,n,t[p+4],20,-405537848),c=r(c,u=r(u,n=r(n,l,c,u,t[p+9],5,568446438),l,c,t[p+14],9,-1019803690),n,l,t[p+3],14,-187363961),u,n,t[p+8],20,1163531501),c=r(c,u=r(u,n=r(n,l,c,u,t[p+13],5,-1444681467),l,c,t[p+2],9,-51403784),n,l,t[p+7],14,1735328473),u,n,t[p+12],20,-1926607734),c=o(c,u=o(u,n=o(n,l,c,u,t[p+5],4,-378558),l,c,t[p+8],11,-2022574463),n,l,t[p+11],16,1839030562),u,n,t[p+14],23,-35309556),c=o(c,u=o(u,n=o(n,l,c,u,t[p+1],4,-1530992060),l,c,t[p+4],11,1272893353),n,l,t[p+7],16,-155497632),u,n,t[p+10],23,-1094730640),c=o(c,u=o(u,n=o(n,l,c,u,t[p+13],4,681279174),l,c,t[p+0],11,-358537222),n,l,t[p+3],16,-722521979),u,n,t[p+6],23,76029189),c=o(c,u=o(u,n=o(n,l,c,u,t[p+9],4,-640364487),l,c,t[p+12],11,-421815835),n,l,t[p+15],16,530742520),u,n,t[p+2],23,-995338651),c=a(c,u=a(u,n=a(n,l,c,u,t[p+0],6,-198630844),l,c,t[p+7],10,1126891415),n,l,t[p+14],15,-1416354905),u,n,t[p+5],21,-57434055),c=a(c,u=a(u,n=a(n,l,c,u,t[p+12],6,1700485571),l,c,t[p+3],10,-1894986606),n,l,t[p+10],15,-1051523),u,n,t[p+1],21,-2054922799),c=a(c,u=a(u,n=a(n,l,c,u,t[p+8],6,1873313359),l,c,t[p+15],10,-30611744),n,l,t[p+6],15,-1560198380),u,n,t[p+13],21,1309151649),c=a(c,u=a(u,n=a(n,l,c,u,t[p+4],6,-145523070),l,c,t[p+11],10,-1120210379),n,l,t[p+2],15,718787259),u,n,t[p+9],21,-343485551),n=s(n,f),l=s(l,d),c=s(c,h),u=s(u,m)}return Array(n,l,c,u)}(function(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}(t),8*t.length)));return e.toLowerCase()},e.insertScript=function(t){var e=document.createElement("script");e.src=t,e.type="text/javascript",e.async=!0;var n=new Promise((function(t,n){e.onload=function(){t()},e.onerror=function(){n()},e.onabort=function(){n()}}));return document.head.appendChild(e),n},e.createStyleSheet=function(t,e){if(!e||!document.getElementById(e)){var n=document.createElement("style");n.innerHTML=t,e&&(n.id=e),document.getElementsByTagName("head")[0].appendChild(n)}},e.createLinkSheet=function(t,e){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=t,document.getElementsByTagName("head")[0].appendChild(n)},e.isNumeric=function(t){return null!=(t||"").replace(/\s+/g,"").match(/^[+\-]?[0-9]+\.?[0-9]*$/)},e.urlJoin=function(t,e){return t=t.trim(),e=e.trim(),t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),t+e}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}var i,r={};(i=document.createElement("style")).innerHTML='div[data-pygen]{min-height:100px;margin:10px;padding:10px;background:#f8f8ff;box-shadow:3px 3px gray}.pw-mq-feedback{margin:10px;padding:10px;background-color:#cbe9f4;color:#121228}@keyframes blinker{50%{color:#e4cfe4}}.pw-goal-reached{font-weight:bold;margin:0 15px;padding:3px;border-radius:3px;font-size:90%;color:#3b1d3b;animation:blinker .5s linear 4}.pw-me-blocker{background:gray;opacity:.5;pointer-events:none}.pw-refresh{cursor:pointer;float:left;margin-right:15px}.pw-refresh>i{color:#1e90ff}.pw-mq-group{margin-bottom:60px;border-left:1px solid #1e90ff;padding-left:20px}.pw-me-dlg{display:flex;flex-direction:column;position:fixed;margin:auto;top:0;right:0;bottom:0;left:0;border:2px solid #d3d3d3;z-index:100;background:#fff;box-shadow:4px 4px 4px #888;border-radius:5px}.pw-me-dlg-header{background:#f5f5f5;width:100%;height:23px;border-bottom:2px solid #d3d3d3}.pw-me-dlg-headertitle{color:#000;margin-left:8px}.pw-me-dlg-controls{background:#fff;display:flex;flex-direction:row;justify-content:space-between;margin:5px}.pw-me-btn-openeditor{background:#f5f5f5;vertical-align:top}.pw-me-btn-openeditor:hover{background:#fff}.pw-me-btn-openeditor>i.fas{color:darkred}.pw-me-tabmenu{width:100%}.pw-me-tabspanel{width:100%;height:25px;background:#d3d3d3}.pw-me-tabcontents{width:100%;background:#e3e3e3}.pw-me-btn-tab{background:#d3d3d3;padding:0 5px}.pw-me-btn-active{background:#fff}.pw-me-tabcontainer{width:100%;display:none;flex-direction:row;flex-wrap:wrap}.pw-me-submitgroup{margin:auto}.pw-me-btn-dlgclose{color:gray;width:23px;height:23px;float:right;padding:0}.pw-me-editorpanel{display:flex;flex-direction:column;background:#fff;flex-grow:1;border:1px solid #d3d3d3}.pw-me-editorpanel-mathinput{width:97%;margin:5px auto;padding:15px;background:#fff;flex-grow:1}.pw-me-btn-toolbar{height:35px;overflow:hidden;font-weight:bold}.pw-me-btn-toolbar>span{cursor:pointer;font-size:90%}.pw-me-btn-toolbar:hover{background:#fff}.pw-me-editorinput{display:inline-flex;margin:4px;padding:4px;background:#d5edff;border-radius:5px}.pw-me-editorinput>div>span{background:#fff;min-width:100px}.pw-quill-group{margin:5px 5px 80px 5px;border-left:1px solid gray;padding-left:10px}.pw-me-check{align-self:center}.pw-me-editorinput.pw-me-wrong,.pw-me-mchoice.pw-me-wrong{background:#fddcdc}.pw-me-editorinput.pw-me-wrong>.pw-me-check>span,.pw-me-mchoice.pw-me-wrong>.pw-me-check>span{color:#fff;margin:5px;background:darkred;border-radius:50%;width:22px;height:22px;text-align:center;vertical-align:middle;padding:3px 6px}.pw-me-editorinput.pw-me-right,.pw-me-mchoice.pw-me-right{background:#f0fddc}.pw-me-editorinput.pw-me-right>.pw-me-check>span,.pw-me-mchoice.pw-me-right>.pw-me-check>span{color:#fff;margin:5px;background:#358a24;border-radius:50%;width:22px;height:22px;text-align:center;vertical-align:middle;padding:3px}.pw-me-editorinput.pw-me-alert,.pw-me-mchoice.pw-me-alert{background:#f2dcfd}.pw-me-editorinput.pw-me-alert>.pw-me-check>span,.pw-me-mchoice.pw-me-alert>.pw-me-check>span{color:#fff;margin:5px;background:#681733;border-radius:50%;width:22px;height:22px;text-align:center;vertical-align:middle;padding:3px}.pw-me-btn-showanswer>i{color:darkred}.pw-answer-holder{margin:15px;overflow:auto;height:150px}.mq-editable-field{background:#fff}.pw-me-btn-dropdownmenu{display:none;position:absolute;top:65px;left:140px;padding:5px;border:1px solid gray;z-index:1000;background:#fff}.pw-me-mchoice{display:inline-flex;vertical-align:middle}.pw-square-root{background-position:50% 50%;background-size:20px 20px;background-repeat:no-repeat;background-image:url("https://piworld.es/iedib/mqwidgets2/pw-square-root.png");display:inline-block;width:16px;height:16px}@font-face{font-family:Symbola;src:url(fonts/Symbola.eot);src:local("Symbola Regular"),local("Symbola"),url(fonts/Symbola.woff2) format("woff2"),url(fonts/Symbola.woff) format("woff"),url(fonts/Symbola.ttf) format("truetype"),url(fonts/Symbola.svg#Symbola) format("svg")}.mq-editable-field{display:-moz-inline-box;display:inline-block}.mq-editable-field .mq-cursor{border-left:1px solid #000;margin-left:-1px;position:relative;z-index:1;padding:0;display:-moz-inline-box;display:inline-block}.mq-editable-field .mq-cursor.mq-blink{visibility:hidden}.mq-editable-field,.mq-math-mode .mq-editable-field{border:1px solid gray}.mq-editable-field.mq-focused,.mq-math-mode .mq-editable-field.mq-focused{box-shadow:#8bd 0 0 1px 2px,inset #6ae 0 0 2px 0;border-color:#709ac0;border-radius:1px}.mq-math-mode .mq-editable-field{margin:1px}.mq-editable-field .mq-latex-command-input{color:inherit;font-family:"Courier New",monospace;border:1px solid gray;padding-right:1px;margin-right:1px;margin-left:2px}.mq-editable-field .mq-latex-command-input.mq-empty{background:rgba(0,0,0,0)}.mq-editable-field .mq-latex-command-input.mq-hasCursor{border-color:ActiveBorder}.mq-editable-field.mq-empty:after,.mq-editable-field.mq-text-mode:after,.mq-math-mode .mq-empty:after{visibility:hidden;content:"c"}.mq-editable-field .mq-cursor:only-child:after,.mq-editable-field .mq-textarea+.mq-cursor:last-child:after{visibility:hidden;content:"c"}.mq-editable-field .mq-text-mode .mq-cursor:only-child:after{content:""}.mq-editable-field.mq-text-mode{overflow-x:auto;overflow-y:hidden}.mq-root-block,.mq-math-mode .mq-root-block{display:-moz-inline-box;display:inline-block;width:100%;padding:2px;box-sizing:border-box;white-space:nowrap;overflow:hidden;vertical-align:middle}.mq-math-mode{font-variant:normal;font-weight:normal;font-style:normal;font-size:115%;line-height:1;display:-moz-inline-box;display:inline-block}.mq-math-mode .mq-non-leaf,.mq-math-mode .mq-scaled{display:-moz-inline-box;display:inline-block}.mq-math-mode var,.mq-math-mode .mq-text-mode,.mq-math-mode .mq-nonSymbola{font-family:"Times New Roman",Symbola,serif;line-height:.9}.mq-math-mode *{font-size:inherit;line-height:inherit;margin:0;padding:0;border-color:#000;-webkit-user-select:none;-moz-user-select:none;user-select:none;box-sizing:border-box}.mq-math-mode .mq-empty{background:#ccc}.mq-math-mode .mq-empty.mq-root-block{background:rgba(0,0,0,0)}.mq-math-mode.mq-empty{background:rgba(0,0,0,0)}.mq-math-mode .mq-text-mode{display:inline-block;white-space:pre}.mq-math-mode .mq-text-mode.mq-hasCursor{box-shadow:inset #a9a9a9 0 .1em .2em;padding:0 .1em;margin:0 -0.1em;min-width:1ex}.mq-math-mode .mq-font{font:1em "Times New Roman",Symbola,serif}.mq-math-mode .mq-font *{font-family:inherit;font-style:inherit}.mq-math-mode b,.mq-math-mode b.mq-font{font-weight:bolder}.mq-math-mode var,.mq-math-mode i,.mq-math-mode i.mq-font{font-style:italic}.mq-math-mode var.mq-f{margin-right:.2em;margin-left:.1em}.mq-math-mode .mq-roman var.mq-f{margin:0}.mq-math-mode big{font-size:200%}.mq-math-mode .mq-int>big{display:inline-block;transform:scaleX(0.7);vertical-align:-0.16em}.mq-math-mode .mq-int>.mq-supsub{font-size:80%;vertical-align:-1.1em;padding-right:.2em}.mq-math-mode .mq-int>.mq-supsub>.mq-sup>.mq-sup-inner{vertical-align:1.3em}.mq-math-mode .mq-int>.mq-supsub>.mq-sub{margin-left:-0.35em}.mq-math-mode .mq-roman{font-style:normal}.mq-math-mode .mq-sans-serif{font-family:sans-serif,Symbola,serif}.mq-math-mode .mq-monospace{font-family:monospace,Symbola,serif}.mq-math-mode .mq-overline{border-top:1px solid #000;margin-top:1px}.mq-math-mode .mq-underline{border-bottom:1px solid #000;margin-bottom:1px}.mq-math-mode .mq-binary-operator{padding:0 .2em;display:-moz-inline-box;display:inline-block}.mq-math-mode .mq-supsub{text-align:left;font-size:90%;vertical-align:-0.5em}.mq-math-mode .mq-supsub.mq-sup-only{vertical-align:.5em}.mq-math-mode .mq-supsub.mq-sup-only .mq-sup{display:inline-block;vertical-align:text-bottom}.mq-math-mode .mq-supsub .mq-sup{display:block}.mq-math-mode .mq-supsub .mq-sub{display:block;float:left}.mq-math-mode .mq-supsub .mq-binary-operator{padding:0 .1em}.mq-math-mode .mq-supsub .mq-fraction{font-size:70%}.mq-math-mode sup.mq-nthroot{font-size:80%;vertical-align:.8em;margin-right:-0.6em;margin-left:.2em;min-width:.5em}.mq-math-mode .mq-paren{padding:0 .1em;vertical-align:top;transform-origin:center .06em}.mq-math-mode .mq-paren.mq-ghost{color:silver}.mq-math-mode .mq-paren+span{margin-top:.1em;margin-bottom:.1em}.mq-math-mode .mq-array{vertical-align:middle;text-align:center}.mq-math-mode .mq-array>span{display:block}.mq-math-mode .mq-operator-name{font-family:Symbola,"Times New Roman",serif;line-height:.9;font-style:normal}.mq-math-mode var.mq-operator-name.mq-first{padding-left:.2em}.mq-math-mode var.mq-operator-name.mq-last,.mq-math-mode .mq-supsub.mq-after-operator-name{padding-right:.2em}.mq-math-mode .mq-fraction{font-size:90%;text-align:center;vertical-align:-0.4em;padding:0 .2em}.mq-math-mode .mq-fraction,.mq-math-mode .mq-large-operator,.mq-math-mode x:-moz-any-link{display:-moz-groupbox}.mq-math-mode .mq-fraction,.mq-math-mode .mq-large-operator,.mq-math-mode x:-moz-any-link,.mq-math-mode x:default{display:inline-block}.mq-math-mode .mq-numerator,.mq-math-mode .mq-denominator,.mq-math-mode .mq-dot-recurring{display:block}.mq-math-mode .mq-numerator{padding:0 .1em}.mq-math-mode .mq-denominator{border-top:1px solid;float:right;width:100%;padding:.1em}.mq-math-mode .mq-dot-recurring{text-align:center;height:.3em}.mq-math-mode .mq-sqrt-prefix{padding-top:0;position:relative;top:.1em;vertical-align:top;transform-origin:top}.mq-math-mode .mq-sqrt-stem{border-top:1px solid;margin-top:1px;padding-left:.15em;padding-right:.2em;margin-right:.1em;padding-top:1px}.mq-math-mode .mq-diacritic-above{display:block;text-align:center;line-height:.4em}.mq-math-mode .mq-diacritic-stem{display:block;text-align:center}.mq-math-mode .mq-hat-prefix{display:block;text-align:center;line-height:.95em;margin-bottom:-0.7em;transform:scaleX(1.5);-moz-transform:scaleX(1.5);-o-transform:scaleX(1.5);-webkit-transform:scaleX(1.5)}.mq-math-mode .mq-hat-stem{display:block}.mq-math-mode .mq-large-operator{vertical-align:-0.2em;padding:.2em;text-align:center}.mq-math-mode .mq-large-operator .mq-from,.mq-math-mode .mq-large-operator big,.mq-math-mode .mq-large-operator .mq-to{display:block}.mq-math-mode .mq-large-operator .mq-from,.mq-math-mode .mq-large-operator .mq-to{font-size:80%}.mq-math-mode .mq-large-operator .mq-from{float:right;width:100%}.mq-math-mode,.mq-math-mode .mq-editable-field{cursor:text;font-family:Symbola,"Times New Roman",serif}.mq-math-mode .mq-overarc{border-top:1px solid #000;border-top-right-radius:50% .3em;border-top-left-radius:50% .3em;margin-top:1px;padding-top:.15em}.mq-math-mode .mq-overarrow{min-width:.5em;border-top:1px solid #000;margin-top:1px;padding-top:.2em;text-align:center}.mq-math-mode .mq-overarrow:before{display:block;position:relative;top:-0.34em;font-size:.5em;line-height:0em;content:"➤";text-align:right}.mq-math-mode .mq-overarrow.mq-arrow-left:before{transform:scaleX(-1);filter:FlipH;-ms-filter:"FlipH"}.mq-math-mode .mq-overarrow.mq-arrow-both{vertical-align:text-bottom}.mq-math-mode .mq-overarrow.mq-arrow-both.mq-empty{min-height:1.23em}.mq-math-mode .mq-overarrow.mq-arrow-both.mq-empty:after{top:-0.34em}.mq-math-mode .mq-overarrow.mq-arrow-both:before{transform:scaleX(-1);filter:FlipH;-ms-filter:"FlipH"}.mq-math-mode .mq-overarrow.mq-arrow-both:after{display:block;position:relative;top:-2.3em;font-size:.5em;line-height:0em;content:"➤";visibility:visible;text-align:right}.mq-math-mode .mq-matrix{vertical-align:middle;margin-left:.1em;margin-right:.1em}.mq-math-mode .mq-matrix table{width:auto;border-bottom:none;border-spacing:3px;border-collapse:separate}.mq-math-mode .mq-matrix table.mq-rows-1{vertical-align:middle;margin-bottom:1px}.mq-math-mode .mq-matrix td{border:none;width:auto;padding:.1em .3em;vertical-align:baseline}.mq-math-mode .mq-selection,.mq-editable-field .mq-selection,.mq-math-mode .mq-selection .mq-non-leaf,.mq-editable-field .mq-selection .mq-non-leaf,.mq-math-mode .mq-selection .mq-scaled,.mq-editable-field .mq-selection .mq-scaled{background:#b4d5fe !important;background:Highlight !important;color:HighlightText;border-color:HighlightText}.mq-math-mode .mq-selection .mq-matrixed,.mq-editable-field .mq-selection .mq-matrixed{background:#39f !important}.mq-math-mode .mq-selection .mq-matrixed-container,.mq-editable-field .mq-selection .mq-matrixed-container{filter:progid:DXImageTransform.Microsoft.Chroma(color="#3399FF") !important}.mq-math-mode .mq-selection.mq-blur,.mq-editable-field .mq-selection.mq-blur,.mq-math-mode .mq-selection.mq-blur .mq-non-leaf,.mq-editable-field .mq-selection.mq-blur .mq-non-leaf,.mq-math-mode .mq-selection.mq-blur .mq-scaled,.mq-editable-field .mq-selection.mq-blur .mq-scaled,.mq-math-mode .mq-selection.mq-blur .mq-matrixed,.mq-editable-field .mq-selection.mq-blur .mq-matrixed{background:#d4d4d4 !important;color:#000;border-color:#000}.mq-math-mode .mq-selection.mq-blur .mq-matrixed-container,.mq-editable-field .mq-selection.mq-blur .mq-matrixed-container{filter:progid:DXImageTransform.Microsoft.Chroma(color="#D4D4D4") !important}.mq-editable-field .mq-textarea,.mq-math-mode .mq-textarea{position:relative;-webkit-user-select:text;-moz-user-select:text;user-select:text}.mq-editable-field .mq-textarea *,.mq-math-mode .mq-textarea *,.mq-editable-field .mq-selectable,.mq-math-mode .mq-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text;position:absolute;clip:rect(1em 1em 1em 1em);transform:scale(0);resize:none;width:1px;height:1px;box-sizing:content-box}.mq-math-mode .mq-matrixed{background:#fff;display:-moz-inline-box;display:inline-block}.mq-math-mode .mq-matrixed-container{filter:progid:DXImageTransform.Microsoft.Chroma(color="white");margin-top:-0.1em}table.mq-non-leaf td[mathquill-block-id]{padding:4px 8px;text-align:center}.mq-math-mode sup.mq-nthroot{font-size:75%;vertical-align:.4em}.mq-root-block{padding:5px}.mq-root-block,.mq-math-mode .mq-root-block{padding:5px}.mq-math-mode .mq-supsub.mq-sup-only>.mq-sup{font-size:90%}.mq-nthroot.mq-non-leaf{padding:8px 0 !important}div[data-pygen] span.mq-editable-field{min-width:250px}div[data-pygen] .pygen-cloze span.mq-editable-field{min-width:initial}div[data-pygen] .pw-me-editorinput{margin-bottom:40px}div.pw-me-tabmenu .mq-supsub.mq-non-leaf.mq-sup-only{vertical-align:super !important}',i.id="mqwidgets_css",document.getElementsByTagName("head")[0].appendChild(i),function(){function t(){}function e(t){var e=t.length-1;return function(){var n=g.call(arguments,0,e),i=g.call(arguments,e);return t.apply(this,n.concat([i]))}}function n(t){return e((function(e,n){return"function"!=typeof e&&(e=b(e)),t.call(this,(function(t){return e.apply(t,[t].concat(n))}))}))}function i(t){var e=g.call(arguments,1);return function(){return t.apply(this,e)}}function r(t,e){if(!e)throw new Error("prayer failed: "+t)}function o(t){r("a direction was passed",t===y||t===w)}function a(t,e,n){r("a parent is always present",t),r("leftward is properly set up",e?e[w]===n&&e.parent===t:t.ends[y]===n),r("rightward is properly set up",n?n[y]===e&&n.parent===t:t.ends[w]===e)}function s(){window.console}function l(t){return s(),Pt(t)}function c(e){function n(t){var e,n;return t&&t.nodeType&&(n=(e=q(t).children(".mq-root-block").attr(Rt))&&_.byId[e].controller)?r[n.KIND_OF_MQ](n):null}function i(t,e){var n,i,o;for(n in e&&e.handlers&&(e.handlers={fns:e.handlers,APIClasses:r}),e)e.hasOwnProperty(n)&&(i=e[n],o=D[n],t[n]=o?o(i):i)}var r,o,a;if(!(M<=e&&e<=Q))throw"Only interface versions between "+M+" and "+Q+" supported. You specified: "+e;for(a in r={},n.L=y,n.R=w,n.saneKeyboardEvents=R,n.config=function(t){return i(A.p,t),this},n.registerEmbed=function(t,e){if(!/^[a-z][a-z0-9]*$/i.test(t))throw"Embed name must start with letter and be only letters and digits";P[t]=e},o=r.AbstractMathQuill=v(I,(function(t){t.init=function(t){this.__controller=t,this.__options=t.options,this.id=t.id,this.data=t.data},t.__mathquillify=function(t){var e,n=this.__controller,i=n.root,r=n.container;n.createTextarea(),e=r.addClass(t).contents().detach(),i.jQ=q('<span class="mq-root-block"/>').attr(Rt,i.id).appendTo(r),this.latex(e.text()),this.revert=function(){return r.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(e)}},t.config=function(t){return i(this.__options,t),this},t.el=function(){return this.__controller.container[0]},t.text=function(){return this.__controller.exportText()},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},t.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},t.reflow=function(){return this.__controller.root.postOrder("reflow"),this}})),n.prototype=o.prototype,r.EditableField=v(o,(function(e,n){e.__mathquillify=function(){return n.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},e.focus=function(){return this.__controller.textarea.focus(),this},e.blur=function(){return this.__controller.textarea.blur(),this},e.write=function(t){return this.__controller.writeLatex(t),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},e.empty=function(){var t=this.__controller.root,e=this.__controller.cursor;return t.eachChild("postOrder","dispose"),t.ends[y]=t.ends[w]=0,t.jQ.empty(),delete e.selection,e.insAtRightEnd(t),this},e.cmd=function(t){var e,n=this.__controller.notify(),i=n.cursor;return/^\\[a-z]+$/i.test(t)?(t=t.slice(1),(e=O[t]||mt[t])&&(t=e(t),i.selection&&t.replaces(i.replaceSelection()),t.createLeftOf(i.show()),this.__controller.scrollHoriz())):i.parent.write(i,t),n.blurred&&i.hide().parent.blur(),this},e.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[y];)t.selectLeft();return this},e.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},e.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},e.moveToLeftEnd=function(){return this.moveToDirEnd(y)},e.moveToRightEnd=function(){return this.moveToDirEnd(w)},e.keystroke=function(e){var n;for(e=e.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<e.length;n+=1)this.__controller.keystroke(e[n],{preventDefault:t});return this},e.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this},e.dropEmbedded=function(t,e,n){var i=t-q(window).scrollLeft(),r=e-q(window).scrollTop(),o=document.elementFromPoint(i,r);this.__controller.seek(q(o),t,e),ht().setOptions(n).createLeftOf(this.__controller.cursor)},e.clickAt=function(t,e,n){n=n||document.elementFromPoint(t,e);var i=this.__controller,r=i.root;return Qt.contains(r.jQ[0],n)||(n=r.jQ[0]),i.seek(q(n),t+pageXOffset,e+pageYOffset),i.blurred&&this.focus(),this},e.ignoreNextMousedown=function(t){return this.__controller.cursor.options.ignoreNextMousedown=t,this}})),n.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},n.EditableField.prototype=r.EditableField.prototype,C)!function(t,i){var o=r[t]=i(r);n[t]=function(i,r){var a,s=n(i);return s instanceof o||!i||!i.nodeType?s:((a=j(o.RootBlock(),q(i),A())).KIND_OF_MQ=t,o(a).__mathquillify(r,e))},n[t].prototype=o.prototype}(a,C[a]);return n}function u(t){var e,n="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" ");for(e=0;e<n.length;e+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(n[e]);t.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function p(t,e,n){return v(V,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}function f(t){var e=this.parent,n=t;do{if(n[w])return t.insLeftOf(e);n=n.parent.parent}while(n!==e);t.insRightOf(e)}function d(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));K(this.delimjQs,zt(1+.2*(t-1),1.2),1.2*t)}}function h(t,e){e=e||t;var n=ft[t],r=ft[e];S[t]=i(pt,y,t,n,e,r),S[n]=i(pt,w,t,n,e,r)}var m,g,b,v,y,w,q,x,_,k,O,S,T,E,j,C,A,D,I,P,M,Q,L,R,z,F,B,$,N,U,G,H,W,V,X,Y,J,K,Z,tt,et,nt,it,rt,ot,at,st,lt,ct,ut,pt,ft,dt,ht,mt,gt,bt,vt,yt,wt,qt,xt,_t,kt,Ot,St,Tt,Et,jt,Ct,At,Dt,It,Pt,Mt,Qt=window.jQuery,Lt="mathquill-command-id",Rt="mathquill-block-id",zt=Math.min,Ft=Math.max;if(!Qt)throw"MathQuill requires jQuery 1.5.2+ to be loaded first";for(nt in g=[].slice,b=e((function(t,n){return e((function(e,i){if(t in e)return e[t].apply(e,n.concat(i))}))})),v=function(t,e,n){function i(t){return"object"==typeof t}function r(t){return"function"==typeof t}function o(){}return function t(n,a){function s(){var t=new l;return r(t.init)&&t.init.apply(t,arguments),t}function l(){}var c,u,p;return void 0===a&&(a=n,n=Object),s.Bare=l,c=o.prototype=n.prototype,(u=l.prototype=s.prototype=s.p=new o).constructor=s,s.extend=function(e){return t(s,e)},(s.open=function(t){if(p={},r(t)?p=t.call(s,u,c,s,n):i(t)&&(p=t),i(p))for(var o in p)e.call(p,o)&&(u[o]=p[o]);return r(u.init)||(u.init=n),s})(a)}}(0,{}.hasOwnProperty),y=-1,w=1,q=v(Qt,(function(t){t.insDirOf=function(t,e){return t===y?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===y?this.prependTo(e):this.appendTo(e)}})),x=v((function(t){t.parent=0,t[y]=0,t[w]=0,t.init=function(t,e,n){this.parent=t,this[y]=e,this[w]=n},this.copy=function(t){return x(t.parent,t[y],t[w])}})),_=v((function(t){t[y]=0,t[w]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=e+=1,_.byId[this.id]=this,this.ends={},this.ends[y]=0,this.ends[w]=0},t.dispose=function(){delete _.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=q(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){function e(t){var n,i;for(t.getAttribute&&(n=t.getAttribute("mathquill-command-id"),i=t.getAttribute("mathquill-block-id"),n&&_.byId[n].jQadd(t),i&&_.byId[i].jQadd(t)),t=t.firstChild;t;t=t.nextSibling)e(t)}var n;for(t=q(t||this.html()),n=0;n<t.length;n+=1)e(t[n]);return t},t.createDir=function(t,e){o(t);var n=this;return n.jQize(),n.jQ.insDirOf(t,e.jQ),e[t]=n.adopt(e.parent,e[y],e[w]),n},t.createLeftOf=function(t){return this.createDir(y,t)},t.selectChildren=function(t,e){return E(t,e)},t.bubble=n((function(t){var e;for(e=this;e&&!1!==t(e);e=e.parent);return this})),t.postOrder=n((function(t){return function e(n){n.eachChild(e),t(n)}(this),this})),t.isEmpty=function(){return 0===this.ends[y]&&0===this.ends[w]},t.isStyleBlock=function(){return!1},t.children=function(){return k(this.ends[y],this.ends[w])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,n,i){return k(this,this).withDirAdopt(t,e,n,i),this},t.adopt=function(t,e,n){return k(this,this).adopt(t,e,n),this},t.disown=function(){return k(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}})),k=v((function(t){t.init=function(t,e,n){if(n===m&&(n=y),o(n),r("no half-empty fragments",!t==!e),this.ends={},t){r("withDir is passed to Fragment",t instanceof _),r("oppDir is passed to Fragment",e instanceof _),r("withDir and oppDir have the same parent",t.parent===e.parent),this.ends[n]=t,this.ends[-n]=e;var i=this.fold([],(function(t,e){return t.push.apply(t,e.jQ.get()),t}));this.jQ=this.jQ.add(i)}},t.jQ=q(),t.withDirAdopt=function(t,e,n,i){return t===y?this.adopt(e,n,i):this.adopt(e,i,n)},t.adopt=function(t,e,n){var i,r,o;return a(t,e,n),(i=this).disowned=!1,(r=i.ends[y])?(o=i.ends[w],e||(t.ends[y]=r),n?n[y]=o:t.ends[w]=o,i.ends[w][w]=n,i.each((function(n){n[y]=e,n.parent=t,e&&(e[w]=n),e=n})),i):this},t.disown=function(){var t,e,n=this,i=n.ends[y];return!i||n.disowned||(n.disowned=!0,t=n.ends[w],a(e=i.parent,i[y],i),a(e,t,t[w]),i[y]?i[y][w]=t[w]:e.ends[y]=t[w],t[w]?t[w][y]=i[y]:e.ends[w]=i[y]),n},t.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},t.each=n((function(t){var e=this,n=e.ends[y];if(!n)return e;for(;n!==e.ends[w][w]&&!1!==t(n);n=n[w]);return e})),t.fold=function(t,e){return this.each((function(n){t=e.call(this,t,n)})),t}})),O={},S={},T=v(x,(function(t){t.init=function(t,e){this.parent=t,this.options=e;var n=this.jQ=this._jQ=q('<span class="mq-cursor">&#8203;</span>');this.blink=function(){n.toggleClass("mq-blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[w]?this.selection&&this.selection.ends[y][y]===this[y]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[w].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=q(),this},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r!==e&&r.blur&&r.blur(this)},t.insDirOf=function(t,e){return o(t),this.jQ.insDirOf(t,e.jQ),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this},t.insLeftOf=function(t){return this.insDirOf(y,t)},t.insRightOf=function(t){return this.insDirOf(w,t)},t.insAtDirEnd=function(t,e){return o(t),this.jQ.insAtDirEnd(t,e.jQ),this.withDirInsertAt(t,e,0,e.ends[t]),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(y,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(w,t)},t.jumpUpDown=function(t,e){var n,i,r=this;r.upDownCache[t.id]=x.copy(r),(n=r.upDownCache[e.id])?n[w]?r.insLeftOf(n[w]):r.insAtRightEnd(n.parent):(i=r.offset().left,e.seek(i,r))},t.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[w],i=t[y];if(t.disown().eachChild((function(r){r.isEmpty()||(r.children().adopt(e,i,n).each((function(e){e.jQ.insertBefore(t.jQ.first())})),i=r.ends[w])})),!this[w])if(this[y])this[w]=this[y][w];else for(;!this[w];){if(this.parent=this.parent[w],!this.parent){this[w]=t[w],this.parent=e;break}this[w]=this.parent.ends[y]}this[w]?this.insLeftOf(this[w]):this.insAtRightEnd(e),t.jQ.remove(),t[y].siblingDeleted&&t[y].siblingDeleted(this.options,w),t[w].siblingDeleted&&t[w].siblingDeleted(this.options,y)},t.startSelection=function(){var t,e=this.anticursor=x.copy(this),n=e.ancestors={};for(t=e;t.parent;t=t.parent)n[t.parent.id]=t},t.endSelection=function(){delete this.anticursor},t.select=function(){var t,e,n,i,o,a,s,l=this.anticursor;if(this[y]===l[y]&&this.parent===l.parent)return!1;for(t=this;t.parent;t=t.parent)if(t.parent.id in l.ancestors){e=t.parent;break}if(r("cursor and anticursor in the same tree",e),n=l.ancestors[e.id],a=w,t[y]!==n)for(s=t;s;s=s[w])if(s[w]===n[w]){a=y,i=t,o=n;break}return a===w&&(i=n,o=t),i instanceof x&&(i=i[w]),o instanceof x&&(o=o[y]),this.hide().selection=e.selectChildren(i,o),this.insDirOf(a,this.selection.ends[a]),this.selectionChanged(),!0},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},t.deleteSelection=function(){this.selection&&(this[y]=this.selection.ends[y][y],this[w]=this.selection.ends[w][w],this.selection.remove(),this.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[y]=t.ends[y][y],this[w]=t.ends[w][w],delete this.selection),t}})),E=v(k,(function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",(function(e,n){return e+n[t]()}))}})),j=v((function(t){t.init=function(t,e,n){this.id=t.id,this.data={},this.root=t,this.container=e,this.options=n,t.controller=this,this.cursor=t.cursor=T(t,n)},t.handle=function(t,e){var n,i=this.options.handlers;i&&i.fns[t]&&(n=i.APIClasses[this.KIND_OF_MQ](this),e===y||e===w?i.fns[t](e,n):i.fns[t](n))};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}})),C={},A=v(),D={},I=v(),P={},l.prototype=I.p,l.VERSION="v0.10.1",l.interfaceVersion=function(t){if(1!==t)throw"Only interface version 1 supported. You specified: "+t;return(s=function(){window.console})(),l},l.getInterface=c,M=c.MIN=1,Q=c.MAX=2,l.noConflict=function(){return window.MathQuill=L,l},L=window.MathQuill,window.MathQuill=l,R=function(){function e(t){var e,i=t.which||t.keyCode,r=n[i],o=[];return t.ctrlKey&&o.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&o.push("Meta"),t.altKey&&o.push("Alt"),t.shiftKey&&o.push("Shift"),e=r||String.fromCharCode(i),o.length||r?(o.push(e),o.join("-")):e}var n={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){function r(t){m=t,clearTimeout(c),c=setTimeout(t)}function o(e){r((function(n){m=t,clearTimeout(c),e(n)}))}function a(){i.keystroke(e(p),p)}function s(){if(!function(){var t=d[0];return"selectionStart"in t&&t.selectionStart!==t.selectionEnd}()){var t=d.val();1===t.length?(d.val(""),i.typedText(t)):t&&d[0].select&&d[0].select()}}function l(){var t=d.val();d.val(""),t&&i.paste(t)}var c,u,p=null,f=null,d=Qt(n),h=Qt(i.container||d),m=t;return h.bind("keydown keypress input keyup focusout paste",(function(t){m(t)})),u=!1,h.bind({keydown:function(t){p=t,f=null,u&&o((function(t){t&&"focusout"===t.type||!d[0].select||d[0].select()})),a()},keypress:function(t){p&&f&&a(),f=t,r(s)},keyup:function(t){p&&!f&&r(s)},focusout:function(){p=f=null},cut:function(){o((function(){i.cut()}))},copy:function(){o((function(){i.copy()}))},paste:function(t){d.focus(),r(l)}}),{select:function(e){m(),m=t,clearTimeout(c),d.val(e),e&&d[0].select&&d[0].select(),u=!!e}}}}(),z=v((function(t,e,n){function i(t,e){throw"Parse Error: "+e+" at "+(t=t?"'"+t+"'":"EOF")}var o,a,s;t.init=function(t){this._=t},t.parse=function(t){return this.skip(s)._(""+t,(function(t,e){return e}),i)},t.or=function(t){r("or is passed a parser",t instanceof n);var e=this;return n((function(n,i,r){return e._(n,i,(function(e){return t._(n,i,r)}))}))},t.then=function(t){var e=this;return n((function(i,o,a){return e._(i,(function(e,i){var s=t instanceof n?t:t(i);return r("a parser is returned",s instanceof n),s._(e,o,a)}),a)}))},t.many=function(){var t=this;return n((function(e,n,i){function r(t,n){return e=t,a.push(n),!0}function o(){return!1}for(var a=[];t._(e,r,o););return n(e,a)}))},t.times=function(t,e){arguments.length<2&&(e=t);var i=this;return n((function(n,r,o){function a(t,e){return p.push(e),n=t,!0}function s(t,e){return c=e,n=t,!1}function l(t,e){return!1}var c,u,p=[],f=!0;for(u=0;u<t;u+=1)if(!(f=i._(n,a,s)))return o(n,c);for(;u<e&&f;u+=1)f=i._(n,a,l);return r(n,p)}))},t.result=function(t){return this.then(a(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then((function(t){return e.many().map((function(e){return t.concat(e)}))}))},t.map=function(t){return this.then((function(e){return a(t(e))}))},t.skip=function(t){return this.then((function(e){return t.result(e)}))},this.string=function(t){var e=t.length,i="expected '"+t+"'";return n((function(n,r,o){var a=n.slice(0,e);return a===t?r(n.slice(e),a):o(n,i)}))},o=this.regex=function(t){r("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return n((function(n,i,r){var o,a=t.exec(n);return a?(o=a[0],i(n.slice(o.length),o)):r(n,e)}))},a=n.succeed=function(t){return n((function(e,n){return n(e,t)}))},n.fail=function(t){return n((function(e,n,i){return i(e,t)}))},n.letter=o(/^[a-z]/i),n.letters=o(/^[a-z]*/i),n.digit=o(/^[0-9]/),n.digits=o(/^[0-9]*/),n.whitespace=o(/^\s+/),n.optWhitespace=o(/^\s*/),n.any=n((function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")})),n.all=n((function(t,e,n){return e("",t)})),s=n.eof=n((function(t,e,n){return t?n(t,"expected EOF"):e(t,t)}))})),F=function(){function t(t){var e,n=t[0]||H();for(e=1;e<t.length;e+=1)t[e].children().adopt(n,n.ends[w],0);return n}var e=z.string,n=z.regex,i=z.letter,r=z.any,o=z.optWhitespace,a=z.succeed,s=z.fail,l=i.map((function(t){return qt(t)})),c=n(/^[^${}\\_^]/).map((function(t){return U(t)})),u=n(/^[^\\a-eg-zA-Z]/).or(e("\\").then(n(/^[a-z]+/i).or(n(/^\s+/).result(" ")).or(r))).then((function(t){var e=O[t];return e?e(t).parser():s("unknown command: \\"+t)})),p=u.or(l).or(c),f=e("{").then((function(){return h})).skip(e("}")),d=o.then(f.or(p.map((function(t){var e=H();return t.adopt(e,0,0),e})))),h=d.many().map(t).skip(o),m=e("[").then(d.then((function(t){return"]"!==t.join("latex")?a(t):s()})).many().map(t).skip(o)).skip(e("]")),g=h;return g.block=d,g.optBlock=m,g}(),j.open((function(t,e){t.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.writeLatex=function(t){var e=this.notify("edit").cursor,n=z.all,i=z.eof,r=F.skip(i).or(n.result(!1)).parse(t);return r&&!r.isEmpty()&&(r.children().adopt(e.parent,e[y],e[w]),r.jQize().insertBefore(e.jQ),e[y]=r.ends[w],r.finalizeInsert(e.options,e),r.ends[w][w].siblingCreated&&r.ends[w][w].siblingCreated(e.options,y),r.ends[y][y].siblingCreated&&r.ends[y][y].siblingCreated(e.options,w),e.parent.bubble("reflow")),this},t.renderLatexMath=function(t){var e,n,i=this.root,r=this.cursor,o=z.all,a=z.eof,s=F.skip(a).or(o.result(!1)).parse(t);i.eachChild("postOrder","dispose"),i.ends[y]=i.ends[w]=0,s&&s.children().adopt(i,0,0),e=i.jQ,s?(n=s.join("html"),e.html(n),i.jQize(e.children()),i.finalizeInsert(r.options)):e.empty(),delete r.selection,r.insAtRightEnd(i)},t.renderLatexText=function(t){var e,n,i,r,o,a,s,l,c=this.root,u=this.cursor;if(c.jQ.children().slice(1).remove(),c.eachChild("postOrder","dispose"),c.ends[y]=c.ends[w]=0,delete u.selection,u.show().insAtRightEnd(c),e=z.regex,n=z.string,i=z.eof,r=z.all,o=n("$").then(F).skip(n("$").or(i)).map((function(t){var e,n=Y(u);return n.createBlocks(),e=n.ends[y],t.children().adopt(e,0,0),n})),a=n("\\$").result("$").or(e(/^[^$]/)).map(U),s=o.or(a).many().skip(i).or(r.result(!1)).parse(t)){for(l=0;l<s.length;l+=1)s[l].adopt(c,c.ends[w],0);c.jQize().appendTo(c.jQ),c.finalizeInsert(u.options)}}})),j.open((function(t){t.focusBlurEvents=function(){function t(){clearTimeout(n),o.selection&&o.selection.jQ.addClass("mq-blur"),e()}function e(){o.hide().parent.blur(),i.container.removeClass("mq-focused"),q(window).unbind("blur",t)}var n,i=this,r=i.root,o=i.cursor;i.textarea.focus((function(){i.blurred=!1,clearTimeout(n),i.container.addClass("mq-focused"),o.parent||o.insAtRightEnd(r),o.selection?(o.selection.jQ.removeClass("mq-blur"),i.selectionChanged()):o.show()})).blur((function(){i.blurred=!0,n=setTimeout((function(){r.postOrder("intentionalBlur"),o.clearSelection().endSelection(),e()})),q(window).bind("blur",t)})),i.blurred=!0,o.hide().parent.blur()}})),j.open((function(t,e){t.exportText=function(){return this.root.foldChildren("",(function(t,e){return t+e.text()}))}})),j.open((function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}})),_.open((function(t){t.keystroke=function(t,e,n){var i=n.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":n.ctrlDeleteDir(y);break;case"Shift-Backspace":case"Backspace":n.backspace();break;case"Esc":case"Tab":return void n.escapeDir(w,t,e);case"Shift-Tab":case"Shift-Esc":return void n.escapeDir(y,t,e);case"End":n.notify("move").cursor.insAtRightEnd(i.parent);break;case"Ctrl-End":n.notify("move").cursor.insAtRightEnd(n.root);break;case"Shift-End":for(;i[w];)n.selectRight();break;case"Ctrl-Shift-End":for(;i[w]||i.parent!==n.root;)n.selectRight();break;case"Home":n.notify("move").cursor.insAtLeftEnd(i.parent);break;case"Ctrl-Home":n.notify("move").cursor.insAtLeftEnd(n.root);break;case"Shift-Home":for(;i[y];)n.selectLeft();break;case"Ctrl-Shift-Home":for(;i[y]||i.parent!==n.root;)n.selectLeft();break;case"Left":n.moveLeft();break;case"Shift-Left":n.selectLeft();break;case"Ctrl-Left":break;case"Right":n.moveRight();break;case"Shift-Right":n.selectRight();break;case"Ctrl-Right":break;case"Up":n.moveUp();break;case"Down":n.moveDown();break;case"Shift-Up":if(i[y])for(;i[y];)n.selectLeft();else n.selectLeft();case"Shift-Down":if(i[w])for(;i[w];)n.selectRight();else n.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":n.ctrlDeleteDir(w);break;case"Shift-Del":case"Del":n.deleteForward();break;case"Meta-A":case"Ctrl-A":for(n.notify("move").cursor.insAtRightEnd(n.root);i[y];)n.selectLeft();break;default:return}e.preventDefault(),n.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){r("overridden or never called on this node")}})),j.open((function(t){function e(t,e){var n=t.notify("upDown").cursor,i=e+"Into",r=e+"OutOf";return n[w][i]?n.insAtLeftEnd(n[w][i]):n[y][i]?n.insAtRightEnd(n[y][i]):n.parent.bubble((function(t){var e=t[r];if(e&&("function"==typeof e&&(e=t[r](n)),e instanceof _&&n.jumpUpDown(t,e),!0!==e))return!1})),t}this.onNotify((function(t){"move"!==t&&"upDown"!==t||this.show().clearSelection()})),t.escapeDir=function(t,e,n){o(t);var i=this.cursor;if(i.parent!==this.root&&n.preventDefault(),i.parent!==this.root)return i.parent.moveOutOf(t,i),this.notify("move")},D.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){o(t);var e=this.cursor,n=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,n):e.parent.moveOutOf(t,e,n),this.notify("move")},t.moveLeft=function(){return this.moveDir(y)},t.moveRight=function(){return this.moveDir(w)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},this.onNotify((function(t){"upDown"!==t&&(this.upDownCache={})})),this.onNotify((function(t){"edit"===t&&this.show().deleteSelection()})),t.deleteDir=function(t){var e,n;return o(t),n=(e=this.cursor).selection,this.notify("edit"),n||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[y].siblingDeleted&&e[y].siblingDeleted(e.options,w),e[w].siblingDeleted&&e[w].siblingDeleted(e.options,y),e.parent.bubble("reflow"),this},t.ctrlDeleteDir=function(t){o(t);var e=this.cursor;return!e[t]||e.selection?this.deleteDir(t):(this.notify("edit"),t===y?k(e.parent.ends[y],e[y]).remove():k(e[w],e.parent.ends[w]).remove(),e.insAtDirEnd(t,e.parent),e[y].siblingDeleted&&e[y].siblingDeleted(e.options,w),e[w].siblingDeleted&&e[w].siblingDeleted(e.options,y),e.parent.bubble("reflow"),this)},t.backspace=function(){return this.deleteDir(y)},t.deleteForward=function(){return this.deleteDir(w)},this.onNotify((function(t){"select"!==t&&this.endSelection()})),t.selectDir=function(t){var e,n=this.notify("select").cursor,i=n.selection;o(t),n.anticursor||n.startSelection(),(e=n[t])?i&&i.ends[t]===e&&n.anticursor[-t]!==e?e.unselectInto(t,n):e.selectTowards(t,n):n.parent.selectOutOf(t,n),n.clearSelection(),n.select()||n.show()},t.selectLeft=function(){return this.selectDir(y)},t.selectRight=function(){return this.selectDir(w)}})),j.open((function(t){A.p.substituteTextarea=function(){return q("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0]},t.createTextarea=function(){var t,e=this.textareaSpan=q('<span class="mq-textarea"></span>'),n=this.options.substituteTextarea();if(!n.nodeType)throw"substituteTextarea() must return a DOM element, got "+n;n=this.textarea=q(n).appendTo(e),(t=this).cursor.selectionChanged=function(){t.selectionChanged()}},t.selectionChanged=function(){var t=this;Z(t.container[0]),t.textareaSelectionTimeout===m&&(t.textareaSelectionTimeout=setTimeout((function(){t.setTextareaSelection()})))},t.setTextareaSelection=function(){this.textareaSelectionTimeout=m;var t="";this.cursor.selection&&(t=this.cursor.selection.join("latex"),this.options.statelessClipboard&&(t="$"+t+"$")),this.selectFn(t)},t.staticMathTextareaEvents=function(){function t(){r.detach(),e.blurred=!0}var e=this,n=(e.root,e.cursor),i=e.textarea,r=e.textareaSpan;this.container.prepend(Qt('<span class="mq-selectable">').text("$"+e.exportLatex()+"$")),e.blurred=!0,i.bind("cut paste",!1).bind("copy",(function(){e.setTextareaSelection()})).focus((function(){e.blurred=!1})).blur((function(){n.selection&&n.selection.clear(),setTimeout(t)})),e.selectFn=function(t){i.val(t),t&&i.select()}},A.p.substituteKeyboardEvents=R,t.editablesTextareaEvents=function(){var t=this.textarea,e=this.textareaSpan,n=this.options.substituteKeyboardEvents(t,this);this.selectFn=function(t){n.select(t)},this.container.prepend(e),this.focusBlurEvents()},t.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},t.cut=function(){var t=this,e=t.cursor;e.selection&&setTimeout((function(){t.notify("edit"),e.parent.bubble("reflow")}))},t.copy=function(){this.setTextareaSelection()},t.paste=function(t){this.options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}})),j.open((function(e){A.p.ignoreNextMousedown=t,e.delegateMouseEvents=function(){var e=this.root.jQ;this.container.bind("mousedown.mathquill",(function(n){function i(t){o=q(t.target)}function r(t){l.anticursor||l.startSelection(),s.seek(o,t.pageX,t.pageY).cursor.select(),o=m}var o,a=q(n.target).closest(".mq-root-block"),s=_.byId[a.attr(Rt)||e.attr(Rt)].controller,l=s.cursor,c=l.blink,u=s.textareaSpan,p=s.textarea;n.preventDefault(),n.target.unselectable=!0,l.options.ignoreNextMousedown(n)||(l.options.ignoreNextMousedown=t,s.blurred&&(s.editable||a.prepend(u),p.focus()),l.blink=t,s.seek(q(n.target),n.pageX,n.pageY).cursor.startSelection(),a.mousemove(i),q(n.target.ownerDocument).mousemove(r).mouseup((function t(e){l.blink=c,l.selection||(s.editable?l.show():u.detach()),a.unbind("mousemove",i),q(e.target.ownerDocument).unbind("mousemove",r).unbind("mouseup",t)})))}))}})),j.open((function(t){t.seek=function(t,e,n){var i,o,a,s=this.notify("select").cursor;return t&&((i=t.attr(Rt)||t.attr(Lt))||(i=(o=t.parent()).attr(Rt)||o.attr(Lt))),r("nodeId is the id of some Node that exists",a=i?_.byId[i]:this.root),s.clearSelection().show(),a.seek(e,s),this.scrollHoriz(),this}})),j.open((function(t){t.scrollHoriz=function(){var t,e,n,i,r,o=this.cursor,a=o.selection,s=this.root.jQ[0].getBoundingClientRect();if(a)if(i=(n=a.jQ[0].getBoundingClientRect()).left-(s.left+20),r=n.right-(s.right-20),a.ends[y]===o[w])if(i<0)e=i;else{if(!(r>0))return;e=n.left-r<s.left+20?i:r}else if(r>0)e=r;else{if(!(i<0))return;e=n.right-i>s.right-20?r:i}else if((t=o.jQ[0].getBoundingClientRect().left)>s.right-20)e=t-(s.right-20);else{if(!(t<s.left+20))return;e=t-(s.left+20)}this.root.jQ.stop().animate({scrollLeft:"+="+e},100)}})),B=v(_,(function(t,e){t.finalizeInsert=function(t,e){var n=this;n.postOrder("finalizeTree",t),n.postOrder("contactWeld",e),n.postOrder("blur"),n.postOrder("reflow"),n[w].siblingCreated&&n[w].siblingCreated(t,y),n[y].siblingCreated&&n[y].siblingCreated(t,w),n.bubble("reflow")}})),$=v(B,(function(t,e){t.init=function(t,n,i){var r=this;e.init.call(r),r.ctrlSeq||(r.ctrlSeq=t),n&&(r.htmlTemplate=n),i&&(r.textTemplate=i)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,(function(t,e){return t&&e.isEmpty()}))},t.parser=function(){var t=F.block,e=this;return t.times(e.numBlocks()).map((function(t){e.blocks=t;for(var n=0;n<t.length;n+=1)t[n].adopt(e,e.ends[w],0);return e}))},t.createLeftOf=function(t){var n=this,i=n.replacedFragment;n.createBlocks(),e.createLeftOf.call(n,t),i&&(i.adopt(n.ends[y],0,0),i.jQ.appendTo(n.ends[y].jQ)),n.finalizeInsert(t.options),n.placeCursor(t)},t.createBlocks=function(){var t,e=this,n=e.numBlocks(),i=e.blocks=Array(n);for(t=0;t<n;t+=1)(i[t]=H()).adopt(e,e.ends[w],0)},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[y],(function(t,e){return t.isEmpty()?t:e})))},t.moveTowards=function(t,e,n){var i=n&&this[n+"Into"];e.insAtDirEnd(-t,i||this.ends[-t])},t.deleteTowards=function(t,e){this.isEmpty()?e[t]=this.remove()[t]:this.moveTowards(t,e,null)},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return E(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function n(t){var e={};return e[y]=t.jQ.offset().left,e[w]=e[y]+t.jQ.outerWidth(),e}var i,r=this,o=n(r);return t<o[y]?e.insLeftOf(r):t>o[w]?e.insRightOf(r):(i=o[y],void r.eachChild((function(a){var s=n(a);return t<s[y]?(t-i<s[y]-t?a[y]?e.insAtRightEnd(a[y]):e.insLeftOf(r):e.insAtLeftEnd(a),!1):t>s[w]?void(a[w]?i=s[w]:o[w]-t<t-s[w]?e.insRightOf(r):e.insAtRightEnd(a)):(a.seek(t,e),!1)})))},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t,e,n,i=this,o=i.blocks,a=" mathquill-command-id="+i.id,s=i.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);for(r("no unmatched angle brackets",s.join("")===this.htmlTemplate),t=0,e=s[0];e;e=s[t+=1])if("/>"===e.slice(-2))s[t]=e.slice(0,-2)+a+"/>";else if("<"===e.charAt(0)){r("not an unmatched top-level close tag","/"!==e.charAt(1)),s[t]=e.slice(0,-1)+a+">",n=1;do{r("no missing close tags",e=s[t+=1]),"</"===e.slice(0,2)?n-=1:"<"===e.charAt(0)&&"/>"!==e.slice(-2)&&(n+=1)}while(n>0)}return s.join("").replace(/>&(\d+)/g,(function(t,e){return" mathquill-block-id="+o[e].id+">"+o[e].join("html")}))},t.latex=function(){return this.foldChildren(this.ctrlSeq,(function(t,e){return t+"{"+(e.latex()||" ")+"}"}))},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],(function(n,i){e+=1;var r=i.text();return n&&"("===t.textTemplate[e]&&"("===r[0]&&")"===r.slice(-1)?n+r.slice(1,-1)+t.textTemplate[e]:n+i.text()+(t.textTemplate[e]||"")}))}})),N=v($,(function(e,n){e.init=function(t,e,i){i||(i=t&&t.length>1?t.slice(1):t),n.init.call(this,t,e,[i])},e.parser=function(){return z.succeed(this)},e.numBlocks=function(){return 0},e.replaces=function(t){t.remove()},e.createBlocks=t,e.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},e.deleteTowards=function(t,e){e[t]=this.remove()[t]},e.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},e.latex=function(){return this.ctrlSeq},e.text=function(){return this.textTemplate},e.placeCursor=t,e.isEmpty=function(){return!0}})),U=v(N,(function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>")}})),G=v(N,(function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="mq-binary-operator">'+n+"</span>",i)}})),H=v(B,(function(t,e){t.join=function(t){return this.foldChildren("",(function(e,n){return e+n[t]()}))},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[y]===this.ends[w]&&0!==this.ends[y]?this.ends[y].text():this.join("text")},t.keystroke=function(t,n,i){return!i.options.spaceBehavesLikeTab||"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):(n.preventDefault(),void i.escapeDir("Shift-Spacebar"===t?y:w,t,n))},t.moveOutOf=function(t,e,n){n&&this.parent[n+"Into"]||!this[t]?e.insDirOf(t,this.parent):e.insAtDirEnd(-t,this[t])},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var n=this.ends[w];if(!n||n.jQ.offset().left+n.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[y].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<n.jQ.offset().left;)n=n[y];return n.seek(t,e)},t.chToCmd=function(t,e){var n;return t.match(/^[a-eg-zA-Z]$/)?qt(t):/^\d$/.test(t)?yt(t):e&&e.typingSlashWritesDivisionSymbol&&"/"===t?O["÷"](t):e&&e.typingAsteriskWritesTimesSymbol&&"*"===t?O["×"](t):(n=S[t]||O[t])?n(t):U(t)},t.write=function(t,e){var n=this.chToCmd(e,t.options);t.selection&&n.replaces(t.replaceSelection()),n.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}})),C.StaticMath=function(t){return v(t.AbstractMathQuill,(function(e,n){this.RootBlock=H,e.__mathquillify=function(t,e){return this.config(t),n.__mathquillify.call(this,"mq-math-mode"),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents(),this},e.init=function(){n.init.apply(this,arguments),this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField)},e.latex=function(){var e=n.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField),e}}))},W=v(H,u),C.MathField=function(e){return v(e.EditableField,(function(e,n){this.RootBlock=W,e.__mathquillify=function(e,i){return this.config(e),i>1&&(this.__controller.root.reflow=t),n.__mathquillify.call(this,"mq-editable-field mq-math-mode"),delete this.__controller.root.reflow,this}}))},V=v(_,(function(t,e){function n(t){var e,n;if(t.jQ[0].normalize(),e=t.jQ[0].firstChild)return r("only node in TextBlock span is Text node",3===e.nodeType),(n=X(e.data)).jQadd(e),t.children().disown(),n.adopt(t,0,0)}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof k?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[y]&&this.ends[y].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){var n,i=this;if(e.createLeftOf.call(this,t),i[w].siblingCreated&&i[w].siblingCreated(t.options,y),i[y].siblingCreated&&i[y].siblingCreated(t.options,w),i.bubble("reflow"),t.insAtRightEnd(i),i.replacedText)for(n=0;n<i.replacedText.length;n+=1)i.write(t,i.replacedText.charAt(n))},t.parser=function(){var t=this,e=z.string,n=z.regex;return z.optWhitespace.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map((function(e){return 0===e.length?k():(X(e).adopt(t,0,0),t)}))},t.textContents=function(){return this.foldChildren("",(function(t,e){return t+e.text}))},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){var t=this.textContents();return 0===t.length?"":"\\text{"+t.replace(/\\/g,"\\backslash ").replace(/[{}]/g,"\\$&")+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=$.prototype.selectTowards,t.deleteTowards=$.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,n){var i,r;t.show().deleteSelection(),"$"!==n?t[y]?t[y].appendText(n):X(n).createLeftOf(t):this.isEmpty()?(t.insRightOf(this),U("\\$","$").createLeftOf(t)):t[w]?t[y]?(i=V(),(r=this.ends[y]).disown().jQ.detach(),r.adopt(i,0,0),t.insLeftOf(this),e.createLeftOf.call(i,t)):t.insLeftOf(this):t.insRightOf(this)},t.seek=function(t,e){var i,r,o,a,s,l,c,u;for(e.hide(),i=n(this),r=this.jQ.width()/this.text.length,(o=Math.round((t-this.jQ.offset().left)/r))<=0?e.insAtLeftEnd(this):o>=i.text.length?e.insAtRightEnd(this):e.insLeftOf(i.splitRight(o)),l=s=(a=t-e.show().offset().left)&&a<0?y:w;e[s]&&a*l>0;)e[s].moveTowards(s,e),l=a,a=t-e.offset().left;s*a<-s*l&&e[-s].moveTowards(-s,e),e.anticursor?e.anticursor.parent===this&&(c=e[y]&&e[y].text.length,this.anticursorPosition===c?e.anticursor=x.copy(e):(this.anticursorPosition<c?(u=e[y].splitRight(this.anticursorPosition),e[y]=u):u=e[w].splitRight(this.anticursorPosition-c),e.anticursor=x(this,u[y],u))):this.anticursorPosition=e[y]&&e[y].text.length},t.blur=function(t){H.prototype.blur.call(this),t&&(""===this.textContents()?(this.remove(),t[y]===this?t[y]=this[y]:t[w]===this&&(t[w]=this[w])):n(this))},t.focus=H.prototype.focus})),X=v(_,(function(t,e){function n(t,e){return e.charAt(t===y?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=q(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){o(e),e===w?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=X(this.text.slice(t)).adopt(this.parent,this,this[w]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){var i,r;return o(t),i=n(-t,this.text),(r=this[-t])?r.insTextAtDirEnd(i,t):X(i).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?t===w?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){var i,r,a,s;return o(t),i=e.anticursor,r=n(-t,this.text),i[t]===this?(a=X(r).createDir(t,e),i[t]=a,e.insDirOf(t,a)):((s=this[-t])?s.insTextAtDirEnd(r,t):(a=X(r).createDir(-t,e)).jQ.insDirOf(-t,e.selection.jQ),1===this.text.length&&i[-t]===this&&(i[-t]=this[-t])),this.deleteTowards(t,e)}})),O.text=O.textnormal=O.textrm=O.textup=O.textmd=V,O.em=O.italic=O.italics=O.emph=O.textit=O.textsl=p("\\textit","i",'class="mq-text-mode"'),O.strong=O.bold=O.textbf=p("\\textbf","b",'class="mq-text-mode"'),O.sf=O.textsf=p("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),O.tt=O.texttt=p("\\texttt","span",'class="mq-monospace mq-text-mode"'),O.textsc=p("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),O.uppercase=p("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),O.lowercase=p("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"'),Y=v($,(function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[y].cursor=this.cursor,this.ends[y].write=function(t,e){"$"!==e?H.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),U("\\$","$").createLeftOf(t.show())):t[w]?t[y]?H.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[y].latex()+"$"}})),J=v(W,(function(t,e){t.keystroke=function(t){if("Spacebar"!==t&&"Shift-Spacebar"!==t)return e.keystroke.apply(this,arguments)},t.write=function(t,e){var n;t.show().deleteSelection(),"$"===e?Y(t).createLeftOf(t):("<"===e?n="&lt;":">"===e&&(n="&gt;"),U(e,n).createLeftOf(t))}})),C.TextField=function(t){return v(t.EditableField,(function(t,e){this.RootBlock=J,t.__mathquillify=function(){return e.__mathquillify.call(this,"mq-editable-field mq-text-mode")},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}}))},S["\\"]=v($,(function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[y].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[y].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[y].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?U(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||t.parent.write(t,e))},this.ends[y].keystroke=function(t,n,i){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.parent.renderCommand(i.cursor),void n.preventDefault()):e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",(function(t){return q(t.target=n).trigger(t),!1})).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[y].latex()+" "},t.renderCommand=function(t){var e,n;this.jQ=this.jQ.last(),this.remove(),this[w]?t.insLeftOf(this[w]):t.insAtRightEnd(this.parent),(e=this.ends[y].latex())||(e=" "),(n=O[e]||mt[e])?(n=n(e),this._replacedFragment&&n.replaces(this._replacedFragment),n.createLeftOf(t)):((n=V()).replaces(e),n.createLeftOf(t),t.insRightOf(n),this._replacedFragment&&this._replacedFragment.remove())}})),Z=t,tt=document.createElement("div").style,{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(nt in tt){et=nt;break}for(St in et?K=function(t,e,n){t.css(et,"scale("+e+","+n+")")}:"filter"in tt?(Z=function(t){t.className=t.className},K=function(t,e,n){function i(){t.css("marginRight",(r.width()-1)*(e-1)/e+"px")}var r,o;e/=1+(n-1)/2,t.css("fontSize",n+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>'),r=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')"),i(),o=setInterval(i),q(window).load((function(){clearTimeout(o),i()}))}):K=function(t,e,n){t.css("fontSize",n+"em")},it=v($,(function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">")}})),O.mathrm=i(it,"\\mathrm","span",'class="mq-roman mq-font"'),O.mathit=i(it,"\\mathit","i",'class="mq-font"'),O.mathbf=i(it,"\\mathbf","b",'class="mq-font"'),O.mathsf=i(it,"\\mathsf","span",'class="mq-sans-serif mq-font"'),O.mathtt=i(it,"\\mathtt","span",'class="mq-monospace mq-font"'),O.underline=i(it,"\\underline","span",'class="mq-non-leaf mq-underline"'),O.overline=O.bar=i(it,"\\overline","span",'class="mq-non-leaf mq-overline"'),O.overrightarrow=i(it,"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),O.overleftarrow=i(it,"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"'),O.overleftrightarrow=i(it,"\\overleftrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-both"'),O.overarc=i(it,"\\overarc","span",'class="mq-non-leaf mq-overarc"'),O.dot=v($,(function(t,e){t.init=function(){e.init.call(this,"\\dot",'<span class="mq-non-leaf"><span class="mq-dot-recurring-inner"><span class="mq-dot-recurring">&#x2d9;</span><span class="mq-empty-box">&0</span></span></span>')}})),O.textcolor=v($,(function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,n=z.optWhitespace,i=z.string,r=z.regex;return n.then(i("{")).then(r(/^[#\w\s.,()%-]*/)).skip(i("}")).then((function(n){return t.setColor(n),e.parser.call(t)}))},t.isStyleBlock=function(){return!0}})),O.class=v($,(function(t,e){t.parser=function(){var t=this,n=z.string,i=z.regex;return z.optWhitespace.then(n("{")).then(i(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then((function(n){return t.cls=n||"",t.htmlTemplate='<span class="mq-class '+n+'">&0</span>',e.parser.call(t)}))},t.latex=function(){return"\\class{"+this.cls+"}{"+this.blocks[0].latex()+"}"},t.isStyleBlock=function(){return!0}})),rt=v($,(function(t,e){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){if(this.replacedFragment||t[y]||!t.options.supSubsRequireOperand)return e.createLeftOf.apply(this,arguments)},t.contactWeld=function(t){var e,n,i,r,o,a;for(e=y;e;e=e===y&&w)if(this[e]instanceof rt){for(n="sub";n;n="sub"===n&&"sup")i=this[n],r=this[e][n],i&&(r?i.isEmpty()?a=x(r,0,r.ends[y]):(i.jQ.children().insAtDirEnd(-e,r.jQ),o=i.children().disown(),a=x(r,o.ends[w],r.ends[y]),e===y?o.adopt(r,r.ends[w],0):o.adopt(r,0,r.ends[y])):this[e].addBlock(i.disown()),this.placeCursor=function(t,n){return function(i){i.insAtDirEnd(-e,t||n)}}(r,i));this.remove(),t&&t[y]===this&&(e===w&&a?a[y]?t.insRightOf(a[y]):t.insAtLeftEnd(a.parent):t.insRightOf(this[e]));break}},A.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[y].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var n=this.chToCmd(e,t.options);return n instanceof N?t.deleteSelection():t.clearSelection().insRightOf(this.parent),n.createLeftOf(t.show())}t[y]&&!t[w]&&!t.selection&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1&&t.insRightOf(this.parent),H.p.write.apply(this,arguments)}},t.moveTowards=function(t,n,i){n.options.autoSubscriptNumerals&&!this.sup?n.insDirOf(t,this):e.moveTowards.apply(this,arguments)},t.deleteTowards=function(t,n){if(n.options.autoSubscriptNumerals&&this.sub){var i=this.sub.ends[-t];i instanceof N?i.remove():i&&i.deleteTowards(t,n.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(y,n.insAtLeftEnd(this.sub)),this.sup&&n.insDirOf(-t,this))}else e.deleteTowards.apply(this,arguments)},t.latex=function(){function t(t,e){var n=e&&e.latex();return e?t+(1===n.length?n:"{"+(n||" ")+"}"):""}return t("_",this.sub)+t("^",this.sup)},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=q('<span class="mq-sup"/>').append(t.jQ.children()).attr(Rt,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=q('<span class="mq-sub"></span>').append(t.jQ.children()).attr(Rt,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var e=0;e<2;e+=1)!function(t,e,n,i){t[e].deleteOutOf=function(r,o){if(o.insDirOf(this[r]?-r:r,this.parent),!this.isEmpty()){var a=this.ends[r];this.children().disown().withDirAdopt(r,o.parent,o[r],o[-r]).jQ.insDirOf(-r,o.jQ),o[-r]=a}t.supsub=n,delete t[e],delete t[i+"Into"],t[n][i+"OutOf"]=f,delete t[n].deleteOutOf,"sub"===e&&q(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[e],"sup sub".split(" ")[e],"down up".split(" ")[e])}})),O.subscript=O._=v(rt,(function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[y],this.sub.upOutOf=f,e.finalizeTree.call(this)}})),O.superscript=O.supscript=O["^"]=v(rt,(function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>',t.textTemplate=["^"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[w],this.sup.downOutOf=f,e.finalizeTree.call(this)},t.reflow=function(){var t=this.jQ,e=t.prev().innerHeight();e*=.6,t.css("vertical-align",e+"px")}})),ot=v($,(function(t,e){t.init=function(t,e){var n='<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>';N.prototype.init.call(this,t,n)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(qt("n").createLeftOf(t),It().createLeftOf(t))},t.latex=function(){function t(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+t(this.ends[y].latex())+"^"+t(this.ends[w].latex())},t.parser=function(){var t,e=z.string,n=z.optWhitespace,i=z.succeed,r=F.block,o=this,a=o.blocks=[H(),H()];for(t=0;t<a.length;t+=1)a[t].adopt(o,o.ends[w],0);return n.then(e("_").or(e("^"))).then((function(t){var e=a["_"===t?0:1];return r.then((function(t){return t.children().adopt(e,e.ends[w],0),i(o)}))})).many().result(o)},t.finalizeTree=function(){this.downInto=this.ends[y],this.upInto=this.ends[w],this.ends[y].upOutOf=this.ends[w],this.ends[w].downOutOf=this.ends[y]}})),O["∑"]=O.sum=O.summation=i(ot,"\\sum ","&sum;"),O["∏"]=O.prod=O.product=i(ot,"\\prod ","&prod;"),O.coprod=O.coproduct=i(ot,"\\coprod ","&#8720;"),O["∫"]=O.int=O.integral=v(ot,(function(t,e){t.init=function(){N.prototype.init.call(this,"\\int ",'<span class="mq-int mq-non-leaf"><big>&int;</big><span class="mq-supsub mq-non-leaf"><span class="mq-sup"><span class="mq-sup-inner">&1</span></span><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>')},t.createLeftOf=$.p.createLeftOf})),at=O.frac=O.dfrac=O.cfrac=O.fraction=v($,(function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(",")/(",")"],t.finalizeTree=function(){this.upInto=this.ends[w].upOutOf=this.ends[y],this.downInto=this.ends[y].downOutOf=this.ends[w]}})),st=O.over=S["/"]=v(at,(function(e,n){e.createLeftOf=function(e){if(!this.replacedFragment){for(var i=e[y];i&&!(i instanceof G||i instanceof(O.text||t)||i instanceof ot||"\\ "===i.ctrlSeq||/^[,;:]$/.test(i.ctrlSeq));)i=i[y];i instanceof ot&&i[w]instanceof rt&&(i=i[w])[w]instanceof rt&&i[w].ctrlSeq!=i.ctrlSeq&&(i=i[w]),i!==e[y]&&(this.replaces(k(i[w]||e.parent.ends[y],e[y])),e[y]=i)}n.createLeftOf.call(this,e)}})),lt=O.sqrt=O["√"]=v($,(function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return F.optBlock.then((function(t){return F.block.map((function(e){var n=ct();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n}))})).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[w].jQ;K(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}})),O.hat=v($,(function(t,e){t.ctrlSeq="\\hat",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-hat-prefix">^</span><span class="mq-hat-stem">&0</span></span>',t.textTemplate=["hat(",")"]})),ct=O.nthroot=v(lt,(function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[y].latex()+"]{"+this.ends[w].latex()+"}"}})),ut=v($,(function(t,e){t.init=function(t,n,i){var r='<span class="mq-non-leaf"><span class="mq-diacritic-above">'+n+'</span><span class="mq-diacritic-stem">&0</span></span>';e.init.call(this,t,r,i)}})),O.vec=i(ut,"\\vec","&rarr;",["vec(",")"]),O.tilde=i(ut,"\\tilde","~",["tilde(",")"]),pt=v(v($,d),(function(e,n){e.init=function(t,e,i,r,o){n.init.call(this,"\\left"+r,m,[e,i]),this.side=t,this.sides={},this.sides[y]={ch:e,ctrlSeq:r},this.sides[w]={ch:i,ctrlSeq:o}},e.numBlocks=function(){return 1},e.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(this.side===w?" mq-ghost":"")+'">'+this.sides[y].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===y?" mq-ghost":"")+'">'+this.sides[w].ch+"</span></span>",n.html.call(this)},e.latex=function(){return"\\left"+this.sides[y].ctrlSeq+this.ends[y].latex()+"\\right"+this.sides[w].ctrlSeq},e.matchBrack=function(t,e,n){return n instanceof pt&&n.side&&n.side!==-e&&(!t.restrictMismatchedBrackets||ft[this.sides[this.side].ch]===n.sides[n.side].ch||{"(":"]","[":")"}[this.sides[y].ch]===n.sides[w].ch)&&n},e.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(this.side===y?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},e.createLeftOf=function(t){var e,i,r;this.replacedFragment||(e=t.options,i="|"===this.sides[y].ch?this.matchBrack(e,w,t[w])||this.matchBrack(e,y,t[y])||this.matchBrack(e,0,t.parent.parent):this.matchBrack(e,-this.side,t[-this.side])||this.matchBrack(e,-this.side,t.parent.parent)),i?(r=this.side=-i.side,this.closeOpposing(i),i===t.parent.parent&&t[r]&&k(t[r],t.parent.ends[r],-r).disown().withDirAdopt(-r,i.parent,i,i[r]).jQ.insDirOf(r,i.jQ),i.bubble("reflow")):(r=(i=this).side,i.replacedFragment?i.side=0:t[-r]&&(i.replaces(k(t[-r],t.parent.ends[-r],r)),t[-r]=0),n.createLeftOf.call(i,t)),r===y?t.insAtLeftEnd(i.ends[y]):t.insRightOf(i)},e.placeCursor=t,e.unwrap=function(){this.ends[y].children().disown().adopt(this.parent,this,this[w]).jQ.insertAfter(this.jQ),this.remove()},e.deleteSide=function(t,e,n){var i,r,o,a=this.parent,s=this[t],l=a.ends[t];if(t===this.side)return this.unwrap(),void(s?n.insDirOf(-t,s):n.insAtDirEnd(t,a));if(i=n.options,r=!this.side,this.side=-t,this.matchBrack(i,t,this.ends[y].ends[this.side]))this.closeOpposing(this.ends[y].ends[this.side]),o=this.ends[y].ends[t],this.unwrap(),o.siblingCreated&&o.siblingCreated(n.options,t),s?n.insDirOf(-t,s):n.insAtDirEnd(t,a);else{if(this.matchBrack(i,t,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else{if(e&&r)return this.unwrap(),void(s?n.insDirOf(-t,s):n.insAtDirEnd(t,a));this.sides[t]={ch:ft[this.sides[this.side].ch],ctrlSeq:ft[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(t===y?0:1).addClass("mq-ghost").html(this.sides[t].ch)}s?(o=this.ends[y].ends[t],k(s,l,-t).disown().withDirAdopt(-t,this.ends[y],o,0).jQ.insAtDirEnd(t,this.ends[y].jQ.removeClass("mq-empty")),o.siblingCreated&&o.siblingCreated(n.options,t),n.insDirOf(-t,s)):e?n.insDirOf(t,this):n.insAtDirEnd(t,this.ends[y])}},e.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},e.finalizeTree=function(){this.ends[y].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===y?1:0).removeClass("mq-ghost"),this.side=0}},e.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}})),ft={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},h("("),h("["),h("{","\\{"),O.langle=i(pt,y,"&lang;","&rang;","\\langle ","\\rangle "),O.rangle=i(pt,w,"&lang;","&rang;","\\langle ","\\rangle "),S["|"]=i(pt,y,"|","|","|","|"),O.lVert=i(pt,y,"&#8741;","&#8741;","\\lVert ","\\rVert "),O.rVert=i(pt,w,"&#8741;","&#8741;","\\lVert ","\\rVert "),O.left=v($,(function(t){t.parser=function(){var t=z.regex,e=z.string,n=(z.succeed,z.optWhitespace);return n.then(t(/^(?:[([|]|\\\{|\\langle\b|\\lVert\b)/)).then((function(i){var r="\\"===i.charAt(0)?i.slice(1):i;return"\\langle"==i&&(r="&lang;",i+=" "),"\\lVert"==i&&(r="&#8741;",i+=" "),F.then((function(o){return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\}|\\rangle\b|\\rVert\b)/)).map((function(t){var e,n="\\"===t.charAt(0)?t.slice(1):t;return"\\rangle"==t&&(n="&rang;",t+=" "),"\\rVert"==t&&(n="&#8741;",t+=" "),(e=pt(0,r,n,i,t)).blocks=[o],o.adopt(e,0,0),e}))}))}))}})),O.right=v($,(function(t){t.parser=function(){return z.fail("unmatched \\right")}})),dt=O.binom=O.binomial=v(v($,d),(function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]})),O.choose=v(dt,(function(t){t.createLeftOf=st.prototype.createLeftOf})),O.editable=O.MathQuillMathField=v($,(function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,n=z.string,i=z.regex,r=z.succeed;return n("[").then(i(/^[a-z][a-z0-9]*/i)).skip(n("]")).map((function(e){t.name=e})).or(r()).then(e.parser.call(t))},t.finalizeTree=function(t){var e=j(this.ends[y],this.jQ,t);e.KIND_OF_MQ="MathField",e.editable=!0,e.createTextarea(),e.editablesTextareaEvents(),e.cursor.insAtRightEnd(e.root),u(e.root)},t.registerInnerField=function(t,e){t.push(t[this.name]=e(this.ends[y].controller))},t.latex=function(){return this.ends[y].latex()},t.text=function(){return this.ends[y].text()}})),ht=O.embed=v(N,(function(t,e){t.setOptions=function(t){function e(){return""}return this.text=t.text||e,this.htmlTemplate=t.htmlString||"",this.latex=t.latex||e,this},t.parser=function(){var t=this,e=z.string,n=z.regex,i=z.succeed;return e("{").then(n(/^[a-z][a-z0-9]*/i)).skip(e("}")).then((function(r){return e("[").then(n(/^[-\w\s]*/)).skip(e("]")).or(i()).map((function(e){return t.setOptions(P[r](e))}))}))}})),mt={},O.begin=v($,(function(t,e){t.parser=function(){var t=z.string,e=z.regex;return t("{").then(e(/^[a-z]+/i)).skip(t("}")).then((function(e){return(mt[e]?mt[e]().parser():z.fail("unknown environment type: "+e)).skip(t("\\end{"+e+"}"))}))}})),gt=v($,(function(t,e){t.template=[["\\begin{","}"],["\\end{","}"]],t.wrappers=function(){return[t.template[0].join(this.environment),t.template[1].join(this.environment)]}})),bt=mt.matrix=v(gt,(function(t,e){var n="&",i="\\\\";t.parentheses={left:null,right:null},t.environment="matrix",t.reflow=function(){var t=this.jQ.children("table"),e=t.outerHeight()/+t.css("fontSize").slice(0,-2),n=this.jQ.children(".mq-paren");n.length&&K(n,zt(1+.2*(e-1),1.2),1.05*e)},t.latex=function(){var t,e="";return this.eachChild((function(r){void 0!==t&&(e+=t!==r.row?i:n),t=r.row,e+=r.latex()})),this.wrappers().join(e)},t.html=function(){function t(t){return t?'<span class="mq-scaled mq-paren">'+t+"</span>":""}var n,i=[],r="",o=0;return this.eachChild((function(t){n!==t.row&&(n=t.row,r+="<tr>$tds</tr>",i[n]=[]),i[n].push("<td>&"+o+++"</td>")})),this.htmlTemplate='<span class="mq-matrix mq-non-leaf">'+t(this.parentheses.left)+'<table class="mq-non-leaf">'+r.replace(/\$tds/g,(function(){return i.shift().join("")}))+"</table>"+t(this.parentheses.right)+"</span>",e.html.call(this)},t.createBlocks=function(){this.blocks=[vt(0,this),vt(0,this),vt(1,this),vt(1,this)]},t.parser=function(){var t=this,e=z.optWhitespace,r=z.string;return e.then(r(n).or(r(i)).or(F.block)).many().skip(e).then((function(e){function n(){t.blocks.push(vt(a,t,o)),o=[]}var r,o=[],a=0;for(t.blocks=[],r=0;r<e.length;r+=1)e[r]instanceof H?o.push(e[r]):(n(),e[r]===i&&(a+=1));return n(),t.autocorrect(),z.succeed(t)}))},t.finalizeTree=function(){var t=this.jQ.find("table");t.toggleClass("mq-rows-1",1===t.find("tr").length),this.relink()},t.getEntryPoint=function(t,e,n){return"up"===n?t===y?this.blocks[this.rowSize-1]:this.blocks[0]:t===y?this.blocks[this.blocks.length-1]:this.blocks[this.blocks.length-this.rowSize]},t.atExitPoint=function(t,e){var n=this.blocks.indexOf(e.parent);return t===y?n%this.rowSize==0:(n+1)%this.rowSize==0},t.moveTowards=function(t,e,n){var i=n&&this.getEntryPoint(t,e,n);e.insAtDirEnd(-t,i||this.ends[-t])},t.relink=function(){var t,e,n,i,r=this.blocks,o=[];for(this.rowSize=r.length,i=0;i<r.length;i+=1)t!==(n=r[i]).row&&(1===n.row&&(this.rowSize=e),o[t=n.row]=[],e=0),o[t][e]=n,n[w]=r[i+1],n[y]=r[i-1],o[t-1]&&o[t-1][e]&&(n.upOutOf=o[t-1][e],o[t-1][e].downOutOf=n),e+=1;this.ends[y]=r[0],this.ends[w]=r[r.length-1]},t.autocorrect=function(t){var e,n,i,r,o,a,s=[];for(t=[],e=this.blocks,a=0;a<e.length;a+=1)t[o=e[a].row]=t[o]||[],t[o].push(e[a]),s[o]=t[o].length;if((n=Math.max.apply(null,s))!==Math.min.apply(null,s)){for(a=0;a<t.length;a+=1)for(i=n-t[a].length;i;)r=n*a+t[a].length,e.splice(r,0,vt(a,this)),i-=1;this.relink()}},t.deleteCell=function(t){function e(t){var e,n=[];for(e=0;e<t.length;e+=1)t[e].isEmpty()&&n.push(t[e]);return n.length===t.length}function n(t){for(var e=0;e<t.length;e+=1)c.indexOf(t[e])>-1&&(t[e].remove(),c.splice(c.indexOf(t[e]),1))}var i,r,o=[],a=[],s=[],l=[],c=this.blocks;this.eachChild((function(e){i!==e.row&&(i=e.row,o[i]=[],r=0),a[r]=a[r]||[],a[r].push(e),o[i].push(e),e===t&&(s=o[i],l=a[r]),r+=1})),e(s)&&l.length>1&&(i=o.indexOf(s),this.eachChild((function(t){t.row>i&&(t.row-=1)})),n(s),this.jQ.find("tr").eq(i).remove()),e(l)&&s.length>1&&n(l),this.finalizeTree()},t.addRow=function(t){var e,n,i,r=[],o=[],a=[],s=q("<tr></tr>"),l=t.row,c=0;for(this.eachChild((function(e){e.row<=l&&r.push(e),e.row===l&&(e===t&&(n=c),c+=1),e.row>l&&(e.row+=1,a.push(e))})),i=0;i<c;i+=1)(e=vt(l+1)).parent=this,o.push(e),e.jQ=q('<td class="mq-empty">').attr(Rt,e.id).appendTo(s);return this.jQ.find("tr").eq(l).after(s),this.blocks=r.concat(o,a),o[n]},t.addColumn=function(t){var e,n,i,r=[],o=[];for(this.eachChild((function(n){r[n.row]=r[n.row]||[],r[n.row].push(n),n===t&&(e=r[n.row].length)})),i=0;i<r.length;i+=1)(n=vt(i)).parent=this,o.push(n),r[i].splice(e,0,n),n.jQ=q('<td class="mq-empty">').attr(Rt,n.id);return this.jQ.find("tr").each((function(t){q(this).find("td").eq(e-1).after(r[t][e].jQ)})),this.blocks=[].concat.apply([],r),o[t.row]},t.insert=function(t,e){var n=this[t](e);this.cursor=this.cursor||this.parent.cursor,this.finalizeTree(),this.bubble("reflow").cursor.insAtRightEnd(n)},t.backspace=function(t,e,n,i){var r=t[e];if(t.isEmpty()){for(this.deleteCell(t);r&&r[e]&&-1===this.blocks.indexOf(r);)r=r[e];r&&n.insAtDirEnd(-e,r),1===this.blocks.length&&this.blocks[0].isEmpty()&&(i(),this.finalizeTree()),this.bubble("edited")}}})),mt.pmatrix=v(bt,(function(t,e){t.environment="pmatrix",t.parentheses={left:"(",right:")"}})),mt.bmatrix=v(bt,(function(t,e){t.environment="bmatrix",t.parentheses={left:"[",right:"]"}})),mt.Bmatrix=v(bt,(function(t,e){t.environment="Bmatrix",t.parentheses={left:"{",right:"}"}})),mt.vmatrix=v(bt,(function(t,e){t.environment="vmatrix",t.parentheses={left:"|",right:"|"}})),mt.Vmatrix=v(bt,(function(t,e){t.environment="Vmatrix",t.parentheses={left:"&#8214;",right:"&#8214;"}})),vt=v(H,(function(t,e){t.init=function(t,n,i){if(e.init.call(this),this.row=t,n&&this.adopt(n,n.ends[w],0),i)for(var r=0;r<i.length;r++)i[r].children().adopt(this,this.ends[w],0)},t.keystroke=function(t,n,i){switch(t){case"Shift-Spacebar":return n.preventDefault(),this.parent.insert("addColumn",this);case"Shift-Enter":return this.parent.insert("addRow",this)}return e.keystroke.apply(this,arguments)},t.deleteOutOf=function(t,n){var i=this,r=arguments;this.parent.backspace(this,t,n,(function(){return e.deleteOutOf.apply(i,r)}))},t.moveOutOf=function(t,e,n){n&&this.parent.atExitPoint(t,e)||!this[t]?e.insDirOf(t,this.parent):e.insAtDirEnd(-t,this[t])}})),O.notin=O.cong=O.equiv=O.oplus=O.otimes=v(G,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),O["≠"]=O.ne=O.neq=i(G,"\\ne ","&ne;"),O["∗"]=O.ast=O.star=O.loast=O.lowast=i(G,"\\ast ","&lowast;"),O.therefor=O.therefore=i(G,"\\therefore ","&there4;"),O.cuz=O.because=i(G,"\\because ","&#8757;"),O.prop=O.propto=i(G,"\\propto ","&prop;"),O["≈"]=O.asymp=O.approx=i(G,"\\approx ","&asymp;"),O.isin=O.in=i(G,"\\in ","&isin;"),O.ni=O.contains=i(G,"\\ni ","&ni;"),O.notni=O.niton=O.notcontains=O.doesnotcontain=i(G,"\\not\\ni ","&#8716;"),O.sub=O.subset=i(G,"\\subset ","&sub;"),O.sup=O.supset=O.superset=i(G,"\\supset ","&sup;"),O.nsub=O.notsub=O.nsubset=O.notsubset=i(G,"\\not\\subset ","&#8836;"),O.nsup=O.notsup=O.nsupset=O.notsupset=O.nsuperset=O.notsuperset=i(G,"\\not\\supset ","&#8837;"),O.sube=O.subeq=O.subsete=O.subseteq=i(G,"\\subseteq ","&sube;"),O.supe=O.supeq=O.supsete=O.supseteq=O.supersete=O.superseteq=i(G,"\\supseteq ","&supe;"),O.nsube=O.nsubeq=O.notsube=O.notsubeq=O.nsubsete=O.nsubseteq=O.notsubsete=O.notsubseteq=i(G,"\\not\\subseteq ","&#8840;"),O.nsupe=O.nsupeq=O.notsupe=O.notsupeq=O.nsupsete=O.nsupseteq=O.notsupsete=O.notsupseteq=O.nsupersete=O.nsuperseteq=O.notsupersete=O.notsuperseteq=i(G,"\\not\\supseteq ","&#8841;"),O.N=O.naturals=O.Naturals=i(U,"\\mathbb{N}","&#8469;"),O.P=O.primes=O.Primes=O.projective=O.Projective=O.probability=O.Probability=i(U,"\\mathbb{P}","&#8473;"),O.Z=O.integers=O.Integers=i(U,"\\mathbb{Z}","&#8484;"),O.Q=O.rationals=O.Rationals=i(U,"\\mathbb{Q}","&#8474;"),O.R=O.reals=O.Reals=i(U,"\\mathbb{R}","&#8477;"),O.C=O.complex=O.Complex=O.complexes=O.Complexes=O.complexplane=O.Complexplane=O.ComplexPlane=i(U,"\\mathbb{C}","&#8450;"),O.H=O.Hamiltonian=O.quaternions=O.Quaternions=i(U,"\\mathbb{H}","&#8461;"),O.quad=O.emsp=i(U,"\\quad ","    "),O.qquad=i(U,"\\qquad ","        "),O.diamond=i(U,"\\diamond ","&#9671;"),O.bigtriangleup=i(U,"\\bigtriangleup ","&#9651;"),O.ominus=i(U,"\\ominus ","&#8854;"),O.uplus=i(U,"\\uplus ","&#8846;"),O.bigtriangledown=i(U,"\\bigtriangledown ","&#9661;"),O.sqcap=i(U,"\\sqcap ","&#8851;"),O.triangleleft=i(U,"\\triangleleft ","&#8882;"),O.sqcup=i(U,"\\sqcup ","&#8852;"),O.triangleright=i(U,"\\triangleright ","&#8883;"),O.odot=O.circledot=i(U,"\\odot ","&#8857;"),O.bigcirc=i(U,"\\bigcirc ","&#9711;"),O.dagger=i(U,"\\dagger ","&#0134;"),O.ddagger=i(U,"\\ddagger ","&#135;"),O.wr=i(U,"\\wr ","&#8768;"),O.amalg=i(U,"\\amalg ","&#8720;"),O.models=i(U,"\\models ","&#8872;"),O.prec=i(U,"\\prec ","&#8826;"),O.succ=i(U,"\\succ ","&#8827;"),O.preceq=i(U,"\\preceq ","&#8828;"),O.succeq=i(U,"\\succeq ","&#8829;"),O.simeq=i(U,"\\simeq ","&#8771;"),O.mid=i(U,"\\mid ","&#8739;"),O.ll=i(U,"\\ll ","&#8810;"),O.gg=i(U,"\\gg ","&#8811;"),O.parallel=i(U,"\\parallel ","&#8741;"),O.nparallel=i(U,"\\nparallel ","&#8742;"),O.bowtie=i(U,"\\bowtie ","&#8904;"),O.sqsubset=i(U,"\\sqsubset ","&#8847;"),O.sqsupset=i(U,"\\sqsupset ","&#8848;"),O.smile=i(U,"\\smile ","&#8995;"),O.sqsubseteq=i(U,"\\sqsubseteq ","&#8849;"),O.sqsupseteq=i(U,"\\sqsupseteq ","&#8850;"),O.doteq=i(U,"\\doteq ","&#8784;"),O.frown=i(U,"\\frown ","&#8994;"),O.vdash=i(U,"\\vdash ","&#8870;"),O.dashv=i(U,"\\dashv ","&#8867;"),O.nless=i(U,"\\nless ","&#8814;"),O.ngtr=i(U,"\\ngtr ","&#8815;"),O.longleftarrow=i(U,"\\longleftarrow ","&#8592;"),O.longrightarrow=i(U,"\\longrightarrow ","&#8594;"),O.Longleftarrow=i(U,"\\Longleftarrow ","&#8656;"),O.Longrightarrow=i(U,"\\Longrightarrow ","&#8658;"),O.longleftrightarrow=i(U,"\\longleftrightarrow ","&#8596;"),O.updownarrow=i(U,"\\updownarrow ","&#8597;"),O.Longleftrightarrow=i(U,"\\Longleftrightarrow ","&#8660;"),O.Updownarrow=i(U,"\\Updownarrow ","&#8661;"),O.mapsto=i(U,"\\mapsto ","&#8614;"),O.nearrow=i(U,"\\nearrow ","&#8599;"),O.hookleftarrow=i(U,"\\hookleftarrow ","&#8617;"),O.hookrightarrow=i(U,"\\hookrightarrow ","&#8618;"),O.searrow=i(U,"\\searrow ","&#8600;"),O.leftharpoonup=i(U,"\\leftharpoonup ","&#8636;"),O.rightharpoonup=i(U,"\\rightharpoonup ","&#8640;"),O.swarrow=i(U,"\\swarrow ","&#8601;"),O.leftharpoondown=i(U,"\\leftharpoondown ","&#8637;"),O.rightharpoondown=i(U,"\\rightharpoondown ","&#8641;"),O.nwarrow=i(U,"\\nwarrow ","&#8598;"),O.ldots=i(U,"\\ldots ","&#8230;"),O.cdots=i(U,"\\cdots ","&#8943;"),O.vdots=i(U,"\\vdots ","&#8942;"),O.ddots=i(U,"\\ddots ","&#8945;"),O.surd=i(U,"\\surd ","&#8730;"),O.triangle=i(U,"\\triangle ","&#9651;"),O.ell=i(U,"\\ell ","&#8467;"),O.top=i(U,"\\top ","&#8868;"),O.flat=i(U,"\\flat ","&#9837;"),O.natural=i(U,"\\natural ","&#9838;"),O.sharp=i(U,"\\sharp ","&#9839;"),O.wp=i(U,"\\wp ","&#8472;"),O.bot=i(U,"\\bot ","&#8869;"),O.clubsuit=i(U,"\\clubsuit ","&#9827;"),O.diamondsuit=i(U,"\\diamondsuit ","&#9826;"),O.heartsuit=i(U,"\\heartsuit ","&#9825;"),O.spadesuit=i(U,"\\spadesuit ","&#9824;"),O.parallelogram=i(U,"\\parallelogram ","&#9649;"),O.square=i(U,"\\square ","&#11036;"),O.oint=i(U,"\\oint ","&#8750;"),O.bigcap=i(U,"\\bigcap ","&#8745;"),O.bigcup=i(U,"\\bigcup ","&#8746;"),O.bigsqcup=i(U,"\\bigsqcup ","&#8852;"),O.bigvee=i(U,"\\bigvee ","&#8744;"),O.bigwedge=i(U,"\\bigwedge ","&#8743;"),O.bigodot=i(U,"\\bigodot ","&#8857;"),O.bigotimes=i(U,"\\bigotimes ","&#8855;"),O.bigoplus=i(U,"\\bigoplus ","&#8853;"),O.biguplus=i(U,"\\biguplus ","&#8846;"),O.lfloor=i(U,"\\lfloor ","&#8970;"),O.rfloor=i(U,"\\rfloor ","&#8971;"),O.lceil=i(U,"\\lceil ","&#8968;"),O.rceil=i(U,"\\rceil ","&#8969;"),O.opencurlybrace=O.lbrace=i(U,"\\lbrace ","{"),O.closecurlybrace=O.rbrace=i(U,"\\rbrace ","}"),O.lbrack=i(U,"["),O.rbrack=i(U,"]"),O.slash=i(U,"/"),O.vert=i(U,"|"),O.perp=O.perpendicular=i(U,"\\perp ","&perp;"),O.nabla=O.del=i(U,"\\nabla ","&nabla;"),O.hbar=i(U,"\\hbar ","&#8463;"),O.AA=O.Angstrom=O.angstrom=i(U,"\\text\\AA ","&#8491;"),O.ring=O.circ=O.circle=i(U,"\\circ ","&#8728;"),O.bull=O.bullet=i(U,"\\bullet ","&bull;"),O.setminus=O.smallsetminus=i(U,"\\setminus ","&#8726;"),O.not=O["¬"]=O.neg=i(U,"\\neg ","&not;"),O["…"]=O.dots=O.ellip=O.hellip=O.ellipsis=O.hellipsis=i(U,"\\dots ","&hellip;"),O.converges=O.darr=O.dnarr=O.dnarrow=O.downarrow=i(U,"\\downarrow ","&darr;"),O.dArr=O.dnArr=O.dnArrow=O.Downarrow=i(U,"\\Downarrow ","&dArr;"),O.diverges=O.uarr=O.uparrow=i(U,"\\uparrow ","&uarr;"),O.uArr=O.Uparrow=i(U,"\\Uparrow ","&uArr;"),O.to=i(G,"\\to ","&rarr;"),O.rarr=O.rightarrow=i(U,"\\rightarrow ","&rarr;"),O.implies=i(G,"\\Rightarrow ","&rArr;"),O.rArr=O.Rightarrow=i(U,"\\Rightarrow ","&rArr;"),O.gets=i(G,"\\gets ","&larr;"),O.larr=O.leftarrow=i(U,"\\leftarrow ","&larr;"),O.impliedby=i(G,"\\Leftarrow ","&lArr;"),O.lArr=O.Leftarrow=i(U,"\\Leftarrow ","&lArr;"),O.harr=O.lrarr=O.leftrightarrow=i(U,"\\leftrightarrow ","&harr;"),O.iff=i(G,"\\Leftrightarrow ","&hArr;"),O.hArr=O.lrArr=O.Leftrightarrow=i(U,"\\Leftrightarrow ","&hArr;"),O.Re=O.Real=O.real=i(U,"\\Re ","&real;"),O.Im=O.imag=O.image=O.imagin=O.imaginary=O.Imaginary=i(U,"\\Im ","&image;"),O.part=O.partial=i(U,"\\partial ","&part;"),O.infty=O.infin=O.infinity=i(U,"\\infty ","&infin;"),O.alef=O.alefsym=O.aleph=O.alephsym=i(U,"\\aleph ","&alefsym;"),O.xist=O.xists=O.exist=O.exists=i(U,"\\exists ","&exist;"),O.nexists=O.nexist=i(U,"\\nexists ","&#8708;"),O.and=O.land=O.wedge=i(G,"\\wedge ","&and;"),O.or=O.lor=O.vee=i(G,"\\vee ","&or;"),O.o=O.O=O.empty=O.emptyset=O.oslash=O.Oslash=O.nothing=O.varnothing=i(G,"\\varnothing ","&empty;"),O.cup=O.union=i(G,"\\cup ","&cup;"),O.cap=O.intersect=O.intersection=i(G,"\\cap ","&cap;"),O.deg=O.degree=i(U,"\\degree ","&deg;"),O.ang=O.angle=i(U,"\\angle ","&ang;"),O.measuredangle=i(U,"\\measuredangle ","&#8737;"),yt=v(U,(function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[y]instanceof wt&&!1!==t[y].isItalic||t[y]instanceof rt&&t[y][y]instanceof wt&&!1!==t[y][y].isItalic)?(O._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}})),wt=v(N,(function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return this.isPartOfOperator?"\\"==t[0]?t=t.slice(1,t.length):" "==t[t.length-1]&&(t=t.slice(0,-1)):(!this[y]||this[y]instanceof wt||this[y]instanceof G||"\\ "===this[y].ctrlSeq||(t="*"+t),!this[w]||this[w]instanceof G||this[w]instanceof rt||(t+="*")),t}})),A.p.autoCommands={_maxLength:0},D.autoCommands=function(t){var e,n,i,r,o;if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){if((o=e[r]).length<2)throw'autocommand "'+o+'" not minimum length of 2';if(O[o]===Ot)throw'"'+o+'" is a built-in operator name';n[o]=1,i=Ft(i,o.length)}return n._maxLength=i,n},qt=v(wt,(function(t,e){function n(t){return!t||t instanceof G||t instanceof ot}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){var n,i,r,o,a;if(e.createLeftOf.apply(this,arguments),(i=(n=t.options.autoCommands)._maxLength)>0){for(r="",o=this,a=0;o instanceof qt&&o.ctrlSeq===o.letter&&a<i;)r=o.letter+r,o=o[y],a+=1;for(;r.length;){if(n.hasOwnProperty(r)){for(a=1,o=this;a<r.length;a+=1,o=o[y]);return k(o,this).remove(),t[y]=o[y],O[r](r).createLeftOf(t)}r=r.slice(1)}}},t.italicize=function(t){return this.isItalic=t,this.isPartOfOperator=!t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){e!==y&&this[w]instanceof qt||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e,i,r,o,a,s,l,c,u,p,f,d,h=t.autoOperatorNames;if(0!==h._maxLength){for(e=this.letter,i=this[y];i instanceof qt;i=i[y])e=i.letter+e;for(r=this[w];r instanceof qt;r=r[w])e+=r.letter;k(i[w]||this.parent.ends[y],r[y]||this.parent.ends[w]).each((function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last mq-followed-by-supsub"),t.ctrlSeq=t.letter}));t:for(o=0,a=i[w]||this.parent.ends[y];o<e.length;o+=1,a=a[w])for(s=zt(h._maxLength,e.length-o);s>0;s-=1)if(l=e.slice(o,o+s),h.hasOwnProperty(l)){for(c=0,u=a;c<s;c+=1,u=u[w])u.italicize(!1),p=u;f=xt.hasOwnProperty(l),a.ctrlSeq=(f?"\\":"\\operatorname{")+a.ctrlSeq,p.ctrlSeq+=f?" ":"}",kt.hasOwnProperty(l)&&p[y][y][y].jQ.addClass("mq-last"),n(a[y])||a.jQ.addClass("mq-first"),n(p[w])||(p[w]instanceof rt?((d=p[w]).siblingCreated=d.siblingDeleted=function(){d.jQ.toggleClass("mq-after-operator-name",!(d[w]instanceof pt))})():p.jQ.toggleClass("mq-last",!(p[w]instanceof pt))),o+=s-1,a=p;continue t}}}})),xt={},_t=A.p.autoOperatorNames={_maxLength:9},kt={limsup:1,liminf:1,projlim:1,injlim:1},function(){var t,e,n,i,r="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" ");for(t=0;t<r.length;t+=1)xt[r[t]]=_t[r[t]]=1;for(e="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),t=0;t<e.length;t+=1)xt[e[t]]=1;for(n="sin cos tan sec cosec csc cotan cot ctg".split(" "),t=0;t<n.length;t+=1)_t[n[t]]=_t["arc"+n[t]]=_t[n[t]+"h"]=_t["ar"+n[t]+"h"]=_t["arc"+n[t]+"h"]=1;for(i="gcf hcf lcm proj span".split(" "),t=0;t<i.length;t+=1)_t[i[t]]=1}(),D.autoOperatorNames=function(t){var e,n,i,r,o;if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){if((o=e[r]).length<2)throw'"'+o+'" not minimum length of 2';n[o]=1,i=Ft(i,o.length)}return n._maxLength=i,n},Ot=v(N,(function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){var e,n=this.ctrlSeq;for(e=0;e<n.length;e+=1)qt(n.charAt(e)).createLeftOf(t)},t.parser=function(){var t,e=this.ctrlSeq,n=H();for(t=0;t<e.length;t+=1)qt(e.charAt(t)).adopt(n,n.ends[w],0);return z.succeed(n.children())}})),_t)_t.hasOwnProperty(St)&&(O[St]=Ot);for(Mt in O.operatorname=v($,(function(e){e.createLeftOf=t,e.numBlocks=function(){return 1},e.parser=function(){return F.block.map((function(t){return t.children()}))}})),O.f=v(qt,(function(t,e){t.init=function(){N.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}})),O[" "]=O.space=i(U,"\\ ","&nbsp;"),O["'"]=O.prime=i(U,"'","&prime;"),O["″"]=O.dprime=i(U,"″","&Prime;"),O.backslash=i(U,"\\backslash ","\\"),S["\\"]||(S["\\"]=O.backslash),O.$=i(U,"\\$","$"),Tt=v(N,(function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="mq-nonSymbola">'+(n||t)+"</span>")}})),O["@"]=Tt,O["&"]=i(Tt,"\\&","&amp;"),O["%"]=i(Tt,"\\%","%"),O.alpha=O.beta=O.gamma=O.delta=O.zeta=O.eta=O.theta=O.iota=O.kappa=O.mu=O.nu=O.xi=O.rho=O.sigma=O.tau=O.chi=O.psi=O.omega=v(wt,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),O.phi=i(wt,"\\phi ","&#981;"),O.phiv=O.varphi=i(wt,"\\varphi ","&phi;"),O.epsilon=i(wt,"\\epsilon ","&#1013;"),O.epsiv=O.varepsilon=i(wt,"\\varepsilon ","&epsilon;"),O.piv=O.varpi=i(wt,"\\varpi ","&piv;"),O.sigmaf=O.sigmav=O.varsigma=i(wt,"\\varsigma ","&sigmaf;"),O.thetav=O.vartheta=O.thetasym=i(wt,"\\vartheta ","&thetasym;"),O.upsilon=O.upsi=i(wt,"\\upsilon ","&upsilon;"),O.gammad=O.Gammad=O.digamma=i(wt,"\\digamma ","&#989;"),O.kappav=O.varkappa=i(wt,"\\varkappa ","&#1008;"),O.rhov=O.varrho=i(wt,"\\varrho ","&#1009;"),O.pi=O["π"]=i(Tt,"\\pi ","&pi;"),O.lambda=i(Tt,"\\lambda ","&lambda;"),O.Upsilon=O.Upsi=O.upsih=O.Upsih=i(N,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),O.Gamma=O.Delta=O.Theta=O.Lambda=O.Xi=O.Pi=O.Sigma=O.Phi=O.Psi=O.Omega=O.forall=v(U,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),Et=v($,(function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=F.parse(this.latex);e.children().adopt(t.parent,t[y],t[w]),t[y]=e.ends[w],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[w][w].siblingCreated&&e.ends[w][w].siblingCreated(t.options,y),e.ends[y][y].siblingCreated&&e.ends[y][y].siblingCreated(t.options,w),t.parent.bubble("reflow")},t.parser=function(){var t=F.parse(this.latex).children();return z.succeed(t)}})),O["¹"]=i(Et,"^1"),O["²"]=i(Et,"^2"),O["³"]=i(Et,"^3"),O["¼"]=i(Et,"\\frac14"),O["½"]=i(Et,"\\frac12"),O["¾"]=i(Et,"\\frac34"),jt=v(G,(function(t){t.init=U.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){if(e!==w)return this.jQ[0].className=function t(e){return e[y]?e[y]instanceof G||/^[,;:\(\[]$/.test(e[y].ctrlSeq)?"":"mq-binary-operator":e.parent&&e.parent.parent&&e.parent.parent.isStyleBlock()?t(e.parent.parent):""}(this),this}})),O["+"]=i(jt,"+","+"),O["–"]=O["-"]=i(jt,"-","&minus;"),O["±"]=O.pm=O.plusmn=O.plusminus=i(jt,"\\pm ","&plusmn;"),O.mp=O.mnplus=O.minusplus=i(jt,"\\mp ","&#8723;"),S["*"]=O.sdot=O.cdot=i(G,"\\cdot ","&middot;","*"),Ct=v(G,(function(t,e){t.init=function(t,n){this.data=t,this.strict=n;var i=n?"Strict":"";e.init.call(this,t["ctrlSeq"+i],t["html"+i],t["text"+i])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,n){if(t===y&&!this.strict)return this.swap(!0),void this.bubble("reflow");e.deleteTowards.apply(this,arguments)}})),At={ctrlSeq:"\\le ",html:"&le;",text:"≤",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},Dt={ctrlSeq:"\\ge ",html:"&ge;",text:"≥",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"},O["<"]=O.lt=i(Ct,At,!0),O[">"]=O.gt=i(Ct,Dt,!0),O["≤"]=O.le=O.leq=i(Ct,At,!1),O["≥"]=O.ge=O.geq=i(Ct,Dt,!1),It=v(G,(function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){if(t[y]instanceof Ct&&t[y].strict)return t[y].swap(!1),void t[y].bubble("reflow");e.createLeftOf.apply(this,arguments)}})),O["="]=It,O["×"]=O.times=i(G,"\\times ","&times;","[x]"),O["÷"]=O.div=O.divide=O.divides=i(G,"\\div ","&divide;","[/]"),S["~"]=O.sim=i(G,"\\sim ","~","~"),Pt=c(1))!function(t,e){"function"==typeof e?(l[t]=function(){return s(),e.apply(this,arguments)},l[t].prototype=e.prototype):l[t]=e}(Mt,Pt[Mt])}(),function(){"use strict";var t=r;Object.defineProperty(t,"__esModule",{value:!0}),t.reflow=t.init=void 0;var e=n(452),i=n(66),o=n(830),a=n(216),s=n(657);function l(t){(0,a.findQuillGroups)(t),(0,s.findPyGenerators)()}(0,e.applyPolyfills)(),t.reflow=l;var c=!1;t.init=function(t){if(c)l(t.widgets);else if(t.engine&&!t.engines&&(t.engines=[t.engine||""]),t.engines){Array.isArray(t.engines)||(t.engines=[t.engines]),i.cfg.setUserConfig(t);var e=[];t.engines.indexOf("nerdamer")>=0&&e.push((0,o.insertScript)(i.cfg.NERDAMER_URL)),e.length?Promise.all(e).then((function(){l(null==t?void 0:t.widgets),c=!0}),(function(){console.error("Unable to load the required dependencies")})):(l(null==t?void 0:t.widgets),c=!0)}else console.error("The engines option in the init method is required.")}}(),self.MQWidgets=r}();
//# sourceMappingURL=mqwidgets2.js.map