!function(){"use strict";var e={800:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createSubmitButtonForGroup=t.bindSubmitActionButton=void 0;var r=n(247),o=n(66),i=n(830),a=(new Date).getTime();function s(e,t,n){var s=o.shared[e],l=Object.keys(s).map((function(e){return parseInt(e)}));t.off(),t.on("click",(function(t){t.preventDefault();var c=(new Date).getTime();if(a&&c-a<1e3)console.error("Too frequently checks are blocked!");else{console.log("gid",e,"qids",l);for(var u=0,p=l.length;u<p;u++){var f=l[u],d=s[f];if(d.getStatus()==o.cfg.STATUS.MODIFIED){var h=d.latex()||[];if(0===h.length||(0,r.has_empty_answers)(h))d.checkMsg(-1,"Falten respostes"),console.error("Editor contains empty answers");else if(1!=d.getStatus()&&h.length){if(console.log(d),d.getDefinition().right_answer&&d.getWrong_attemps()>o.cfg.MAX_ATTEMPTS&&(console.log("TODO:: Must show right answer and disable quill"),!d.isPigen())){d.showAnswer();continue}if(d.getQType()==o.cfg.QTYPES.M||d.getQType()==o.cfg.QTYPES.Ms){var y=d.isComodiUsed()?5:10;d.getDefinition().ans==h[0]?d.checkMsg(1,"Molt bé!"):(y=0,d.increment_wrong(),d.checkMsg(0,"Incorrecte")),n&&n(y);continue}a=c;var v,b={latex:h,qid:f};if((v=null!=d.getDefinition().anse?atob(d.getDefinition().anse||""):d.getDefinition().ans||"")&&1==h.length&&(0,i.isNumeric)(h[0])&&(0,i.isNumeric)(v)){var m=parseFloat(h[0]);parseFloat(v),console.log("Numeric answer can be checked locally"),y=d.isComodiUsed()?5:10;var g=parseFloat(v)-m,w=0;d.getDefinition().rules&&d.getDefinition().rules.precision&&(w=d.getDefinition().rules.precision),Math.abs(g)<=w?d.checkMsg(1,"Molt bé!"):(y=0,d.increment_wrong(),d.checkMsg(0,"Incorrecte")),n&&n(y);continue}(0,i.copyPropsFromTo)(d.getDefinition(),b),o.cfg.pageInfo&&(b.pageInfo=o.cfg.pageInfo,d.getHash()||d.setHash((0,i.MD5)(b.formulation+"_"+(b.pageInfo.bookId||0)+"_"+(b.pageInfo.chapterId||0))),b.hash=d.getHash()),$.ajax({type:"POST",url:o.cfg.CAS_URL,data:JSON.stringify(b),dataType:"json",success:function(e){console.log("success",e);var t=s[e.qid];0==e.correct&&t.increment_wrong(),t.checkMsg(e.correct,e.msg);var r=e.correct?t.isComodiUsed()?5:10:0;n&&n(r)},error:function(e){console.log("error",e)}})}}else console.log("Unmodified, nothing to check")}}}))}t.bindSubmitActionButton=s,t.createSubmitButtonForGroup=function(e){var t=$('<button class="btn btn-sm btn-primary pw-me-submitgroup"><i class="fas fa-check"></i> Comprova</button>');return s(e,t),t}},247:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.has_empty_answers=t.extractMatrices=void 0;var n=/\\begin{pmatrix}(.*?)\\end{pmatrix}/g;function r(e){for(var t=[],r=null,o=function(){var e=[];r[1].split("\\\\").forEach((function(t){var n=t.split("&");e.push(n)})),t.push(e)};null!==(r=n.exec(e));)o();return t}t.extractMatrices=r;var o=function(e){for(var t=e.length,n=0;n<t;n++)for(var r=e[n],o=r.length,i=0;i<o;i++)if(!r[i])return!0;return!1};t.has_empty_answers=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];if(""==i||i&&!i.trim())return!0;for(var a=r(i),s=0,l=a.length;s<l;s++)if(o(a[s]))return!0}return!1}},968:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.LevelIndicator=void 0;var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.numLevels=t,this.container=$('<div style="display:inline-block;font-size:90%;" data-toggle="tooltip"></div>'),this.levelIcons=[];for(var n=0;n<t;n++){var r=$('<i class="fas fa-pepper-hot" style="color:lightgray;"></i>');this.container.append(r),this.levelIcons.push(r)}}var t,r;return t=e,(r=[{key:"$div",get:function(){return this.container}},{key:"setLevel",value:function(e){e<0?e=0:e>this.numLevels&&(e=this.numLevels);for(var t=0;t<this.numLevels;t++)t<e?this.levelIcons[t].css("color","darkred"):this.levelIcons[t].css("color","lightgray");this.container.attr("data-original-title","Nivell "+e),this.container.removeAttr("title")}},{key:"setVisible",value:function(e){this.container.css("display",e?"":"none")}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.LevelIndicator=r},281:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.PwDialog=void 0;var r=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id="pwdlg_"+Math.random().toString(32).substring(2),this.window=$('<div id="'+this.id+'" class="pw-me-dlg" style="width:'+n+"px;height:"+r+'px;display:none;"></div>');var o=$('<div class="pw-me-dlg-header"></div>');this.topBar=o;var i=$('<span class="pw-me-dlg-headertitle">'+t+"</span>");this.closeBtn=$('<button class="btn btn-sm pw-me-btn-dlgclose" title="Tancar"><i class="fas fa-times"></i></button>');var a=this;this.closeBtn.on("click",(function(e){e.preventDefault(),a.window.css("display","none")})),o.append(i),o.append(this.closeBtn),this.window.append(o),$("body").append(this.window);var s,l,c,u,p=!1,f=0,d=0;this.dragStart=function(e){"touchstart"===e.type?(c=e.touches[0].clientX-f,u=e.touches[0].clientY-d):(c=e.clientX-f,u=e.clientY-d),e.target===o[0]&&(p=!0)},this.dragEnd=function(e){c=s,u=l,p=!1},this.setTranslate=function(e,t,n){n.style.transform="translate3d("+e+"px, "+t+"px, 0)"},this.drag=function(e){p&&(e.preventDefault(),"touchmove"===e.type?(s=e.touches[0].clientX-c,l=e.touches[0].clientY-u):(s=e.clientX-c,l=e.clientY-u),f=s,d=l,a.setTranslate(s,l,a.window[0]))},o[0].addEventListener("touchstart",this.dragStart,!1),o[0].addEventListener("touchend",this.dragEnd,!1),o[0].addEventListener("touchmove",this.drag,!1),o[0].addEventListener("mousedown",this.dragStart,!1),o[0].addEventListener("mouseup",this.dragEnd,!1),o[0].addEventListener("mousemove",this.drag,!1)}var t,r;return t=e,(r=[{key:"append",value:function(e){this.window.append(e)}},{key:"show",value:function(){this.window.css("display","initial")}},{key:"close",value:function(){this.window.css("display","none")}},{key:"remove",value:function(){this.closeBtn.off(),this.window.remove(),this.topBar[0].removeEventListener("touchstart",this.dragStart),this.topBar[0].removeEventListener("touchend",this.dragEnd),this.topBar[0].removeEventListener("touchmove",this.drag),this.topBar[0].removeEventListener("mousedown",this.dragStart),this.topBar[0].removeEventListener("mouseup",this.dragEnd),this.topBar[0].removeEventListener("mousemove",this.drag)}},{key:"dispose",value:function(){this.remove()}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.PwDialog=r},541:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorDialog=void 0;var c=n(66),u=n(830),p=n(786),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(h,e);var t,n,r,f,d=(r=h,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(f){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function h(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h);var t=s(e=d.call(this,'<i style="color:darkred;" class="fas fa-square-root-alt"></i> Editor matemàtic',500,320)),n="gid_"+Math.random().toString(32).substring(2),r=c.cfg.QTYPES.P;e.editorPanel=new p.EditorPanel(e.window,n,{},r,!1);var o=$('<div class="pw-me-dlg-controls"></div>'),i=$('<button class="btn btn-sm btn-primary">Accepta</button>'),a=$('<button class="btn btn-sm btn-outline-primary">Cancel·la</button>');return o.append(i),o.append(a),e.append(o),i.on("click",(function(e){e.preventDefault(),t.acceptFn&&t.acceptFn(t),t.close()})),a.on("click",(function(e){e.preventDefault(),t.cancelFn&&t.cancelFn(t),t.close()})),e}return t=h,(n=[{key:"latex",value:function(e){return null!=e?(this.editorPanel.latex(e),[""]):this.editorPanel.latex().map((function(e){return(0,u.sanitizeLaTeX)(e)}))}},{key:"show",value:function(){this.window.css("display",""),this.editorPanel.focus()}},{key:"dispose",value:function(){this.editorPanel.dispose(),this.window.find("button").off(),this.dispose()}},{key:"reflow",value:function(){this.editorPanel.reflow()}},{key:"setDefinition",value:function(e){this.editorPanel.setDefinition(e)}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(n(281).PwDialog);t.EditorDialog=f},44:function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorBase=void 0;var o=n(66),i=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.gid=n,this.status=o.cfg.STATUS.UNMODIFIED,this.wrong_attemps=0,this.isAnswerShown=!1,this.def=r,this.qtype=i,this.pigen=!1,this.comodi=!1,this.hash=""}var t,n;return t=e,(n=[{key:"get_gid",value:function(){return this.gid}},{key:"setDefinition",value:function(e){this.def=e,this.ansType=e.ansType}},{key:"getDefinition",value:function(){return this.def}},{key:"increment_wrong",value:function(){this.wrong_attemps+=1}},{key:"getWrong_attemps",value:function(){return this.wrong_attemps}},{key:"getStatus",value:function(){return this.status}},{key:"setStatus",value:function(e){this.status=e}},{key:"getQType",value:function(){return this.qtype}},{key:"setQType",value:function(e){this.qtype=e}},{key:"isPigen",value:function(){return this.pigen}},{key:"setPigen",value:function(e){this.pigen=e}},{key:"isComodiUsed",value:function(){return this.comodi}},{key:"setComodiUsed",value:function(e){this.comodi=e}},{key:"getHash",value:function(){return this.hash}},{key:"setHash",value:function(e){this.hash=e}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.EditorBase=i},437:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorCloze=void 0;var c=n(66),u=n(830),p=n(281),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(h,e);var t,n,r,f,d=(r=h,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(f){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function h(e,t,n,r,o){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h);var a=s(i=d.call(this,e,t,n,r));i.dlg_btn_el=null,i.quill_el_container=$('<div class="pw-me-editorinput"></div>');var l=$("<span>"+o+"</span>");return i.check_el=$('<div class="pw-me-check"></div>'),i.parent.append(i.quill_el_container),i.quill_el_container.append(l),i.mathInput=(0,c.StaticMath)(l[0]),i.mathInput.innerFields.forEach((function(e){e.__controller.textarea.on("keyup",(function(e){e.preventDefault(),a.status!=c.cfg.STATUS.MODIFIED&&(a.check_el.html(""),a.status=c.cfg.STATUS.MODIFIED,a.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))}))})),i.quill_el_container.append(i.check_el),i}return t=h,(n=[{key:"clear",value:function(){this.mathInput.innerFields.forEach((function(e){return e.latex("")})),this.check_el.html(""),this.status=c.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){this.mathInput.focus()}},{key:"latex",value:function(e){if(null==e){var t=[];console.log(this.mathInput.innerFields);for(var n=this.mathInput.innerFields,r=0,o=n.length;r<o;r++)t.push(n[r].latex());return t}return this.mathInput.latex(e),this.status=c.cfg.STATUS.UNMODIFIED,[]}},{key:"checkMsg",value:function(e,t){this.status=e;var n="";1==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-check"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-times"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"get_qid",value:function(){return this.mathInput.id}},{key:"dispose",value:function(){this.mathInput.revert(),this.quill_el_container.find("button").off()}},{key:"reflow",value:function(){this.mathInput.reflow(),this.status=c.cfg.STATUS.UNMODIFIED}},{key:"showAnswer",value:function(){if(this.def)if(this.def.right_answer){var e=this;if(!c.sharedDlg.showAnswerDlg){var t=new p.PwDialog("Resposta correcta",400,250);c.sharedDlg.showAnswerDlg=t;var n=$('<div class="pw-answer-holder"></div>');t.append(n);var r=$('<button class="btn btn-sm btn-primary" style="margin-left: 15px;">Tancar</button>');t.append(r),r.on("click",(function(e){e.preventDefault(),t.close()}))}e.isAnswerShown||(e.isAnswerShown=!0,e.status=c.cfg.STATUS.UNMODIFIED,e.dlg_btn_el&&e.dlg_btn_el.prop("disabled",!0));var o=c.sharedDlg.showAnswerDlg,i=o.window.find(".pw-answer-holder");e.def&&(i.html(atob(e.def.right_answer)+"<p><br></p>"),(0,u.reflowLatex)(),o.show())}else console.error("Cannot show answer because, ",this.def.right_answer);else console.error("Cannot show answer because, def is null")}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(n(44).EditorBase);t.EditorCloze=f},980:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorInput=void 0;var c=n(66),u=n(830),p=n(281),f=n(541),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(y,e);var t,n,r,d,h=(r=y,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(d){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function y(e,t,n,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);var i=s(o=h.call(this,e,t,n,r));o.quill_el_container=$('<div class="pw-me-editorinput"></div>'),o.quill_blocker=$("<div></div>");var a=$("<span></span>");o.quill_blocker.append(a),o.check_el=$('<div class="pw-me-check"></div>'),o.quill_el_container.append(o.quill_blocker);var l=r===c.cfg.QTYPES.S;return o.parent.append(o.quill_el_container),o.mathInput=(0,c.MathField)(a[0],{handlers:{edit:function(){console.log("Edit ev on mathquill ",i.mathInput.latex()),i.status!=c.cfg.STATUS.MODIFIED&&(i.check_el.html(""),i.status=c.cfg.STATUS.MODIFIED,i.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))}}}),l&&(o.dlg_btn_el=$('<button class="btn btn-sm pw-me-btn-openeditor" title="Obrir l\'editor"><i class="fas fa-square-root-alt"></i></button>'),o.quill_el_container.append(o.dlg_btn_el),o.dlg_btn_el.on("click",(function(e){e.preventDefault();var t=c.sharedDlg.editordlg;t||(t=new f.EditorDialog,c.sharedDlg.editordlg=t),t.acceptFn=function(e){i.mathInput.latex(e.latex())},t.setDefinition(i.def),t.show(),t.latex(i.mathInput.latex())}))),o.quill_el_container.append(o.check_el),o}return t=y,(n=[{key:"get_qid",value:function(){return this.mathInput.id}},{key:"clear",value:function(){this.mathInput.latex(""),this.check_el.html(""),this.status=c.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){this.mathInput.focus()}},{key:"latex",value:function(e){return null==e?[(0,u.sanitizeLaTeX)(this.mathInput.latex())]:(console.log("Setting latex ",e),this.mathInput.latex(e),this.status=c.cfg.STATUS.UNMODIFIED,[])}},{key:"checkMsg",value:function(e,t){this.status=e;var n=null;1==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="'+c.cfg.RIGHT_ICON+'"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="'+c.cfg.WRONG_ICON+'"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"dispose",value:function(){this.mathInput.revert(),this.quill_el_container.find("button").off()}},{key:"showAnswer",value:function(){if(this.def.right_answer){var e=this;if(!c.sharedDlg.showAnswerDlg){var t=new p.PwDialog("Resposta correcta",400,250);c.sharedDlg.showAnswerDlg=t;var n=$('<div class="pw-answer-holder"></div>');t.append(n);var r=$('<button class="btn btn-sm btn-primary" style="margin-left: 15px;">Tancar</button>');t.append(r),r.on("click",(function(e){e.preventDefault(),t.close()}))}e.isAnswerShown||(e.isAnswerShown=!0,e.status=c.cfg.STATUS.UNMODIFIED,e.quill_blocker.addClass("pw-me-blocker"),e.dlg_btn_el&&e.dlg_btn_el.prop("disabled",!0)),n=(t=c.sharedDlg.showAnswerDlg).window.find(".pw-answer-holder"),e.def&&(n.html(atob(e.def.right_answer)+"<p><br></p>"),(0,u.reflowLatex)(),t.show())}else console.error("Cannot show answer because, ",this.def.right_answer)}},{key:"increment_wrong",value:function(){if(console.log("increment wrong",this.wrong_attemps==c.cfg.MAX_ATTEMPTS+1,!this.pigen),this.wrong_attemps+=1,this.wrong_attemps==c.cfg.MAX_ATTEMPTS+1&&!this.pigen){console.log("creating a rescue",this.def);var e=$('<button class="btn btn-sm" title="Mostra la solució"><i class="far fa-question-circle"></i></button>'),t=this;e.on("click",(function(e){t.showAnswer()})),this.def.right_answer?this.quill_el_container.append(e):$.ajax({type:"POST",url:c.cfg.GETANSWER_URL,data:JSON.stringify(this.def),dataType:"json",success:function(n){n.right_answer&&t.def?(t.def.right_answer=n.right_answer,t.quill_el_container.append(e)):n.msg&&console.error(n.msg)}})}}},{key:"reflow",value:function(){this.mathInput.reflow(),this.status=c.cfg.STATUS.UNMODIFIED}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(n(44).EditorBase);t.EditorInput=d},203:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorMChoice=void 0;var c=n(66),u=n(830),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(d,e);var t,n,r,p,f=(r=d,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(p){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function d(e,t,n,r,o){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i=f.call(this,e,t,n,r),"string"==typeof o&&(o=o.split(";"));var a=s(i);i.selectedIndex="",i.gid=t,i.qid=Math.floor(1e4*Math.random())+1e4,i.options=o||[],i.status=c.cfg.STATUS.UNMODIFIED,i.parent=e,i.wrong_attemps=0,i.quill_el_container=$('<div class="pw-me-mchoice"></div>'),i.check_el=$('<div class="pw-me-check"></div>');var l=$('<div class="btn-group"></div>');i.btn_action=$('<button type="button" style="background:white;" class="btn btn-outline-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tria una opció</button>');var p=$('<div class="dropdown-menu"></div>');return l.append(i.btn_action),o.forEach((function(e,t){var n=$('<a class="dropdown-item" href="#">'+e+"</a>");n.on("click",(function(e){e.preventDefault(),a.selectedIndex=t+"",a.btn_action.html(n.html()),a.status!=c.cfg.STATUS.MODIFIED&&(a.check_el.html(""),a.status=c.cfg.STATUS.MODIFIED,a.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))})),p.append(n)})),l.append(p),i.quill_el_container.append(l),i.quill_el_container.append(i.check_el),i.parent.append(i.quill_el_container),(0,u.reflowLatex)(),i}return t=d,(n=[{key:"showAnswer",value:function(){}},{key:"clear",value:function(){this.selectedIndex="",this.btn_action.html(""),this.check_el.html(""),this.status=c.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){this.btn_action.focus()}},{key:"latex",value:function(e){return[this.selectedIndex]}},{key:"checkMsg",value:function(e,t){this.status=e;var n="";1==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-check"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-times"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"dispose",value:function(){this.quill_el_container.off()}},{key:"get_qid",value:function(){return this.qid}},{key:"reflow",value:function(){this.status=c.cfg.STATUS.UNMODIFIED}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(n(44).EditorBase);t.EditorMChoice=p},142:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorMChoiceCheckbox=void 0;var c=n(66),u=n(830),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(d,e);var t,n,r,p,f=(r=d,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(p){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function d(e,t,n,r,o){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(i=f.call(this,e,t,n,r)).multipleAnswers=o||!1;var a=n.symbols,l=s(i);i.selectedIndex="",i.gid=t,i.qid=Math.floor(1e4*Math.random())+1e4,i.options=a||[],i.status=c.cfg.STATUS.UNMODIFIED,i.parent=e,i.wrong_attemps=0,i.quill_el_container=$('<div class="pw-me-mchoice"></div>'),i.check_el=$('<div class="pw-me-check"></div>');var p=$("<div></div>"),h="rgid_"+Math.random().toString(32).substring(2),y=[];return a.forEach((function(e,t){var n="raid_"+Math.random().toString(32).substring(2),r=$('<div class="form-check"></div>'),o=null;o=l.multipleAnswers?$('<input class="form-check-input" type="checkbox" id="'+n+'" value="'+t+'"/>'):$('<input class="form-check-input" type="radio" name="'+h+'" id="'+n+'" value="'+t+'"/>'),y.push(o);var i=$('<label class="form-check-label" for="'+n+'">'+e+"</label>");o.on("change",(function(e){e.preventDefault();for(var t=[],n=0;n<y.length;n++)y[n].prop("checked")&&t.push(y[n].prop("value")+"");l.selectedIndex=t.join(","),l.status!=c.cfg.STATUS.MODIFIED&&(l.check_el.html(""),l.status=c.cfg.STATUS.MODIFIED,l.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert"))})),r.append(o),r.append(i),p.append(r)})),i.quill_el_container.append(p),i.quill_el_container.append(i.check_el),i.parent.append(i.quill_el_container),(0,u.reflowLatex)(),i}return t=d,(n=[{key:"showAnswer",value:function(){}},{key:"clear",value:function(){this.selectedIndex="",this.btn_action.html(""),this.check_el.html(""),this.status=c.cfg.STATUS.UNMODIFIED,this.quill_el_container.removeClass("pw-me-right pw-me-wrong pw-me-alert")}},{key:"focus",value:function(){}},{key:"latex",value:function(e){return[this.selectedIndex]}},{key:"get_qid",value:function(){return this.qid}},{key:"checkMsg",value:function(e,t){this.status=e;var n="";1==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-check"></i></span>',this.quill_el_container.addClass("pw-me-right")):0==e?(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-times"></i></span>',this.quill_el_container.addClass("pw-me-wrong")):(n='<span data-toggle="tooltip" title="'+t+'"><i class="fas fa-exclamation-triangle"></i></span>',this.quill_el_container.addClass("pw-me-alert")),this.check_el.html(n)}},{key:"dispose",value:function(){this.quill_el_container.off()}},{key:"reflow",value:function(){this.status=c.cfg.STATUS.UNMODIFIED}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(n(44).EditorBase);t.EditorMChoiceCheckbox=p},786:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorPanel=void 0;var u=n(66),p=n(830),f=n(837),d=n(280),h=c(n(727)),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(v,e);var t,n,r,c,y=(r=v,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(c){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function v(e,t,n,r,o){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v);var a=s(i=y.call(this,e,t,n,r));return i.parent=e,i.gid=t,i.wrong_attemps=0,i.standalone=o||!1,i.status=u.cfg.STATUS.UNMODIFIED,i.panel=$('<div class="pw-me-editorpanel" style="position:relative"></div>'),i.parent.append(i.panel),i.palettes=new f.PwTabMenu(i.panel),i.spanMathInput=$('<span class="pw-me-editorpanel-mathinput"></span>'),i.spanMathInput.on("click",(function(e){e.preventDefault(),$(".pw-me-btn-dropdownmenu").css("display","none")})),i.panel.append(i.spanMathInput),i.mathInput=(0,u.MathField)(i.spanMathInput[0],{handlers:{edit:function(){o&&a.status!=u.cfg.STATUS.MODIFIED&&(a.check_el&&a.check_el.html(""),a.status=u.cfg.STATUS.MODIFIED)}}}),i.standalone&&(i.check_el=$("<div></div>"),i.panel.append(i.check_el)),i.feedback_el=$('<div class="pw-mq-feedback" style="display:none;"></div>'),i.panel.append(i.feedback_el),(0,p.items)(h.default.button_meta,(function(e,t){var n=h.default.default_toolbar_tabs[t.tab-1];a.palettes.addTab(n);var r=(0,d.createToolbarButton)(a.panel,t,e,a.mathInput);a.palettes.addContentsToTab(n,r)})),i.setDefinition(n),i}return t=v,(n=[{key:"$div",get:function(){return this.panel}},{key:"clear",value:function(){this.mathInput.latex(""),this.check_el&&this.check_el.html(""),this.status=u.cfg.STATUS.UNMODIFIED}},{key:"focus",value:function(){this.mathInput.focus()}},{key:"latex",value:function(e){return null==e?[(0,p.sanitizeLaTeX)(this.mathInput.latex())]:(this.mathInput.latex(e),this.status=u.cfg.STATUS.UNMODIFIED,[""])}},{key:"checkMsg",value:function(e,t){if(this.standalone){this.status=e;var n;n=1==e?'<span style="color:green;margin:5px;"><i class="fas fa-check"></i> '+t+"</span>":0==e?'<span style="color:darkred;margin:5px;"><i class="fas fa-times"></i> '+t+"</span>":'<span style="color:purple;margin:5px;"><i class="fas fa-exclamation-triangle"></i> '+t+"</span>",this.check_el&&this.check_el.html(n)}}},{key:"get_qid",value:function(){return this.mathInput.id}},{key:"showPalette",value:function(e,t){this.palettes.setVisible(e,t)}},{key:"dispose",value:function(){this.mathInput.revert(),this.panel.find("button").off(),this.palettes.dispose()}},{key:"reflow",value:function(){this.mathInput.reflow(),this.status=u.cfg.STATUS.UNMODIFIED}},{key:"setDefinition",value:function(e){this.def=e;var t=this;if(e.palettes&&e.palettes.indexOf("all")>=0)h.default.default_toolbar_tabs.forEach((function(e){t.palettes.setVisible(e,!0)})),this.palettes.setTab("General");else if(e.palettes&&e.palettes.length){var n=null,r=0;h.default.default_toolbar_tabs.forEach((function(o){for(var i=!1,a=0;!i&&a<e.palettes.length;)(i=e.palettes[a].toLowerCase().trim()==o.toLowerCase().trim())&&0==a&&(n=o),i&&(r+=1),a+=1;t.palettes.setVisible(o,i)})),0!=r&&n||this.palettes.setVisible("General",!0),this.palettes.setTab(n||"General")}else h.default.default_toolbar_tabs.forEach((function(e){t.palettes.setVisible(e,"General"==e)})),this.palettes.setTab("General")}},{key:"increment_wrong",value:function(){this.wrong_attemps+=1,this.wrong_attemps>u.cfg.MAX_ATTEMPTS&&this.showAnswer()}},{key:"showAnswer",value:function(){var e,t=this;this.def?this.def.right_answer?(null===(e=t.check_el)||void 0===e||e.css("display","none"),this.feedback_el.css("display",""),this.feedback_el.html(atob(this.def.right_answer)+"<p><br></p>"),(0,p.reflowLatex)(),this.isAnswerShown=!0,this.palettes.setEnabled(!1),this.spanMathInput.css("pointer-events","none"),this.panel.css("cursor","not-allowed")):$.ajax({type:"POST",url:u.cfg.GETANSWER_URL,data:JSON.stringify(this.def),dataType:"json",success:function(e){var n;e.right_answer?(null===(n=t.check_el)||void 0===n||n.css("display","none"),t.def.right_answer=e.right_answer,t.feedback_el.css("display",""),t.feedback_el.html(atob(t.def.right_answer)+"<p><br></p>"),(0,p.reflowLatex)(),t.isAnswerShown=!0,t.palettes.setEnabled(!1),t.spanMathInput.css("pointer-events","none"),t.panel.css("cursor","not-allowed")):e.msg&&console.error(e.msg)}}):console.error("Cannot show answer because def is null")}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),v}(n(44).EditorBase);t.EditorPanel=y},280:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createToolbarButton=void 0;var r=n(66);t.createToolbarButton=function(e,t,n,o){if("function"==typeof t.latex){var i=$('<div class="btn btn-sm pw-me-btn-toolbar pw-me-btn-dropdown" title="'+n.trim()+'"></div>'),a=$("<span>"+t.icon+"</span>");(0,r.StaticMath)(a[0]),i.append(a);var s=$('<div class="pw-me-btn-dropdownmenu"></div>');e.append(s);for(var l=[],c=0,u=t.vars.length;c<u;c++){var p=t.vars[c],f=p.name,d="";null!=p.min&&(d=' min="'+p.min+'" '),null!=p.max&&(d+=' max="'+p.max+'" ');var h=$('<input style="width:50px;margin-left:4px;grid-column:2;" type="'+p.type+'" value="'+p.val+'"'+d+"/>");l.push(h);var y=$('<span style="grid-column:1">'+f+"</span>");s.append(y),s.append(h)}var v=$('<button class="btn btn-sm" style="padding:4px;grid-row:3;grid-column:1 / 2;background:lightgray;">Ok</button>');s.append(v),v.on("click",(function(e){e.preventDefault();for(var n={},r=0,i=l.length;r<i;r++){var a=l[r],c=t.vars[r],u=c.name,p=a.val();"number"===c.type&&(p=parseInt(p)),n[u]=p}var f=t.latex(n);o.write(f),t.moveto&&o.keystroke(t.moveto),s.css("display","none"),o.focus()})),i.on("click",(function(e){e.preventDefault();var t=s.css("display");s.css("display","none"===t?"grid":"none")}))}else i=$('<button class="btn btn-sm pw-me-btn-toolbar" title="'+n.trim()+'"></button>'),a=$("<span>"+t.icon+"</span>"),(0,r.StaticMath)(a[0]),i.append(a),i.on("click",(function(e){e.preventDefault(),o.write(t.latex),o.focus(),t.moveto&&o.keystroke(t.moveto),$(".pw-me-btn-dropdownmenu").css("display","none")}));return i}},837:function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.PwTabMenu=void 0;var o=n(830),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$panel=$('<div class="pw-me-tabmenu"></div>'),this.parent=t,this.tabs={},this.currentTab=null,this.tabsPanel=$('<div class="pw-me-tabspanel"></div>'),this.contentsPanel=$('<div class="pw-me-tabcontents"></div>'),this.$panel.append(this.tabsPanel),this.$panel.append(this.contentsPanel),this.parent&&this.parent.append(this.$panel)}var t,n;return t=e,(n=[{key:"$div",get:function(){return this.$panel}},{key:"addTab",value:function(e){if(!this.tabs[e]){var t=this,n=$('<button style="display:none;" class="btn btn-sm pw-me-btn-tab">'+e+"</button>"),r=$('<div style="display:none;" class="pw-me-tabcontainer"></div>');n.on("click",(function(n){n.preventDefault(),t.setTab(e)})),this.tabsPanel.append(n),this.contentsPanel.append(r),this.tabs[e]={tab:n,container:r},1===Object.keys(this.tabs).length&&this.setTab(e)}}},{key:"addContentsToTab",value:function(e,t){this.tabs[e]&&this.tabs[e].container.append(t)}},{key:"setVisible",value:function(e,t){console.log(e,this.tabs),this.tabs[e]&&(this.tabs[e].tab.css("display",t?"":"none"),this.tabs[e].container.css("display",t?"flex":"none"))}},{key:"setEnabled",value:function(e){e?(this.contentsPanel.css("pointer-events","initial"),this.$panel.css("cursor","initial")):(this.contentsPanel.css("pointer-events","none"),this.$panel.css("cursor","not-allowed"))}},{key:"setTab",value:function(e){(0,o.items)(this.tabs,(function(t,n){t==e?(n.tab.addClass("pw-me-btn-active"),n.tab.css("display","")):n.tab.removeClass("pw-me-btn-active"),n.container.css("display",t==e?"flex":"none")}))}},{key:"dispose",value:function(){this.tabsPanel.children().off(),this.tabsPanel.html(""),this.contentsPanel.html(""),this.tabs={}}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.PwTabMenu=i},727:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={default_toolbar_buttons:["fraction","square_root","cube_root","root","superscript","subscript","multiplication","division","plus_minus","pi","degree","not_equal","greater_equal","less_equal","greater_than","less_than","angle","parallel_to","perpendicular","triangle","parallelogram","round_brackets","matrix2","matrix3"],default_toolbar_tabs:["General","Símbols","Geometria","Intervals","Funcions"],button_meta:{"Multiplicació":{latex:"\\times",tab:1,icon:"\\times"},"Fracció":{latex:"\\frac{}{}",moveto:"Up",movefor:1,tab:1,icon:"\\frac{\\square}{\\square}"},Exponent:{latex:"\\^{}",moveto:"Up",movefor:1,tab:1,icon:"\\square^2"},"Parèntesis":{latex:"\\left(\\right)",moveto:"Left",movefor:1,tab:1,icon:"\\left(\\square\\right)"},"Arrel quadrada":{latex:"\\sqrt{}",moveto:"Left",movefor:1,tab:1,icon:"\\sqrt{\\square}"},"Arrel cúbica":{latex:"\\sqrt[3]{}",moveto:"Left",movefor:1,tab:1,icon:"\\sqrt[3]{\\square}"},Radical:{latex:"\\sqrt[{}]{}",moveto:"Left",movefor:2,tab:1,icon:"\\sqrt[\\square]{\\square}"},"Matriu 2x2":{latex:"\\begin{pmatrix} & \\\\ & \\end{pmatrix}",tab:1,icon:"M_{2\\times 2}"},"Matriu 3x3":{latex:"\\begin{pmatrix} & & \\\\ & &  \\\\ & & \\end{pmatrix}",tab:1,icon:"M_{3\\times 3}"},"Matriu mxn":{latex:function(e){for(var t=[],n=0;n<e.n;n++){for(var r=[],o=0;o<e.m;o++)r.push(" ");t.push(r.join("&"))}return"\\begin{pmatrix} "+t.join("\\\\")+" \\end{pmatrix}"},tab:1,icon:"M_{n\\times m}",vars:[{name:"n",type:"number",min:1,val:2},{name:"m",type:"number",min:1,val:2}]},"Subíndex":{latex:"\\_{}",moveto:"Down",movefor:1,tab:1,icon:"\\square_{2}"},pi:{latex:"\\pi",tab:2,icon:"\\pi"},e:{latex:"\\e",tab:2,icon:"e"},infinit:{latex:"\\infty",tab:2,icon:"\\infty"},"Més menys":{latex:"\\pm",tab:2,icon:"\\pm"},Diferent:{latex:"\\neq",tab:2,icon:"\\neq"},"Major o igual":{latex:"\\geq",tab:2,icon:"\\geq"},"Menor o igual":{latex:"\\leq",tab:2,icon:"\\leq"},"Major que":{latex:"\\gt",tab:2,icon:"\\gt"},"Menor que":{latex:"\\lt",tab:2,icon:"\\lt"},Graus:{latex:"\\degree",tab:3,icon:"\\degree"},Angle:{latex:"\\angle",tab:3,icon:"\\angle"},"Paral·lel a":{latex:"\\parallel",tab:3,icon:"\\parallel"},"Perpendicular a":{latex:"\\perpendicular",tab:3,icon:"\\perpendicular"},Triangle:{latex:"\\triangle",tab:3,icon:"\\triangle"},"Paral·lelogram":{latex:"\\parallelogram",tab:3,icon:"\\parallelogram"},"Interval obert":{latex:"\\left( , \\right)",moveto:"Left",movefor:4,tab:4,icon:"\\left(\\square, \\square\\right)"},"Interval tancat":{latex:"\\left[ , \\right]",moveto:"Left",movefor:4,tab:4,icon:"\\left[\\square, \\square\\right]"},"Interval semi1":{latex:"\\left[ , \\right)",moveto:"Left",movefor:4,tab:4,icon:"\\left[\\square, \\square\\right)"},"Interval semi2":{latex:"\\left( , \\right]",moveto:"Left",movefor:4,tab:4,icon:"\\left(\\square, \\square\\right]"},Infinit:{latex:"\\infty",tab:4,icon:"\\infty"},"Conjunt dels reals":{latex:"\\mathbb{R}",tab:4,icon:"\\mathbb{R}"},Sinus:{latex:"\\sin()",moveto:"Left",movefor:1,tab:5,icon:"\\sin{\\square}"},Cosinus:{latex:"\\cos()",moveto:"Left",movefor:1,tab:5,icon:"\\cos{\\square}"},Tangent:{latex:"\\tan()",moveto:"Left",movefor:1,tab:5,icon:"\\tan{\\square}"},Arcsinus:{latex:"\\arcsin()",moveto:"Left",movefor:1,tab:5,icon:"\\arcsin{\\square}"},Arccosinus:{latex:"\\arccos()",moveto:"Left",movefor:1,tab:5,icon:"\\arccos{\\square}"},Arctangent:{latex:"\\arctan()",moveto:"Left",movefor:1,tab:5,icon:"\\arctan{\\square}"},"Logaritme Neperià":{latex:"\\ln()",moveto:"Left",movefor:1,tab:5,icon:"\\ln{\\square}"},"Logaritme en base b":{latex:"\\frac{\\log()}{\\log{b}}",moveto:"Left",movefor:4,tab:5,icon:"\\log_b{\\square}"}},keyboard_keys:{letters:[{value:"q",type:"write",class:"ks",display:"q",new_line:!1},{value:"w",type:"write",class:"ks",display:"w",new_line:!1},{value:"e",type:"write",class:"ks",display:"e",new_line:!1},{value:"r",type:"write",class:"ks",display:"r",new_line:!1},{value:"t",type:"write",class:"ks",display:"t",new_line:!1},{value:"y",type:"write",class:"ks",display:"y",new_line:!1},{value:"u",type:"write",class:"ks",display:"u",new_line:!1},{value:"i",type:"write",class:"ks",display:"i",new_line:!1},{value:"o",type:"write",class:"ks",display:"o",new_line:!1},{value:"p",type:"write",class:"ks",display:"p",new_line:!0},{value:"a",type:"write",class:"ks",display:"a",new_line:!1},{value:"s",type:"write",class:"ks",display:"s",new_line:!1},{value:"d",type:"write",class:"ks",display:"d",new_line:!1},{value:"f",type:"write",class:"ks",display:"f",new_line:!1},{value:"g",type:"write",class:"ks",display:"g",new_line:!1},{value:"h",type:"write",class:"ks",display:"h",new_line:!1},{value:"j",type:"write",class:"ks",display:"j",new_line:!1},{value:"k",type:"write",class:"ks",display:"k",new_line:!1},{value:"l",type:"write",class:"ks",display:"l",new_line:!0},{value:"CapsLock",type:"custom",class:"ks long icon",display:"&#8673;",new_line:!1},{value:"z",type:"write",class:"ks",display:"z",new_line:!1},{value:"x",type:"write",class:"ks",display:"x",new_line:!1},{value:"c",type:"write",class:"ks",display:"c",new_line:!1},{value:"v",type:"write",class:"ks",display:"v",new_line:!1},{value:"b",type:"write",class:"ks",display:"b",new_line:!1},{value:"n",type:"write",class:"ks",display:"n",new_line:!1},{value:"m",type:"write",class:"ks",display:"m",new_line:!1},{value:"Backspace",type:"keystroke",class:"ks long icon",display:"&#8678;",new_line:!0},{value:"numpad",type:"custom",class:"ks long",display:"123",new_line:!1},{value:",",type:"write",class:"ks",display:",",new_line:!1},{value:"\\ ",type:"write",class:"ks too_long",display:"Space",new_line:!1},{value:".",type:"write",class:"ks",display:".",new_line:!1},{value:"close",type:"custom",class:"ks long takeup",display:"X",new_line:!1}],numbers:[{value:"1",type:"write",class:"ks",display:"1",new_line:!1},{value:"2",type:"write",class:"ks",display:"2",new_line:!1},{value:"3",type:"write",class:"ks",display:"3",new_line:!1},{value:"+",type:"write",class:"ks",display:"+",new_line:!1},{value:"-",type:"write",class:"ks",display:"&#8315;",new_line:!0},{value:"4",type:"write",class:"ks",display:"4",new_line:!1},{value:"5",type:"write",class:"ks",display:"5",new_line:!1},{value:"6",type:"write",class:"ks",display:"6",new_line:!1},{value:"\\times",type:"write",class:"ks",display:"&times;",new_line:!1},{value:"/",type:"write",class:"ks",display:"&#247;",new_line:!0},{value:"7",type:"write",class:"ks",display:"7",new_line:!1},{value:"8",type:"write",class:"ks",display:"8",new_line:!1},{value:"9",type:"write",class:"ks",display:"9",new_line:!1},{value:"=",type:"write",class:"ks",display:"=",new_line:!1},{value:"Backspace",type:"keystroke",class:"ks long icon",display:"&#8678;",new_line:!0},{value:"letters",type:"custom",class:"ks long",display:"ABC",new_line:!1},{value:"0",type:"write",class:"ks",display:"0",new_line:!1},{value:"?",type:"write",class:"ks",display:"?",new_line:!1},{value:"%",type:"write",class:"ks",display:"%",new_line:!1},{value:"close",type:"custom",class:"ks long takeup",display:"X",new_line:!1}]}}},791:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createQuillFromObject=void 0;var r=n(437),o=n(980),i=n(786),a=n(203),s=n(66),l=n(142),c=n(830);t.createQuillFromObject=function(e,t,n){var u=null,p=n.editor;if(n.formulation){var f="<span>"+n.formulation+"</span>";e.append(f),(0,c.reflowLatex)()}if(e.removeClass("pygen-cloze"),p==s.cfg.QTYPES.C)u=new r.EditorCloze(e,t,n,s.cfg.QTYPES.C,n.initial_latex),e.addClass("pygen-cloze");else if(p==s.cfg.QTYPES.P)u=new i.EditorPanel(e,t,n,s.cfg.QTYPES.P,!0);else if(p==s.cfg.QTYPES.M)n.symbols=n.symbols||[],u=new a.EditorMChoice(e,t,n,s.cfg.QTYPES.M,n.symbols);else if(p==s.cfg.QTYPES.Ms){n.symbols=n.symbols||[];var d=Array.isArray(n.ans);u=new l.EditorMChoiceCheckbox(e,t,n,s.cfg.QTYPES.Ms,d)}else u=new o.EditorInput(e,t,n,s.cfg.QTYPES.S);var h=u.get_qid();return(s.shared[t]||{})[h]=u,u.setStatus(s.cfg.STATUS.UNMODIFIED),n.initial_latex&&p!=s.cfg.QTYPES.C&&(u.latex(n.initial_latex),u.setStatus(s.cfg.STATUS.MODIFIED)),h}},657:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.findPyGenerators=void 0;var r=n(800),o=n(968),i=n(791),a=n(66),s=n(969),l=n(713),c=n(316),u=n(970),p=n(831),f=n(830);t.findPyGenerators=function(){var e=window.IB||{};$("div[data-pygen]").each((function(t,n){var d=$(n);d.css({position:"relative","min-height":"300px","background-color":"#ffffff","background-image":'url("https://piworld.es/iedib/matheditor/backgrounds/triangles.svg")',"background-position":"center","background-size":"cover"}),d.html("");var h=d.attr("id")||"";h||(h="pyg_"+Math.random().toString(32).substring(2),d.attr("id",h)),a.shared[h]={};var y=$('<div style="display:flex;flex-direction:row-reverse;align-items:baseline;"></div>'),v=$("<div></div>"),b=$('<div style="display: flex; flex-direction: row; align-content: flex-start;margin:10px 0; flex-wrap: wrap; gap: 5px;margin-bottom:30px;"></div>'),m=$('<div style="position: absolute;left: 0;right: 0;bottom: 0;margin: 0;background-color: #9fa0ac; display: flex; flex-direction: row; align-content: flex-start; flex-wrap: wrap; gap: 5px;"></div>'),g=new o.LevelIndicator(4),w=d.attr("data-pygen-category")||"general";g.setVisible(a.cfg.HAS_IAPACE&&null!=d.attr("data-pygen-category")),y.append(g.container);var _=1;a.cfg.HAS_IAPACE&&(_=e.iapace.inference(w)),g.setLevel(_);var k=null;if(a.cfg.HAS_IAPACE&&null!=d.attr("data-pygen-goal")){var S=(d.attr("data-pygen-goal")||"").split(";").map((function(e){return e.split(",")}));(k=new s.GoalChecker(w,S)).accomplished()&&y.append($('<span class="pw-goal-reached">Repte aconseguit! </span>'))}for(var O=(d.attr("data-pygen")||"").split(";"),x=[],P=0,T=O.length;P<T;P++){var E=O[P],I=null,M={};if(E.indexOf("[")>0){I=E.split("[")[0].trim();for(var j=E.split("[")[1].replace("]","").split(","),q=0,D=j.length;q<D;q++){var A=j[q];if(A.indexOf("=")>0){var C=A.split("="),R=C[0],L=C[1];L=L.indexOf("'")>=0?L.replace(/'/g,""):parseFloat(L),M[R]=L}}}else I=E.trim();Object.keys(M).length?x.push([I,M]):x.push([I])}var U=new c.SeqBasic(x);if(x.length>1){var F=(d.attr("data-pygen-order")||"random").trim().toLowerCase();F.startsWith("random")||F.startsWith("weighted")?U=new u.SeqRandomWeighted(x,F):F.startsWith("sequence")&&(U=new p.SeqSequence(x,F))}var N=$('<button class="btn btn-sm btn-primary"><i class="fas fa-check"></i> Comprova</button>'),B=$('<button class="btn btn-sm btn-warning" style="display:none;"><i class="far fa-life-ring"></i> Comodí 50%</button>'),Q=null,G=null,Y=function(){N.prop("disabled",!0),W.prop("disabled",!0),H.prop("disabled",!0),B.css("display","none"),a.cfg.HAS_IAPACE&&(_=e.iapace.inference(w)),console.log("xivat",w,_),g.setLevel(_);var t=U.next();$.ajax({type:"POST",url:a.cfg.PYGEN_URL,data:JSON.stringify({activities:[t],level:_}),dataType:"json",success:function(t){if(console.log("xivato",t),t.msg)return Q=null,v.html('<p style="color:darkred">ERROR<br>'+JSON.stringify(t.msg)+"</p>"),console.error("ERROR: ",t),void W.prop("disabled",!1);v.html("");var n=$("<p><span>"+(d.attr("data-pygen-formulation")||"")+"</span> "+t.formulation+"</p>");v.append(n);var o=atob(t.mq64),s=JSON.parse(o);if(a.cfg.HAS_IAPACE){var c=e.iapace.findCreate(w);c&&(0,f.sum)(c.h)>=30&&(console.log("Super! Has conseguit un comodí"),B.css("display",null==s.comodi?"none":""))}s.category=w,s.palettes||(s.palettes="all"),s.editor==a.cfg.QTYPES.M&&(s.editor=a.cfg.QTYPES.Ms),Q=s,s.initial_latex&&(s.initial_latex=(0,l.processMqIni)(s.initial_latex));var u=[];if(s.symbols)for(var p=s.symbols.split(";"),b=0,m=p.length;b<m;b++){var g=p[b];g.trim()&&u.push(g.trim())}s.symbols=u;var _=[];s.rules&&(_=JSON.parse(s.rules)),s.rules=_,console.log(s);var S=(0,i.createQuillFromObject)(v,h,s);(G=a.shared[h][S]).isPigen=!0,N.off(),(0,r.bindSubmitActionButton)(h,N,(function(t){W.prop("disabled",!1),H.prop("disabled",!1),a.cfg.HAS_IAPACE&&(e.iapace.addScore(w,t),e.iapace.save()),k&&k.reached()&&(0==y.find(".pw-goal-reached").length&&y.append($('<span class="pw-goal-reached">Repte aconseguit! </span>')),"confetti"==d.attr("data-pygen-celebration")&&window.Confetti&&new window.Confetti(d[0]).play())})),console.log(a.shared[h]),(0,f.reflowLatex)(),N.prop("disabled",!1)},error:function(e){Q=null,G=null,console.log("error",e),v.html('<div><p style="color:darkred">ERROR<br>'+JSON.stringify(e)+"</p></div>"),W.prop("disabled",!1)}})},H=$('<button class="btn btn-sm btn-outline-info" title="Mostra la resposta"><i class="fas fa-question-circle"></i> Solució</button>');H.on("click",(function(e){e.preventDefault(),G?G.status!=a.cfg.STATUS.CORRECT&&G.wrong_attemps<1?console.log("can't show answer yet",G):(N.prop("disabled",!0),H.prop("disabled",!0),console.log(G),G.showAnswer&&G.showAnswer()):console.error("Missing currentEditor here :-(")}));var W=$('<button class="btn btn-sm btn-outline-primary" title="Genera una nova pregunta"><i class="fas fa-arrow-circle-right"></i> Següent</button>');if(W.on("click",(function(e){e.preventDefault();for(var t=Object.keys(a.shared[h]||{}),n=0,r=t.length;n<r;n++){var o=parseInt(t[n]);a.shared[h][o].dispose(),delete a.shared[h][o]}Y()})),B.on("click",(function(e){e.preventDefault(),G&&Q&&Q.comodi&&(G.comodiUsed=!0,B.css("display","none"),G.latex(Q.comodi),G.status=a.cfg.STATUS.MODIFIED)})),b.append(N),b.append(W),b.append(H),b.append(B),d.append(y),d.append(v),d.append(b),"none"!=d.attr("data-copyright")){var z=$('<span style="padding:4px;font-size:70%;color:whitesmoke;"><em>pyQuizz</em> by Josep Mulet (c) 2021-22</span>');m.append(z),d.append(m)}Y()}))}},66:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedDlg=t.shared=t.MathField=t.StaticMath=t.loadPageInfo=t.cfg=void 0;var n=null,r=window.IB&&window.IB.iapace;t.cfg={BASE_URL:"https://piworld.es/iedib/matheditor",pageInfo:n,STATUS:{UNMODIFIED:100,MODIFIED:200,CORRECT:1,WRONG:0},QTYPES:{S:"simple",B:"basic",C:"cloze",P:"panel",M:"mchoice",Ms:"mchoice*"},GETANSWER_URL:"https://piworld.es/pigen/api/getanswer",PYGEN_URL:"https://piworld.es/pigen/api/generate",CAS_URL:"https://piworld.es/pigen/api/compare",MAX_ATTEMPTS:2,HAS_IAPACE:r,RIGHT_ICON:"fas fa-check",WRONG_ICON:"fas fa-times"},t.loadPageInfo=function(){window.iedibAPI&&(n=window.iedibAPI.getPageInfo(),console.log(n))},t.StaticMath=function(e){return window.MathQuill.getInterface(2).StaticMath(e)},t.MathField=function(e,t){return window.MathQuill.getInterface(2).MathField(e,t)},t.shared={},t.sharedDlg={}},969:function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.GoalChecker=void 0;var o=n(66),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.category=t,this.rules=n}var t,n;return t=e,(n=[{key:"accomplished",value:function(e){var t=window.IB||{};if(!o.cfg.HAS_IAPACE)return!1;if(!e){var n=t.iapace.find(this.category);return null!=n&&n.d}return t.iapace.findCreate(this.category).d=e,t.iapace.save(),e}},{key:"reached",value:function(){var e=window.IB||{};if(!o.cfg.HAS_IAPACE)return!1;if(this.accomplished())return!1;for(var t=e.iapace.findCreate(this.category),n=!1,r=this.rules.length,i=0;!n&&i<r;){var a=!0,s=this.rules[i],l=0;if(isNaN(s[0])?l+=1:a=a&&t.n>=parseInt(s[0]),isNaN(s[1]))l+=1;else{var c=0;t.n>0&&(c=t.s/(1*t.n)),a=a&&c>=parseFloat(s[1])}isNaN(s[2])?l+=1:a=a&&e.iapace.inference(this.category)>=parseInt(s[2]),l<3&&(n=a),i+=1}return n&&this.accomplished(!0),n}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.GoalChecker=i},713:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createQuillFromDataAttr=t.processMqIni=void 0;var r=n(791),o=n(66);function i(e){return(e=(e=e||"").replace(/\?\d*?/g,"\\MathQuillMathField{}")).replace(/M\[(\d+)x(\d+)\]/g,(function(e,t,n){for(var r=parseInt(t),o=parseInt(n),i=[],a=new Array(o),s=0;s<r;s++)i.push(a.join(" & "));return"\\begin{pmatrix} "+i.join(" \\\\ ")+" \\end{pmatrix}"}))}t.processMqIni=i,t.createQuillFromDataAttr=function(e,t){var n=e.attr("data-mq")||"simple",a=e.attr("data-mq-ans"),s="ans";if(a||(s="anse",a=e.attr("data-mq-anse"))){if((a=a.trim()).startsWith("[")&&a.endsWith("]"))for(var l=0,c=(a=JSON.parse(a)).length;l<c;l++)a[l]=""+a[l];var u=i(e.attr("data-mq-ini")),p=e.attr("data-mq-symbols");if(n!==o.cfg.QTYPES.C||u){var f="";e.attr("data-mq-ra")&&(f=atob(e.attr("data-mq-ra")||""));var d=[];if(p)for(var h=p.split(";"),y=0,v=h.length;y<v;y++){var b=h[y];b.trim()&&d.push(b.trim())}var m=e.attr("data-mq-rules"),g=[];m&&(g=JSON.parse(m));var w=[],_=e.attr("data-mq-palettes");_&&_.split(",").forEach((function(e){w.push(e.trim())}));var k={editor:n,symbols:d,right_answer:f,initial_latex:u,rules:g,palettes:w,ans:a,ansType:s};e.attr("data-mq-formulation")&&(k.formulation=e.attr("data-mq-formulation")),(0,r.createQuillFromObject)(e,t,k)}else console.error("> MQ ",e," is of type cloze but it has no data-mq-ini!")}else console.error("> MQ has no data-mq-ans/e!")}},216:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.findQuillGroups=void 0;var r=n(800),o=n(791),i=n(66),a=n(713),s=n(830);t.findQuillGroups=function(e){(e=e||$("body")).find(".pw-mq-group").each((function(t,n){var l=$(n);if(!l.hasClass("pw-mq-done")){l.addClass("pw-mq-done");var c=l.attr("id");c||(c="g_"+Math.random().toString(32).substring(2),l.attr("id",c)),i.shared[c]={},function(e,t){e.find("[data-mq]").each((function(e,n){var r=$(n),l=$(n).attr("data-mq")||"simple";if((0,s.hasValue)(i.cfg.QTYPES,l))console.error("Definition via data-attributes in deprecated since version 2.0. Please encode the definition in a single data-mq field."),(0,a.createQuillFromDataAttr)(r,t);else try{var c=atob(l),u=JSON.parse(c);(0,o.createQuillFromObject)(r,t,u)}catch(e){console.error("Invalid or corrupted MQ definition:: ",l)}}))}(l,c);var u=(0,r.createSubmitButtonForGroup)(c);l.append(u),null==e&&window.setTimeout((function(){(0,s.items)(i.shared,(function(e,t){(0,s.items)(t,(function(e,t){t.reflow&&t.reflow()}))}))}),800)}}))}},452:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.applyPolyfills=void 0,t.applyPolyfills=function(){Array.prototype.forEach||(Array.prototype.forEach=function(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=this;t=t||this;for(var r=0,o=n.length;r!==o;++r)e.call(t,n[r],r,n)}),Array.prototype.map||(Array.prototype.map=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var t=[],n=0;n<this.length;n++)t.push(e(this[n],n,this));return t}),Array.prototype.filter||(Array.prototype.filter=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var t=[],n=0;n<this.length;n++)e.call(this,this[n],n,this)&&t.push(this[n]);return t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"function"!=typeof Number.isNaN||(Number.isNaN=function(e){return null!==e&&(e!=e||+e!=e)})}},316:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.SeqBasic=void 0;var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lpygens=t}var t,r;return t=e,(r=[{key:"next",value:function(){return this.lpygens[0]}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.SeqBasic=r},970:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SeqRandomWeighted=void 0;var l=n(830),c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(p,e);var t,n,r,c,u=(r=p,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(c){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function p(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),n=u.call(this,e),t=(t||"random").trim().toLowerCase(),n.definition=t;var r=[];if(t.startsWith("weighted:")){var o=(t=t.replace("weighted:","")).split(",");r=o.map((function(e){return parseFloat(e)}))}else for(var i=1/e.length,a=0,s=e.length;a<s;a++)r.push(i);if(n.lpygens=e,n.lpygens.length>r.length)for(console.log("SeqRandomWeighted:: lpygens and weights have different length");n.lpygens!=r.length;)r.push(1);for(;r.length>e.length;)r.pop();var c=(0,l.sum)(r),f=0;return r.forEach((function(e,t){f=(e/=c)+f,r[t]=f})),n.weights=r,n}return t=p,(n=[{key:"next",value:function(){if("random"==this.definition){var e=Math.floor(Math.random()*this.lpygens.length);return this.lpygens[e]}for(var t=Math.random(),n=0,r=this.weights[n];r<t;)n+=1,r=this.weights[n];return this.lpygens[n]}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(n(316).SeqBasic);t.SeqRandomWeighted=c},831:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SeqSequence=void 0;var c=n(830),u=n(316),p=n(970),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(d,e);var t,n,r,u,f=(r=d,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(u){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function d(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=f.call(this,e)).lpygens=e,t=t.replace("sequence:","").trim().toLowerCase(),n.positions=[],n.terminalGen=void 0;var r=t.split(","),o=s(n);return r.forEach((function(t,n){if((0,c.isNumeric)(t)&&null==o.terminalGen)for(var i=parseInt(t),a=0;a<i;a++)o.positions.push(n);else if(t.startsWith("*")&&null==o.terminalGen){for(var s=e.slice(n),l=[],u=!1,f=n;f<r.length;f++){var d=r[f];d.indexOf("*")>=0&&d.indexOf("(")>0?(d=d.replace("*","").replace("(","").replace(")",""),l.push(parseFloat(d)),u=!0):l.push(1)}var h="random";u&&(h="weighted: "+l.join(",")),o.terminalGen=new p.SeqRandomWeighted(s,h)}})),n.pointer=0,n}return t=d,(n=[{key:"next",value:function(){if(this.pointer>=this.positions.length&&this.terminalGen)return this.terminalGen.next();this.pointer=this.pointer%this.positions.length;var e=this.positions[this.pointer];return this.pointer+=1,this.lpygens[e]}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(u.SeqBasic);t.SeqSequence=f},830:function(e,t){function n(e,t,n,r,o,i){return s(function(e,t){return e<<t|e>>>32-t}(s(s(t,e),s(r,i)),o),n)}function r(e,t,r,o,i,a,s){return n(t&r|~t&o,e,t,i,a,s)}function o(e,t,r,o,i,a,s){return n(t&o|r&~o,e,t,i,a,s)}function i(e,t,r,o,i,a,s){return n(t^r^o,e,t,i,a,s)}function a(e,t,r,o,i,a,s){return n(r^(t|~o),e,t,i,a,s)}function s(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}Object.defineProperty(t,"__esModule",{value:!0}),t.isNumeric=t.createLinkSheet=t.createStyleSheet=t.insertScript=t.MD5=t.copyPropsFromTo=t.hasValue=t.items=t.sum=t.sanitizeLaTeX=t.reflowLatex=void 0,t.reflowLatex=function(){window.MathJax&&(window.MathJax.typesetPromise&&window.MathJax.typesetPromise(),window.MathJax.Hub&&window.MathJax.Hub.Queue&&window.MathJax.Hub.Queue(["Typeset",MathJax.Hub]))},t.sanitizeLaTeX=function(e){return e.replace(/·/g,"*")},t.sum=function(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n];return t},t.items=function(e,t){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t(n,e[n]);else{var o=Object.keys(e);for(n=0,r=o.length;n<r;n++){var i=o[n];t(i,e[i])}}},t.hasValue=function(e,t){for(var n=!1,r=Object.keys(e),o=0;!n&&o<r.length;)n=e[r[o]]==t,o++;return n},t.copyPropsFromTo=function(e,t){for(var n=Object.keys(e),r=0,o=n.length;r<o;r++){var i=n[r];t[i]=e[i]}},t.MD5=function(e){var t=function(e){for(var t,n="0123456789ABCDEF",r="",o=0;o<e.length;o++)t=e.charCodeAt(o),r+=n.charAt(t>>>4&15)+n.charAt(15&t);return r}(function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,l=-271733879,c=-1732584194,u=271733878,p=0;p<e.length;p+=16){var f=n,d=l,h=c,y=u;l=a(l=a(l=a(l=a(l=i(l=i(l=i(l=i(l=o(l=o(l=o(l=o(l=r(l=r(l=r(l=r(l,c=r(c,u=r(u,n=r(n,l,c,u,e[p+0],7,-680876936),l,c,e[p+1],12,-389564586),n,l,e[p+2],17,606105819),u,n,e[p+3],22,-1044525330),c=r(c,u=r(u,n=r(n,l,c,u,e[p+4],7,-176418897),l,c,e[p+5],12,1200080426),n,l,e[p+6],17,-1473231341),u,n,e[p+7],22,-45705983),c=r(c,u=r(u,n=r(n,l,c,u,e[p+8],7,1770035416),l,c,e[p+9],12,-1958414417),n,l,e[p+10],17,-42063),u,n,e[p+11],22,-1990404162),c=r(c,u=r(u,n=r(n,l,c,u,e[p+12],7,1804603682),l,c,e[p+13],12,-40341101),n,l,e[p+14],17,-1502002290),u,n,e[p+15],22,1236535329),c=o(c,u=o(u,n=o(n,l,c,u,e[p+1],5,-165796510),l,c,e[p+6],9,-1069501632),n,l,e[p+11],14,643717713),u,n,e[p+0],20,-373897302),c=o(c,u=o(u,n=o(n,l,c,u,e[p+5],5,-701558691),l,c,e[p+10],9,38016083),n,l,e[p+15],14,-660478335),u,n,e[p+4],20,-405537848),c=o(c,u=o(u,n=o(n,l,c,u,e[p+9],5,568446438),l,c,e[p+14],9,-1019803690),n,l,e[p+3],14,-187363961),u,n,e[p+8],20,1163531501),c=o(c,u=o(u,n=o(n,l,c,u,e[p+13],5,-1444681467),l,c,e[p+2],9,-51403784),n,l,e[p+7],14,1735328473),u,n,e[p+12],20,-1926607734),c=i(c,u=i(u,n=i(n,l,c,u,e[p+5],4,-378558),l,c,e[p+8],11,-2022574463),n,l,e[p+11],16,1839030562),u,n,e[p+14],23,-35309556),c=i(c,u=i(u,n=i(n,l,c,u,e[p+1],4,-1530992060),l,c,e[p+4],11,1272893353),n,l,e[p+7],16,-155497632),u,n,e[p+10],23,-1094730640),c=i(c,u=i(u,n=i(n,l,c,u,e[p+13],4,681279174),l,c,e[p+0],11,-358537222),n,l,e[p+3],16,-722521979),u,n,e[p+6],23,76029189),c=i(c,u=i(u,n=i(n,l,c,u,e[p+9],4,-640364487),l,c,e[p+12],11,-421815835),n,l,e[p+15],16,530742520),u,n,e[p+2],23,-995338651),c=a(c,u=a(u,n=a(n,l,c,u,e[p+0],6,-198630844),l,c,e[p+7],10,1126891415),n,l,e[p+14],15,-1416354905),u,n,e[p+5],21,-57434055),c=a(c,u=a(u,n=a(n,l,c,u,e[p+12],6,1700485571),l,c,e[p+3],10,-1894986606),n,l,e[p+10],15,-1051523),u,n,e[p+1],21,-2054922799),c=a(c,u=a(u,n=a(n,l,c,u,e[p+8],6,1873313359),l,c,e[p+15],10,-30611744),n,l,e[p+6],15,-1560198380),u,n,e[p+13],21,1309151649),c=a(c,u=a(u,n=a(n,l,c,u,e[p+4],6,-145523070),l,c,e[p+11],10,-1120210379),n,l,e[p+2],15,718787259),u,n,e[p+9],21,-343485551),n=s(n,f),l=s(l,d),c=s(c,h),u=s(u,y)}return Array(n,l,c,u)}(function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}(e),8*e.length)));return t.toLowerCase()},t.insertScript=function(e,t){var n=document.createElement("script");n.src=e,n.type="text/javascript",n.async=!0,document.head.appendChild(n),t&&(n.async=!0,n.onload=function(){t()})},t.createStyleSheet=function(e,t){if(!t||!document.getElementById(t)){var n=document.createElement("style");n.innerHTML=e,t&&(n.id=t),document.getElementsByTagName("head")[0].appendChild(n)}},t.createLinkSheet=function(e,t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)},t.isNumeric=function(e){return null!=(e||"").replace(/\s+/g,"").match(/^[+\-]?[0-9]+\.?[0-9]*$/)}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}!function(){var e=n(452),t=n(66),r=n(830),o=n(216),i=n(657);(0,e.applyPolyfills)();var a=function(){(0,t.loadPageInfo)(),(0,o.findQuillGroups)(),(0,i.findPyGenerators)()};$((function(){(0,r.createLinkSheet)(t.cfg.BASE_URL+"/lib/mathquill.matrix.css"),window.iedibAPI?(0,r.insertScript)(t.cfg.BASE_URL+"/lib/mathquill.matrix.min.js",a):(0,r.insertScript)("https://piworld.es/iedib/assets/iedib-api.js",(function(){(0,r.insertScript)(t.cfg.BASE_URL+"/lib/mathquill.matrix.min.js",a)}))}))}()}();
//# sourceMappingURL=matheditor2.min.js.map